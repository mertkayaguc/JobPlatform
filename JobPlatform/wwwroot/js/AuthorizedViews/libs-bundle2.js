(function(e){function n(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}function r(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length===0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!==undefined)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function i(){if(!e.fn.ajaxSubmit.debug)return;var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined,t.formdata=window.FormData!==undefined,e.fn.ajaxSubmit=function(n){function x(t){var r=new FormData;for(var i=0;i<t.length;i++)r.append(t[i].name,t[i].value);if(n.extraData)for(var s in n.extraData)n.extraData.hasOwnProperty(s)&&r.append(s,n.extraData[s]);n.data=null;var o=e.extend(!0,{},e.ajaxSettings,n,{contentType:!1,processData:!1,cache:!1,type:"POST"});n.uploadProgress&&(o.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var t=0,r=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(r/i*100)),n.uploadProgress(e,r,i,t)}),e}),o.data=null;var u=o.beforeSend;o.beforeSend=function(e,t){t.data=r,u&&u.call(t,e,n)},e.ajax(o)}function T(t){function x(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function C(){function o(){try{var e=x(d).readyState;i("state = "+e),e&&e.toLowerCase()=="uninitialized"&&setTimeout(o,50)}catch(t){i("Server abort: ",t," (",t.name,")"),M(S),b&&clearTimeout(b),b=undefined}}var t=u.attr("target"),n=u.attr("action");s.setAttribute("target",h),r||s.setAttribute("method","POST"),n!=f.url&&s.setAttribute("action",f.url),!f.skipEncodingOverride&&(!r||/post/i.test(r))&&u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(b=setTimeout(function(){y=!0,M(E)},f.timeout));var a=[];try{if(f.extraData)for(var l in f.extraData)f.extraData.hasOwnProperty(l)&&a.push(e('<input type="hidden" name="'+l+'">').attr("value",f.extraData[l]).appendTo(s)[0]);f.iframeTarget||(p.appendTo("body"),d.attachEvent?d.attachEvent("onload",M):d.addEventListener("load",M,!1)),setTimeout(o,15),s.submit()}finally{s.setAttribute("action",n),t?s.setAttribute("target",t):u.removeAttr("target"),e(a).remove()}}function M(t){if(v.aborted||O)return;try{L=x(d)}catch(n){i("cannot access response document: ",n),t=S}if(t===E&&v){v.abort("timeout");return}if(t==S&&v){v.abort("server abort");return}if(!L||L.location.href==f.iframeSrc)if(!y)return;d.detachEvent?d.detachEvent("onload",M):d.removeEventListener("load",M,!1);var r="success",s;try{if(y)throw"timeout";var o=f.dataType=="xml"||L.XMLDocument||e.isXMLDoc(L);i("isXml="+o);if(!o&&window.opera&&(L.body===null||!L.body.innerHTML)&&--A){i("requeing onLoad callback, DOM not available"),setTimeout(M,250);return}var u=L.body?L.body:L.documentElement;v.responseText=u?u.innerHTML:null,v.responseXML=L.XMLDocument?L.XMLDocument:L,o&&(f.dataType="xml"),v.getResponseHeader=function(e){var t={"content-type":f.dataType};return t[e]},u&&(v.status=Number(u.getAttribute("status"))||v.status,v.statusText=u.getAttribute("statusText")||v.statusText);var a=(f.dataType||"").toLowerCase(),l=/(json|script|text)/.test(a);if(l||f.textarea){var h=L.getElementsByTagName("textarea")[0];if(h)v.responseText=h.value,v.status=Number(h.getAttribute("status"))||v.status,v.statusText=h.getAttribute("statusText")||v.statusText;else if(l){var m=L.getElementsByTagName("pre")[0],g=L.getElementsByTagName("body")[0];m?v.responseText=m.textContent?m.textContent:m.innerText:g&&(v.responseText=g.textContent?g.textContent:g.innerText)}}else a=="xml"&&!v.responseXML&&v.responseText&&(v.responseXML=_(v.responseText));try{k=P(v,a,f)}catch(t){r="parsererror",v.error=s=t||r}}catch(t){i("error caught: ",t),r="error",v.error=s=t||r}v.aborted&&(i("upload aborted"),r=null),v.status&&(r=v.status>=200&&v.status<300||v.status===304?"success":"error"),r==="success"?(f.success&&f.success.call(f.context,k,"success",v),c&&e.event.trigger("ajaxSuccess",[v,f])):r&&(s===undefined&&(s=v.statusText),f.error&&f.error.call(f.context,v,r,s),c&&e.event.trigger("ajaxError",[v,f,s])),c&&e.event.trigger("ajaxComplete",[v,f]),c&&!--e.active&&e.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,v,r),O=!0,f.timeout&&clearTimeout(b),setTimeout(function(){f.iframeTarget||p.remove(),v.responseXML=null},100)}var s=u[0],o,a,f,c,h,p,d,v,m,g,y,b,w=!!e.fn.prop;if(e(":input[name=submit],:input[id=submit]",s).length){alert('Error: Form elements must not have name or id of "submit".');return}if(t)for(a=0;a<l.length;a++)o=e(l[a]),w?o.prop("disabled",!1):o.removeAttr("disabled");f=e.extend(!0,{},e.ajaxSettings,n),f.context=f.context||f,h="jqFormIO"+(new Date).getTime(),f.iframeTarget?(p=e(f.iframeTarget),g=p.attr("name"),g?h=g:p.attr("name",h)):(p=e('<iframe name="'+h+'" src="'+f.iframeSrc+'" />'),p.css({position:"absolute",top:"-1000px",left:"-1000px"})),d=p[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";i("aborting upload... "+n),this.aborted=1,p.attr("src",f.iframeSrc),v.error=n,f.error&&f.error.call(f.context,v,n,t),c&&e.event.trigger("ajaxError",[v,f,n]),f.complete&&f.complete.call(f.context,v,n)}},c=f.global,c&&0===e.active++&&e.event.trigger("ajaxStart"),c&&e.event.trigger("ajaxSend",[v,f]);if(f.beforeSend&&f.beforeSend.call(f.context,v,f)===!1){f.global&&e.active--;return}if(v.aborted)return;m=s.clk,m&&(g=m.name,g&&!m.disabled&&(f.extraData=f.extraData||{},f.extraData[g]=m.value,m.type=="image"&&(f.extraData[g+".x"]=s.clk_x,f.extraData[g+".y"]=s.clk_y)));var E=1,S=2,T=e("meta[name=csrf-token]").attr("content"),N=e("meta[name=csrf-param]").attr("content");N&&T&&(f.extraData=f.extraData||{},f.extraData[N]=T),f.forceSync?C():setTimeout(C,10);var k,L,A=50,O,_=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},D=e.parseJSON||function(e){return window.eval("("+e+")")},P=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=D(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o}}if(!this.length)return i("ajaxSubmit: skipping submit process - no element selected"),this;var r,s,o,u=this;typeof n=="function"&&(n={success:n}),r=this.attr("method"),s=this.attr("action"),o=typeof s=="string"?e.trim(s):"",o=o||window.location.href||"",o&&(o=(o.match(/^([^#]+)/)||[])[1]),n=e.extend(!0,{url:o,success:e.ajaxSettings.success,type:r||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var a={};this.trigger("form-pre-serialize",[this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var f=n.traditional;f===undefined&&(f=e.ajaxSettings.traditional);var l=[],c,h=this.formToArray(n.semantic,l);n.data&&(n.extraData=n.data,c=e.param(n.data,f));if(n.beforeSubmit&&n.beforeSubmit(h,this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[h,this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var p=e.param(h,f);c&&(p=p?p+"&"+c:c),n.type.toUpperCase()=="GET"?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+p,n.data=null):n.data=p;var d=[];n.resetForm&&d.push(function(){u.resetForm()}),n.clearForm&&d.push(function(){u.clearForm(n.includeHidden)});if(!n.dataType&&n.target){var v=n.success||function(){};d.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(v,arguments)})}else n.success&&d.push(n.success);n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=d.length;s<o;s++)d[s].apply(i,[e,t,r||u,u])};var m=e("input:file:enabled[value]",this),g=m.length>0,y="multipart/form-data",b=u.attr("enctype")==y||u.attr("encoding")==y,w=t.fileapi&&t.formdata;i("fileAPI :"+w);var E=(g||b)&&!w;n.iframe!==!1&&(n.iframe||E)?n.closeKeepAlive?e.get(n.closeKeepAlive,function(){T(h)}):T(h):(g||b)&&w?x(h):e.ajax(n);for(var S=0;S<l.length;S++)l[S]=null;return this.trigger("form-submit-notify",[this,n]),this},e.fn.ajaxForm=function(t){t=t||{},t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){var s={s:this.selector,c:this.context};return!e.isReady&&s.s?(i("DOM not ready, queuing ajaxForm"),e(function(){e(s.s,s.c).ajaxForm(t)}),this):(i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return t.delegation?(e(document).off("submit.form-plugin",this.selector,n).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,t,n).on("click.form-plugin",this.selector,t,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",t,n).bind("click.form-plugin",t,r)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(n,r){var i=[];if(this.length===0)return i;var s=this[0],o=n?s.getElementsByTagName("*"):s.elements;if(!o)return i;var u,a,f,l,c,h,p;for(u=0,h=o.length;u<h;u++){c=o[u],f=c.name;if(!f)continue;if(n&&s.clk&&c.type=="image"){!c.disabled&&s.clk==c&&(i.push({name:f,value:e(c).val(),type:c.type}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}));continue}l=e.fieldValue(c,!0);if(l&&l.constructor==Array){r&&r.push(c);for(a=0,p=l.length;a<p;a++)i.push({name:f,value:l[a]})}else if(t.fileapi&&c.type=="file"&&!c.disabled){r&&r.push(c);var d=c.files;if(d.length)for(a=0;a<d.length;a++)i.push({name:f,value:d[a],type:c.type});else i.push({name:f,value:"",type:c.type})}else l!==null&&typeof l!="undefined"&&(r&&r.push(c),i.push({name:f,value:l,type:c.type,required:c.required}))}if(!n&&s.clk){var v=e(s.clk),m=v[0];f=m.name,f&&!m.disabled&&m.type=="image"&&(i.push({name:f,value:v.val()}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||i=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:i=="select"?this.selectedIndex=-1:t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e===undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1})(jQuery),define("jquery.form",function(){}),function(e){e.Jcrop=function(t,n){function B(e){return""+parseInt(e)+"px"}function j(e){return""+parseInt(e)+"%"}function F(e){return s.baseClass+"-"+e}function I(t){var n=e(t).offset();return[n.left,n.top]}function q(e){return[e.pageX-C[0],e.pageY-C[1]]}function R(e){e!=L&&(P.setCursor(e),L=e)}function U(e,t){C=I(u),P.setCursor(e=="move"?e:e+"-resize");if(e=="move")return P.activateHandlers(W(t),Q);var n=_.getFixed(),r=X(e),i=_.getCorner(X(r));_.setPressed(_.getCorner(r)),_.setCurrent(i),P.activateHandlers(z(e,n),Q)}function z(e,t){return function(n){if(!s.aspectRatio)switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}else switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}_.setCurrent(n),D.update()}}function W(e){var t=e;return H.watchKeys(),function(e){_.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,D.update()}}function X(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function V(e){return function(t){return s.disabled?!1:e=="move"&&!s.allowMove?!1:(k=!0,U(e,q(t)),t.stopPropagation(),t.preventDefault(),!1)}}function J(e,t,n){var r=e.width(),i=e.height();r>t&&t>0&&(r=t,i=t/e.width()*e.height()),i>n&&n>0&&(i=n,r=n/e.height()*e.width()),x=e.width()/r,T=e.height()/i,e.width(r).height(i)}function K(e){return{x:parseInt(e.x*x),y:parseInt(e.y*T),x2:parseInt(e.x2*x),y2:parseInt(e.y2*T),w:parseInt(e.w*x),h:parseInt(e.h*T)}}function Q(e){var t=_.getFixed();t.w>s.minSelect[0]&&t.h>s.minSelect[1]?(D.enableHandles(),D.done()):D.release(),P.setCursor(s.allowSelect?"crosshair":"default")}function G(e){if(s.disabled)return!1;if(!s.allowSelect)return!1;k=!0,C=I(u),D.disableHandles(),R("crosshair");var t=q(e);return _.setPressed(t),P.activateHandlers(Y,Q),H.watchKeys(),D.update(),e.stopPropagation(),e.preventDefault(),!1}function Y(e){_.setCurrent(e),D.update()}function Z(){var t=e("<div></div>").addClass(F("tracker"));return e.browser.msie&&t.css({opacity:0,backgroundColor:"white"}),t}function et(e){function b(){window.setTimeout(y,f)}var t=e[0]/x,n=e[1]/T,r=e[2]/x,i=e[3]/T;if(O)return;var o=_.flipCoords(t,n,r,i),u=_.getFixed(),a=initcr=[u.x,u.y,u.x2,u.y2],f=s.animationDelay,l=a[0],c=a[1],r=a[2],i=a[3],h=o[0]-initcr[0],p=o[1]-initcr[1],d=o[2]-initcr[2],v=o[3]-initcr[3],m=0,g=s.swingSpeed;D.animMode(!0);var y=function(){return function(){m+=(100-m)/g,a[0]=l+m/100*h,a[1]=c+m/100*p,a[2]=r+m/100*d,a[3]=i+m/100*v,m<100?b():D.done(),m>=99.8&&(m=100),nt(a)}}();b()}function tt(e){nt([e[0]/x,e[1]/T,e[2]/x,e[3]/T])}function nt(e){_.setPressed([e[0],e[1]]),_.setCurrent([e[2],e[3]]),D.update()}function rt(t){typeof t!="object"&&(t={}),s=e.extend(s,t),typeof s.onChange!="function"&&(s.onChange=function(){}),typeof s.onSelect!="function"&&(s.onSelect=function(){})}function it(){return K(_.getFixed())}function st(){return _.getFixed()}function ot(e){rt(e),ct()}function ut(){s.disabled=!0,D.disableHandles(),D.setCursor("default"),P.setCursor("default")}function at(){s.disabled=!1,ct()}function ft(){D.done(),P.activateHandlers(null,null)}function lt(){l.remove(),o.show()}function ct(e){s.allowResize?e?D.enableOnly():D.enableHandles():D.disableHandles(),P.setCursor(s.allowSelect?"crosshair":"default"),D.setCursor(s.allowMove?"move":"default"),l.css("backgroundColor",s.bgColor),"setSelect"in s&&(tt(n.setSelect),D.done(),delete s.setSelect),"trueSize"in s&&(x=s.trueSize[0]/a,T=s.trueSize[1]/f),y=s.maxSize[0]||0,b=s.maxSize[1]||0,E=s.minSize[0]||0,S=s.minSize[1]||0,"outerImage"in s&&(u.attr("src",s.outerImage),delete s.outerImage),D.refresh()}var t=t,n=n;typeof t!="object"&&(t=e(t)[0]),typeof n!="object"&&(n={}),"trackDocument"in n||(n.trackDocument=e.browser.msie?!1:!0,e.browser.msie&&e.browser.version.split(".")[0]=="8"&&(n.trackDocument=!0)),"keySupport"in n||(n.keySupport=e.browser.msie?!1:!0);var r={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,borderOpacity:.4,handleOpacity:.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}},s=r;rt(n);var o=e(t),u=o.clone().removeAttr("id").css({position:"absolute"});u.width(o.width()),u.height(o.height()),o.after(u).hide(),J(u,s.boxWidth,s.boxHeight);var a=u.width(),f=u.height(),l=e("<div />").width(a).height(f).addClass(F("holder")).css({position:"relative",backgroundColor:s.bgColor}).insertAfter(o).append(u);s.addClass&&l.addClass(s.addClass);var c=e("<img />").attr("src",u.attr("src")).css("position","absolute").width(a).height(f),p=e("<div />").width(j(100)).height(j(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(c),d=e("<div />").width(j(100)).height(j(100)).css("zIndex",320),v=e("<div />").css({position:"absolute",zIndex:300}).insertBefore(u).append(p,d),m=s.boundary,g=Z().width(a+m*2).height(f+m*2).css({position:"absolute",top:B(-m),left:B(-m),zIndex:290}).mousedown(G),y,b,E,S,x,T,N=!0,C=I(u),k,L,A,O,M,_=function(){function u(i){var i=m(i);n=e=i[0],r=t=i[1]}function l(e){var e=m(e);i=e[0]-n,o=e[1]-r,n=e[0],r=e[1]}function c(){return[i,o]}function p(i){var s=i[0],o=i[1];0>e+s&&(s-=s+e),0>t+o&&(o-=o+t),f<r+o&&(o+=f-(r+o)),a<n+s&&(s+=a-(n+s)),e+=s,n+=s,t+=o,r+=o}function d(e){var t=v();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function v(){if(!s.aspectRatio)return N();var i=s.aspectRatio,o=s.minSize[0]/x,u=s.minSize[1]/T,l=s.maxSize[0]/x,c=s.maxSize[1]/T,p=n-e,d=r-t,v=Math.abs(p),m=Math.abs(d),y=v/m,b,E;return l==0&&(l=a*10),c==0&&(c=f*10),y<i?(E=r,w=m*i,b=p<0?e-w:w+e,b<0?(b=0,h=Math.abs((b-e)/i),E=d<0?t-h:h+t):b>a&&(b=a,h=Math.abs((b-e)/i),E=d<0?t-h:h+t)):(b=n,h=v/i,E=d<0?t-h:t+h,E<0?(E=0,w=Math.abs((E-t)*i),b=p<0?e-w:w+e):E>f&&(E=f,w=Math.abs(E-t)*i,b=p<0?e-w:w+e)),b>e?(b-e<o?b=e+o:b-e>l&&(b=e+l),E>t?E=t+(b-e)/i:E=t-(b-e)/i):b<e&&(e-b<o?b=e-o:e-b>l&&(b=e-l),E>t?E=t+(e-b)/i:E=t-(e-b)/i),b<0?(e-=b,b=0):b>a&&(e-=b-a,b=a),E<0?(t-=E,E=0):E>f&&(t-=E-f,E=f),last=C(g(e,t,b,E))}function m(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>a&&(e[0]=a),e[1]>f&&(e[1]=f),[e[0],e[1]]}function g(e,t,n,r){var i=e,s=n,o=t,u=r;return n<e&&(i=n,s=e),r<t&&(o=r,u=t),[Math.round(i),Math.round(o),Math.round(s),Math.round(u)]}function N(){var i=n-e,s=r-t;y&&Math.abs(i)>y&&(n=i>0?e+y:e-y),b&&Math.abs(s)>b&&(r=s>0?t+b:t-b),S&&Math.abs(s)<S&&(r=s>0?t+S:t-S),E&&Math.abs(i)<E&&(n=i>0?e+E:e-E),e<0&&(n-=e,e-=e),t<0&&(r-=t,t-=t),n<0&&(e-=n,n-=n),r<0&&(t-=r,r-=r);if(n>a){var o=n-a;e-=o,n-=o}if(r>f){var o=r-f;t-=o,r-=o}if(e>a){var o=e-f;r-=o,t-=o}if(t>f){var o=t-f;r-=o,t-=o}return C(g(e,t,n,r))}function C(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var e=0,t=0,n=0,r=0,i,o;return{flipCoords:g,setPressed:u,setCurrent:l,getOffset:c,moveOffset:p,getCorner:d,getFixed:v}}(),D=function(){function g(t){var n=e("<div />").css({position:"absolute",opacity:s.borderOpacity}).addClass(F(t));return p.append(n),n}function y(t,n){var r=e("<div />").mousedown(V(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n});return d.append(r),r}function b(e){return y(e,a++).css({top:B(-m+1),left:B(-m+1),opacity:s.handleOpacity}).addClass(F("handle"))}function w(e){var t=s.handleSize,n=m,r=t,i=t,o=n,u=n;switch(e){case"n":case"s":i=j(100);break;case"e":case"w":r=j(100)}return y(e,a++).width(i).height(r).css({top:B(-o+1),left:B(-u+1)})}function E(e){for(i in e)l[e[i]]=b(e[i])}function S(e){var t=Math.round(e.h/2-m),n=Math.round(e.w/2-m),r=west=-m+1,i=e.w-m,s=e.h-m,o,u;"e"in l&&l.e.css({top:B(t),left:B(i)})&&l.w.css({top:B(t)})&&l.s.css({top:B(s),left:B(n)})&&l.n.css({left:B(n)}),"ne"in l&&l.ne.css({left:B(i)})&&l.se.css({top:B(s),left:B(i)})&&l.sw.css({top:B(s)}),"b"in l&&l.b.css({top:B(s)})&&l.r.css({left:B(i)})}function x(e,t){c.css({top:B(-t),left:B(-e)}),v.css({top:B(t),left:B(e)})}function T(e,t){v.width(e).height(t)}function N(){var e=_.getFixed();_.setPressed([e.x,e.y]),_.setCurrent([e.x2,e.y2]),C()}function C(){if(o)return k()}function k(){var e=_.getFixed();T(e.w,e.h),x(e.x,e.y),s.drawBorders&&f.right.css({left:B(e.w-1)})&&f.bottom.css({top:B(e.h-1)}),h&&S(e),o||L(),s.onChange(K(e))}function L(){v.show(),u.css("opacity",s.bgOpacity),o=!0}function A(){P(),v.hide(),u.css("opacity",1),o=!1}function M(){h&&(S(_.getFixed()),d.show())}function D(){h=!0;if(s.allowResize)return S(_.getFixed()),d.show(),!0}function P(){h=!1,d.hide()}function H(e){(O=e)?P():D()}function I(){H(!1),N()}var t,n,r,o,a=370,f={},l={},h=!1,m=s.handleOffset;s.drawBorders&&(f={top:g("hline").css("top",e.browser.msie?B(-1):B(0)),bottom:g("hline"),left:g("vline"),right:g("vline")}),s.dragEdges&&(l.t=w("n"),l.b=w("s"),l.r=w("e"),l.l=w("w")),s.sideHandles&&E(["n","s","e","w"]),s.cornerHandles&&E(["sw","nw","ne","se"]);var q=Z().mousedown(V("move")).css({cursor:"move",position:"absolute",zIndex:360});return p.append(q),P(),{updateVisible:C,update:k,release:A,refresh:N,setCursor:function(e){q.css("cursor",e)},enableHandles:D,enableOnly:function(){h=!0},showHandles:M,disableHandles:P,animMode:H,done:I}}(),P=function(){function i(){g.css({zIndex:450}),r&&e(document).mousemove(a).mouseup(f)}function o(){g.css({zIndex:290}),r&&e(document).unbind("mousemove",a).unbind("mouseup",f)}function a(e){t(q(e))}function f(e){return e.preventDefault(),e.stopPropagation(),k&&(k=!1,n(q(e)),s.onSelect(K(_.getFixed())),o(),t=function(){},n=function(){}),!1}function l(e,r){return k=!0,t=e,n=r,i(),!1}function c(e){g.css("cursor",e)}var t=function(){},n=function(){},r=s.trackDocument;return r||g.mousemove(a).mouseup(f).mouseout(f),u.before(g),{activateHandlers:l,setCursor:c}}(),H=function(){function r(){s.keySupport&&(t.show(),t.focus())}function i(e){t.hide()}function o(e,t,n){s.allowMove&&(_.moveOffset([t,n]),D.updateVisible()),e.preventDefault(),e.stopPropagation()}function a(e){if(e.ctrlKey)return!0;M=e.shiftKey?!0:!1;var t=M?10:1;switch(e.keyCode){case 37:o(e,-t,0);break;case 39:o(e,t,0);break;case 38:o(e,0,-t);break;case 40:o(e,0,t);break;case 27:D.release();break;case 9:return!0}return nothing(e)}var t=e('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(a).blur(i),n=e("<div />").css({position:"absolute",overflow:"hidden"}).append(t);return s.keySupport&&n.insertBefore(u),{watchKeys:r}}();d.hide(),ct(!0);var ht={animateTo:et,setSelect:tt,setOptions:ot,tellSelect:it,tellScaled:st,disable:ut,enable:at,cancel:ft,focus:H.watchKeys,getBounds:function(){return[a*x,f*T]},getWidgetSize:function(){return[a,f]},release:D.release,destroy:lt};return o.data("Jcrop",ht),ht},e.fn.Jcrop=function(t){function n(n){var r=t.useImg||n.src,i=new Image;i.onload=function(){e.Jcrop(n,t)},i.src=r}return typeof t!="object"&&(t={}),this.each(function(){if(e(this).data("Jcrop")){if(t=="api")return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else n(this)}),this}}(jQuery),define("jquery.jcrop",function(){}),function(e){e.fn.textareaCount=function(t,n){function c(){return o.html(h()),e(".charleft").css("background-color","#EFEFEF"),typeof n!="undefined"&&n.call(this,d()),!0}function h(){var e=i.val(),n=e.length;if(t.maxCharacterSize>0){n>=t.maxCharacterSize&&(e=e.substring(0,t.maxCharacterSize));var r=g(e),s=t.maxCharacterSize-r;m()||(s=t.maxCharacterSize);if(n>s){var c=this.scrollTop;i.val(e.substring(0,s)),this.scrollTop=c}o.removeClass(t.warningStyle),s-n<=t.warningNumber&&o.addClass(t.warningStyle),u=i.val().length+r,m()||(u=i.val().length),l=b(y(i.val())),f=a-u}else{var r=g(e);u=i.val().length+r,m()||(u=i.val().length),l=b(y(i.val()))}return p()}function p(){var e=t.displayFormat;return e=e.replace("#input",u),e=e.replace("#words",l),a>0&&(e=e.replace("#max",a),e=e.replace("#left",f)),e}function d(){var e={input:u,max:a,left:f,words:l};return e}function v(e){return e.next(".charleft")}function m(){var e=navigator.appVersion;return e.toLowerCase().indexOf("win")!=-1?!0:!1}function g(e){var t=0;for(var n=0;n<e.length;n++)e.charAt(n)=="\n"&&t++;return t}function y(e){var t=e+" ",n=/^[^A-Za-z0-9]+/gi,r=t.replace(n,""),i=rExp=/[^A-Za-z0-9]+/gi,s=r.replace(i," "),o=s.split(" ");return o}function b(e){var t=e.length-1;return t}var r={maxCharacterSize:-1,originalStyle:"originalTextareaInfo",warningStyle:"warningTextareaInfo",warningNumber:20,displayFormat:"#input characters | #words words"},t=e.extend(r,t),i=e(this);e("<div class='charleft'>&nbsp;</div>").insertAfter(i);var s={},o=v(i);o.addClass(t.originalStyle),o.css(s);var u=0,a=t.maxCharacterSize,f=0,l=0;i.bind("keyup",function(e){c()}).bind("mouseover",function(e){setTimeout(function(){c()},10)}).bind("paste",function(e){setTimeout(function(){c()},10)})}}(jQuery),define("jquery.textarea.counter",function(){}),function(e){function t(){this._disabledInputs=[],this.regional=[],this.regional[""]={show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]},this._defaults={appendText:"",showSeconds:!1,timeSteps:[1,1,1],initialField:0,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:!1,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null},e.extend(this._defaults,this.regional[""])}function r(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=null);return t}var n="timeEntry";e.extend(t.prototype,{markerClassName:"hasTimeEntry",setDefaults:function(e){return r(this._defaults,e||{}),this},_connectTimeEntry:function(t,r){var i=e(t);if(i.hasClass(this.markerClassName))return;var s={};s.options=e.extend({},r),s._selectedHour=0,s._selectedMinute=0,s._selectedSecond=0,s._field=0,s.input=e(t),e.data(t,n,s);var o=this._get(s,"spinnerImage"),u=this._get(s,"spinnerText"),a=this._get(s,"spinnerSize"),f=this._get(s,"appendText"),l=o?e('<span class="timeEntry_control" style="display: inline-block; background: url(\''+o+"') 0 0 no-repeat; "+"width: "+a[0]+"px; height: "+a[1]+"px;"+(e.browser.mozilla&&e.browser.version<"1.9"?" padding-left: "+a[0]+"px; padding-bottom: "+(a[1]-18)+"px;":"")+'"></span>'):null;i.wrap('<span class="timeEntry_wrap"></span>').after(f?'<span class="timeEntry_append">'+f+"</span>":"").after(l||""),i.addClass(this.markerClassName).bind("focus.timeEntry",this._doFocus).bind("blur.timeEntry",this._doBlur).bind("click.timeEntry",this._doClick).bind("keydown.timeEntry",this._doKeyDown).bind("keypress.timeEntry",this._doKeyPress),e.browser.mozilla&&i.bind("input.timeEntry",function(t){e.timeEntry._parseTime(s)}),e.browser.msie&&i.bind("paste.timeEntry",function(t){setTimeout(function(){e.timeEntry._parseTime(s)},1)}),this._get(s,"useMouseWheel")&&e.fn.mousewheel&&i.mousewheel(this._doMouseWheel),l&&l.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)},_enableTimeEntry:function(e){this._enableDisable(e,!1)},_disableTimeEntry:function(e){this._enableDisable(e,!0)},_enableDisable:function(t,r){var i=e.data(t,n);if(!i)return;t.disabled=r,t.nextSibling&&t.nextSibling.nodeName.toLowerCase()=="span"&&e.timeEntry._changeSpinner(i,t.nextSibling,r?5:-1),e.timeEntry._disabledInputs=e.map(e.timeEntry._disabledInputs,function(e){return e==t?null:e}),r&&e.timeEntry._disabledInputs.push(t)},_isDisabledTimeEntry:function(t){return e.inArray(t,this._disabledInputs)>-1},_changeTimeEntry:function(t,i,s){var o=e.data(t,n);if(o){if(typeof i=="string"){var u=i;i={},i[u]=s}var a=this._extractTime(o);r(o.options,i||{}),a&&this._setTime(o,new Date(0,0,0,a[0],a[1],a[2]))}e.data(t,n,o)},_destroyTimeEntry:function(t){$input=e(t);if(!$input.hasClass(this.markerClassName))return;$input.removeClass(this.markerClassName).unbind(".timeEntry"),e.fn.mousewheel&&$input.unmousewheel(),this._disabledInputs=e.map(this._disabledInputs,function(e){return e==t?null:e}),$input.parent().replaceWith($input),e.removeData(t,n)},_setTimeTimeEntry:function(t,r){var i=e.data(t,n);i&&(r===null||r===""?i.input.val(""):this._setTime(i,r?typeof r=="object"?new Date(r.getTime()):r:null))},_getTimeTimeEntry:function(t){var r=e.data(t,n),i=r?this._extractTime(r):null;return i?new Date(0,0,0,i[0],i[1],i[2]):null},_getOffsetTimeEntry:function(t){var r=e.data(t,n),i=r?this._extractTime(r):null;return i?(i[0]*3600+i[1]*60+i[2])*1e3:0},_doFocus:function(t){var i=t.nodeName&&t.nodeName.toLowerCase()=="input"?t:this;if(e.timeEntry._lastInput==i||e.timeEntry._isDisabledTimeEntry(i)){e.timeEntry._focussed=!1;return}var s=e.data(i,n);e.timeEntry._focussed=!0,e.timeEntry._lastInput=i,e.timeEntry._blurredInput=null;var o=e.timeEntry._get(s,"beforeShow");r(s.options,o?o.apply(i,[i]):{}),e.data(i,n,s),e.timeEntry._parseTime(s),setTimeout(function(){e.timeEntry._showField(s)},10)},_doBlur:function(t){e.timeEntry._blurredInput=e.timeEntry._lastInput,e.timeEntry._lastInput=null},_doClick:function(t){var r=t.target,i=e.data(r,n);if(!e.timeEntry._focussed){var s=e.timeEntry._get(i,"separator").length+2;i._field=0;if(r.selectionStart!=null)for(var o=0;o<=Math.max(1,i._secondField,i._ampmField);o++){var u=o!=i._ampmField?o*s+2:i._ampmField*s+e.timeEntry._get(i,"ampmPrefix").length+e.timeEntry._get(i,"ampmNames")[0].length;i._field=o;if(r.selectionStart<u)break}else if(r.createTextRange){var a=e(t.srcElement),f=r.createTextRange(),l=function(e){return{thin:2,medium:4,thick:6}[e]||e},c=t.clientX+document.documentElement.scrollLeft-(a.offset().left+parseInt(l(a.css("border-left-width")),10))-f.offsetLeft;for(var o=0;o<=Math.max(1,i._secondField,i._ampmField);o++){var u=o!=i._ampmField?o*s+2:i._ampmField*s+e.timeEntry._get(i,"ampmPrefix").length+e.timeEntry._get(i,"ampmNames")[0].length;f.collapse(),f.moveEnd("character",u),i._field=o;if(c<f.boundingWidth)break}}}e.data(r,n,i),e.timeEntry._showField(i),e.timeEntry._focussed=!1},_doKeyDown:function(t){if(t.keyCode>=48)return!0;var r=e.data(t.target,n);switch(t.keyCode){case 9:return t.shiftKey?e.timeEntry._changeField(r,-1,!0):e.timeEntry._changeField(r,1,!0);case 35:t.ctrlKey?e.timeEntry._setValue(r,""):(r._field=Math.max(1,r._secondField,r._ampmField),e.timeEntry._adjustField(r,0));break;case 36:t.ctrlKey?e.timeEntry._setTime(r):(r._field=0,e.timeEntry._adjustField(r,0));break;case 37:e.timeEntry._changeField(r,-1,!1);break;case 38:e.timeEntry._adjustField(r,1);break;case 39:e.timeEntry._changeField(r,1,!1);break;case 40:e.timeEntry._adjustField(r,-1);break;case 46:e.timeEntry._setValue(r,"")}return!1},_doKeyPress:function(t){var r=String.fromCharCode(t.charCode==undefined?t.keyCode:t.charCode);if(r<" ")return!0;var i=e.data(t.target,n);return e.timeEntry._handleKeyPress(i,r),!1},_doMouseWheel:function(t,r){if(e.timeEntry._isDisabledTimeEntry(t.target))return;r=e.browser.opera?-r/Math.abs(r):e.browser.safari?r/Math.abs(r):r;var i=e.data(t.target,n);i.input.focus(),i.input.val()||e.timeEntry._parseTime(i),e.timeEntry._adjustField(i,r),t.preventDefault()},_expandSpinner:function(t){var r=e.timeEntry._getSpinnerTarget(t),i=e.data(e.timeEntry._getInput(r),n);if(e.timeEntry._isDisabledTimeEntry(i.input[0]))return;var s=e.timeEntry._get(i,"spinnerBigImage");if(s){i._expanded=!0;var o=e(r).offset(),u=null;e(r).parents().each(function(){var t=e(this);if(t.css("position")=="relative"||t.css("position")=="absolute")u=t.offset();return!u});var a=e.timeEntry._get(i,"spinnerSize"),f=e.timeEntry._get(i,"spinnerBigSize");e('<div class="timeEntry_expand" style="position: absolute; left: '+(o.left-(f[0]-a[0])/2-(u?u.left:0))+"px; top: "+(o.top-(f[1]-a[1])/2-(u?u.top:0))+"px; width: "+f[0]+"px; height: "+f[1]+"px; background: transparent url("+s+') no-repeat 0px 0px; z-index: 10;"></div>').mousedown(e.timeEntry._handleSpinner).mouseup(e.timeEntry._endSpinner).mouseout(e.timeEntry._endExpand).mousemove(e.timeEntry._describeSpinner).insertAfter(r)}},_getInput:function(t){return e(t).siblings("."+e.timeEntry.markerClassName)[0]},_describeSpinner:function(t){var r=e.timeEntry._getSpinnerTarget(t),i=e.data(e.timeEntry._getInput(r),n);r.title=e.timeEntry._get(i,"spinnerTexts")[e.timeEntry._getSpinnerRegion(i,t)]},_handleSpinner:function(t){var r=e.timeEntry._getSpinnerTarget(t),i=e.timeEntry._getInput(r);if(e.timeEntry._isDisabledTimeEntry(i))return;i==e.timeEntry._blurredInput&&(e.timeEntry._lastInput=i,e.timeEntry._blurredInput=null);var s=e.data(i,n);e.timeEntry._doFocus(i);var o=e.timeEntry._getSpinnerRegion(s,t);e.timeEntry._changeSpinner(s,r,o),e.timeEntry._actionSpinner(s,o),e.timeEntry._timer=null,e.timeEntry._handlingSpinner=!0;var u=e.timeEntry._get(s,"spinnerRepeat");o>=3&&u[0]&&(e.timeEntry._timer=setTimeout(function(){e.timeEntry._repeatSpinner(s,o)},u[0]),e(r).one("mouseout",e.timeEntry._releaseSpinner).one("mouseup",e.timeEntry._releaseSpinner))},_actionSpinner:function(t,n){t.input.val()||e.timeEntry._parseTime(t);switch(n){case 0:this._setTime(t);break;case 1:this._changeField(t,-1,!1);break;case 2:this._changeField(t,1,!1);break;case 3:this._adjustField(t,1);break;case 4:this._adjustField(t,-1)}},_repeatSpinner:function(t,n){if(!e.timeEntry._timer)return;e.timeEntry._lastInput=e.timeEntry._blurredInput,this._actionSpinner(t,n),this._timer=setTimeout(function(){e.timeEntry._repeatSpinner(t,n)},this._get(t,"spinnerRepeat")[1])},_releaseSpinner:function(t){clearTimeout(e.timeEntry._timer),e.timeEntry._timer=null},_endExpand:function(t){e.timeEntry._timer=null;var r=e.timeEntry._getSpinnerTarget(t),i=e.timeEntry._getInput(r),s=e.data(i,n);e(r).remove(),s._expanded=!1},_endSpinner:function(t){e.timeEntry._timer=null;var r=e.timeEntry._getSpinnerTarget(t),i=e.timeEntry._getInput(r),s=e.data(i,n);e.timeEntry._isDisabledTimeEntry(i)||e.timeEntry._changeSpinner(s,r,-1),e.timeEntry._handlingSpinner&&(e.timeEntry._lastInput=e.timeEntry._blurredInput),e.timeEntry._lastInput&&e.timeEntry._handlingSpinner&&e.timeEntry._showField(s),e.timeEntry._handlingSpinner=!1},_getSpinnerTarget:function(e){return e.target||e.srcElement},_getSpinnerRegion:function(t,n){var r=this._getSpinnerTarget(n),i=e.browser.opera||e.browser.safari?e.timeEntry._findPos(r):e(r).offset(),s=e.browser.safari?e.timeEntry._findScroll(r):[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop],o=this._get(t,"spinnerIncDecOnly"),u=o?99:n.clientX+s[0]-i.left-(e.browser.msie?2:0),a=n.clientY+s[1]-i.top-(e.browser.msie?2:0),f=this._get(t,t._expanded?"spinnerBigSize":"spinnerSize"),l=o?99:f[0]-1-u,c=f[1]-1-a;if(f[2]>0&&Math.abs(u-l)<=f[2]&&Math.abs(a-c)<=f[2])return 0;var h=Math.min(u,a,l,c);return h==u?1:h==l?2:h==a?3:4},_changeSpinner:function(t,n,r){e(n).css("background-position","-"+(r+1)*this._get(t,t._expanded?"spinnerBigSize":"spinnerSize")[0]+"px 0px")},_findPos:function(e){var t=curTop=0;if(e.offsetParent){t=e.offsetLeft,curTop=e.offsetTop;while(e=e.offsetParent){var n=t;t+=e.offsetLeft,t<0&&(t=n),curTop+=e.offsetTop}}return{left:t,top:curTop}},_findScroll:function(t){var n=!1;e(t).parents().each(function(){n|=e(this).css("position")=="fixed"});if(n)return[0,0];var r=t.scrollLeft,i=t.scrollTop;while(t=t.parentNode)r+=t.scrollLeft||0,i+=t.scrollTop||0;return[r,i]},_get:function(t,n){return t.options[n]!=null?t.options[n]:e.timeEntry._defaults[n]},_parseTime:function(e){var t=this._extractTime(e),n=this._get(e,"showSeconds");if(t)e._selectedHour=t[0],e._selectedMinute=t[1],e._selectedSecond=t[2];else{var r=this._constrainTime(e);e._selectedHour=r[0],e._selectedMinute=r[1],e._selectedSecond=n?r[2]:0}e._secondField=n?2:-1,e._ampmField=this._get(e,"show24Hours")?-1:n?3:2,e._lastChr="",e._field=Math.max(0,Math.min(Math.max(1,e._secondField,e._ampmField),this._get(e,"initialField"))),e.input.val()!=""&&this._showTime(e)},_extractTime:function(e,t){t=t||e.input.val();var n=this._get(e,"separator"),r=t.split(n);n==""&&t!=""&&(r[0]=t.substring(0,2),r[1]=t.substring(2,4),r[2]=t.substring(4,6));var i=this._get(e,"ampmNames"),s=this._get(e,"show24Hours");if(r.length>=2){var o=!s&&t.indexOf(i[0])>-1,u=!s&&t.indexOf(i[1])>-1,a=parseInt(r[0],10);a=isNaN(a)?0:a,a=((o||u)&&a==12?0:a)+(u?12:0);var f=parseInt(r[1],10);f=isNaN(f)?0:f;var l=r.length>=3?parseInt(r[2],10):0;return l=isNaN(l)||!this._get(e,"showSeconds")?0:l,this._constrainTime(e,[a,f,l])}return null},_constrainTime:function(e,t){var n=t!=null;if(!n){var r=this._determineTime(e,this._get(e,"defaultTime"))||new Date;t=[r.getHours(),r.getMinutes(),r.getSeconds()]}var i=!1,s=this._get(e,"timeSteps");for(var o=0;o<s.length;o++)i?t[o]=0:s[o]>1&&(t[o]=Math.round(t[o]/s[o])*s[o],i=!0);return t},_showTime:function(e){var t=this._get(e,"show24Hours"),n=this._get(e,"separator"),r=this._formatNumber(t?e._selectedHour:(e._selectedHour+11)%12+1)+n+this._formatNumber(e._selectedMinute)+(this._get(e,"showSeconds")?n+this._formatNumber(e._selectedSecond):"")+(t?"":this._get(e,"ampmPrefix")+this._get(e,"ampmNames")[e._selectedHour<12?0:1]);this._setValue(e,r),this._showField(e)},_showField:function(t){var n=t.input[0];if(t.input.is(":hidden")||e.timeEntry._lastInput!=n)return;var r=this._get(t,"separator"),i=r.length+2,s=t._field!=t._ampmField?t._field*i:t._ampmField*i-r.length+this._get(t,"ampmPrefix").length,o=s+(t._field!=t._ampmField?2:this._get(t,"ampmNames")[0].length);if(n.setSelectionRange)n.setSelectionRange(s,o);else if(n.createTextRange){var u=n.createTextRange();u.moveStart("character",s),u.moveEnd("character",o-t.input.val().length),u.select()}n.disabled||n.focus()},_formatNumber:function(e){return(e<10?"0":"")+e},_setValue:function(e,t){t!=e.input.val()&&e.input.val(t).trigger("change")},_changeField:function(t,r,i){var s=t.input.val()==""||t._field==(r==-1?0:Math.max(1,t._secondField,t._ampmField));return s||(t._field+=r),this._showField(t),t._lastChr="",e.data(t.input[0],n,t),s&&i},_adjustField:function(e,t){e.input.val()==""&&(t=0);var n=this._get(e,"timeSteps");this._setTime(e,new Date(0,0,0,e._selectedHour+(e._field==0?t*n[0]:0)+(e._field==e._ampmField?t*12:0),e._selectedMinute+(e._field==1?t*n[1]:0),e._selectedSecond+(e._field==e._secondField?t*n[2]:0)))},_setTime:function(t,r){r=this._determineTime(t,r);var i=this._constrainTime(t,r?[r.getHours(),r.getMinutes(),r.getSeconds()]:null);r=new Date(0,0,0,i[0],i[1],i[2]);var r=this._normaliseTime(r),s=this._normaliseTime(this._determineTime(t,this._get(t,"minTime"))),o=this._normaliseTime(this._determineTime(t,this._get(t,"maxTime")));r=s&&r<s?s:o&&r>o?o:r;var u=this._get(t,"beforeSetTime");u&&(r=u.apply(t.input[0],[this._getTimeTimeEntry(t.input[0]),r,s,o])),t._selectedHour=r.getHours(),t._selectedMinute=r.getMinutes(),t._selectedSecond=r.getSeconds(),this._showTime(t),e.data(t.input[0],n,t)},_normaliseTime:function(e){return e?(e.setFullYear(1900),e.setMonth(0),e.setDate(0),e):null},_determineTime:function(t,n){var r=function(e){var t=new Date;return t.setTime(t.getTime()+e*1e3),t},i=function(n){var r=e.timeEntry._extractTime(t,n),i=new Date,s=r?r[0]:i.getHours(),o=r?r[1]:i.getMinutes(),u=r?r[2]:i.getSeconds();if(!r){var a=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,f=a.exec(n);while(f){switch(f[2]||"s"){case"s":case"S":u+=parseInt(f[1],10);break;case"m":case"M":o+=parseInt(f[1],10);break;case"h":case"H":s+=parseInt(f[1],10)}f=a.exec(n)}}return i=new Date(0,0,10,s,o,u,0),/^!/.test(n)&&(i.getDate()>10?i=new Date(0,0,10,23,59,59):i.getDate()<10&&(i=new Date(0,0,10,0,0,0))),i};return n?typeof n=="string"?i(n):typeof n=="number"?r(n):n:null},_handleKeyPress:function(e,t){if(t==this._get(e,"separator"))this._changeField(e,1,!1);else if(t>="0"&&t<="9"){var n=parseInt(t,10),r=parseInt(e._lastChr+t,10),i=this._get(e,"show24Hours"),s=e._field!=0?e._selectedHour:i?r<24?r:n:(r>=1&&r<=12?r:n>0?n:e._selectedHour)%12+(e._selectedHour>=12?12:0),o=e._field!=1?e._selectedMinute:r<60?r:n,u=e._field!=e._secondField?e._selectedSecond:r<60?r:n,a=this._constrainTime(e,[s,o,u]);this._setTime(e,new Date(0,0,0,a[0],a[1],a[2])),e._lastChr=t}else if(!this._get(e,"show24Hours")){t=t.toLowerCase();var f=this._get(e,"ampmNames");if(t==f[0].substring(0,1).toLowerCase()&&e._selectedHour>=12||t==f[1].substring(0,1).toLowerCase()&&e._selectedHour<12){var l=e._field;e._field=e._ampmField,this._adjustField(e,1),e._field=l,this._showField(e)}}}});var i=["getOffset","getTime","isDisabled"];e.fn.timeEntry=function(t){var n=Array.prototype.slice.call(arguments,1);return typeof t=="string"&&e.inArray(t,i)>-1?e.timeEntry["_"+t+"TimeEntry"].apply(e.timeEntry,[this[0]].concat(n)):this.each(function(){var r=this.nodeName.toLowerCase();if(r=="input")if(typeof t=="string")e.timeEntry["_"+t+"TimeEntry"].apply(e.timeEntry,[this].concat(n));else{var i=e.fn.metadata?e(this).metadata():{};e.timeEntry._connectTimeEntry(this,e.extend(i,t))}})},e.timeEntry=new t}(jQuery),define("jquery.timepicker",function(){}),function(e,t){var n="hidden",r='<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">',i=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing"],s="oninput",o="onpropertychange",u=e(r)[0];u.setAttribute(s,"return"),e.isFunction(u[s])||o in u?e.fn.autosize=function(t){return this.each(function(){function m(){var e,t;h||(h=!0,f.value=u.value,f.style.overflowY=u.style.overflowY,f.style.width=a.css("width"),f.scrollTop=0,f.scrollTop=9e4,e=f.scrollTop,t=n,e>c?(e=c,t="scroll"):e<l&&(e=l),u.style.overflowY=t,u.style.height=e+v+"px",setTimeout(function(){h=!1},1))}var u=this,a=e(u),f,l=a.height(),c=parseInt(a.css("maxHeight"),10),h,p=i.length,d,v=a.css("box-sizing")==="border-box"?a.outerHeight()-a.height():0;if(a.data("mirror")||a.data("ismirror"))return;f=e(r).data("ismirror",!0).addClass(t||"autosizejs")[0],d=a.css("resize")==="none"?"none":"horizontal",a.data("mirror",e(f)).css({overflow:n,overflowY:n,wordWrap:"break-word",resize:d}),c=c&&c>0?c:9e4;while(p--)f.style[i[p]]=a.css(i[p]);e("body").append(f),o in u?s in u?u[s]=u.onkeyup=m:u[o]=m:u[s]=m,e(window).resize(m),a.bind("autosize",m),m()})}:e.fn.autosize=function(){return this}}(jQuery),define("jquery.textarea.autosize",function(){}),function(e){function n(e,t){this.settings=e,this.dom=t,this.originalValue=null,this.didInsertDefaultText=!1,this.shouldDelayReinit=!1}function r(e){if(e.url||e.callback)return;throw new Error("Need to set either url: or callback: option for the inline editor to work.")}function i(e){if(""===e)return;var t=new Image;t.src=e}function s(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function o(e){return undefined===e||null===e?!1:0===e.length?!1:!0}e.fn.editInPlace=function(t){var s=e.extend({},e.fn.editInPlace.defaults,t);return r(s),i(s.saving_image),this.each(function(){var t=e(this);if(t.data("editInPlace"))return;t.data("editInPlace",!0),(new n(s,t)).init()})},e.fn.editInPlace.defaults={url:"",bg_out:"transparent",hover_class:"",show_buttons:!1,save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',params:"",field_type:"text",default_text:"(Click here to add text)",use_html:!1,textarea_rows:10,textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:undefined,saving_image:"",saving_animation_color:"transparent",value_required:!1,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:!1,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:!1,success:null,error:null,error_sink:function(e,t){alert(t)},preinit:null,postclose:null,delegate:null};var t={shouldOpenEditInPlace:function(e,t,n){},willOpenEditInPlace:function(e,t){},didOpenEditInPlace:function(e,t){},shouldCloseEditInPlace:function(e,t,n){},willCloseEditInPlace:function(e,t){},didCloseEditInPlace:function(e,t){},missingCommaErrorPreventer:""};e.extend(n.prototype,{init:function(){this.setDefaultTextIfNeccessary(),this.connectOpeningEvents()},reinit:function(){if(this.shouldDelayReinit)return;this.triggerCallback(this.settings.postclose,this.dom),this.triggerDelegateCall("didCloseEditInPlace"),this.markEditorAsInactive(),this.connectOpeningEvents()},setDefaultTextIfNeccessary:function(){if(""!==this.dom.html())return;this.dom.html(this.settings.default_text),this.didInsertDefaultText=!0},connectOpeningEvents:function(){var e=this;this.dom.bind("mouseenter.editInPlace",function(){e.addHoverEffect()}).bind("mouseleave.editInPlace",function(){e.removeHoverEffect()}).bind("click.editInPlace",function(t){e.openEditor(t)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){this.settings.hover_class?this.dom.addClass(this.settings.hover_class):this.dom.css("background-color",this.settings.bg_over)},removeHoverEffect:function(){this.settings.hover_class?this.dom.removeClass(this.settings.hover_class):this.dom.css("background-color",this.settings.bg_out)},openEditor:function(e){if(!this.shouldOpenEditor(e))return;this.disconnectOpeningEvents(),this.removeHoverEffect(),this.removeInsertedDefaultTextIfNeccessary(),this.saveOriginalValue(),this.markEditorAsActive(),this.replaceContentWithEditor(),this.setInitialValue(),this.workAroundMissingBlurBug(),this.connectClosingEventsToEditor(),this.triggerDelegateCall("didOpenEditInPlace")},shouldOpenEditor:function(e){return this.isClickedObjectCancelled(e.target)?!1:!1===this.triggerCallback(this.settings.preinit,this.dom)?!1:!1===this.triggerDelegateCall("shouldOpenEditInPlace",!0,e)?!1:!0},removeInsertedDefaultTextIfNeccessary:function(){if(!this.didInsertDefaultText||this.dom.html()!==this.settings.default_text||this.dom.html()===this.settings.default_text)return;this.dom.html(""),this.didInsertDefaultText=!1},isClickedObjectCancelled:function(t){if(!this.settings.cancel)return!1;var n=e(t).parents().andSelf(),r=n.filter(this.settings.cancel);return 0!==r.length},saveOriginalValue:function(){this.settings.use_html?this.originalValue=this.dom.html():this.originalValue=s(this.dom.text())},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(e){this.settings.use_html?this.dom.html(e):this.dom.text(e)},workAroundMissingBlurBug:function(){var e=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(e).blur()},replaceContentWithEditor:function(){var e=this.settings.show_buttons?this.settings.save_button+" "+this.settings.cancel_button:"",t=this.createEditorElement();this.dom.html('<form class="inplace_form" style="display: inline; margin: 0; padding: 0;"></form>').find("form").append(t).append(e)},createEditorElement:function(){if(-1===e.inArray(this.settings.field_type,["text","textarea","select"]))throw"Unknown field_type <fnord>, supported are 'text', 'textarea' and 'select'";var t=null;return"select"===this.settings.field_type?t=this.createSelectEditor():"text"===this.settings.field_type?t=e('<input type="text" '+this.inputNameAndClass()+' size="'+this.settings.text_size+'" />'):"textarea"===this.settings.field_type&&(t=e("<textarea "+this.inputNameAndClass()+' rows="'+this.settings.textarea_rows+'" '+' cols="'+this.settings.textarea_cols+'" />')),t},setInitialValue:function(){var e=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue),t=this.dom.find(":input");t.val(e),t.val()!==e&&t.val("")},inputNameAndClass:function(){return' name="inplace_value" class="inplace_field" '},createSelectEditor:function(){var t=e("<select"+this.inputNameAndClass()+">"+'<option disabled="true" value="">'+this.settings.select_text+"</option>"+"</select>"),n=this.settings.select_options;e.isArray(n)||(n=n.split(","));for(var r=0;r<n.length;r++){var i=n[r];e.isArray(i)||(i=i.split(":"));var o=s(i[1]||i[0]),u=s(i[0]),a=e("<option>").val(o).text(u);t.append(a)}return t},connectClosingEventsToEditor:function(){function n(e){return t.handleCancelEditor(e),!1}function r(e){return t.handleSaveEditor(e),!1}var t=this,i=this.dom.find("form");i.find(".inplace_field").focus().select(),i.find(".inplace_cancel").click(n),i.find(".inplace_save").click(r),this.settings.show_buttons||("save"===this.settings.on_blur?i.find(".inplace_field").blur(r):i.find(".inplace_field").blur(n),(e.browser.mozilla||e.browser.msie)&&this.bindSubmitOnEnterInInput()),i.keyup(function(e){var t=27;if(t===e.which)return n()}),e.browser.safari&&this.bindSubmitOnEnterInInput(),i.submit(r)},bindSubmitOnEnterInInput:function(){if("textarea"===this.settings.field_type)return;var e=this;this.dom.find(":input").keyup(function(t){var n=13;if(n===t.which)return e.dom.find("form").submit()})},handleCancelEditor:function(e){if(!1===this.triggerDelegateCall("shouldCloseEditInPlace",!0,e))return;var t=this.dom.find(":input").val();t=this.triggerDelegateCall("willCloseEditInPlace",t),this.restoreOriginalValue(),o(t)&&!this.isDisabledDefaultSelectChoice()&&this.setClosedEditorContent(t),this.reinit()},handleSaveEditor:function(e){if(!1===this.triggerDelegateCall("shouldCloseEditInPlace",!0,e))return;var t=this.dom.find(":input").val();t=this.triggerDelegateCall("willCloseEditInPlace",t);if(this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(t)){this.handleCancelEditor(e);return}if(this.didForgetRequiredText(t)){this.handleCancelEditor(e),this.reportError("Error: You must enter a value to save this field");return}this.showSaving(t),this.settings.callback?this.handleSubmitToCallback(t):this.handleSubmitToServer(t)},didForgetRequiredText:function(e){return this.settings.value_required&&(""===e||undefined===e||null===e)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(e){return!this.settings.save_if_nothing_changed&&this.originalValue===e},showSaving:function(t){if(this.settings.callback&&this.settings.callback_skip_dom_reset)return;var n=t;o(this.settings.saving_text)&&(n=this.settings.saving_text),o(this.settings.saving_image)&&(n=e("<img />").attr("src",this.settings.saving_image).attr("alt",n)),this.dom.html(n)},handleSubmitToCallback:function(e){this.enableOrDisableAnimationCallbacks(!0,!1);var t=this.triggerCallback(this.settings.callback,this.id(),e,this.originalValue,this.settings.params,this.savingAnimationCallbacks());this.settings.callback_skip_dom_reset||(undefined===t?(this.reportError("Error: Failed to save value: "+e),this.restoreOriginalValue()):this.dom.html(t)),this.didCallNoCallbacks()&&(this.enableOrDisableAnimationCallbacks(!1,!1),this.reinit())},handleSubmitToServer:function(t){var n=this.settings.update_value+"="+encodeURIComponent(t)+"&"+this.settings.element_id+"="+this.dom.attr("id")+(this.settings.params?"&"+this.settings.params:"")+"&"+this.settings.original_html+"="+encodeURIComponent(this.originalValue)+"&"+this.settings.original_value+"="+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(!0,!1),this.didStartSaving();var r=this;e.ajax({url:r.settings.url,type:"POST",data:n,dataType:"html",complete:function(e){r.didEndSaving()},success:function(e){var t=e||r.settings.default_text;r.dom.html(t),r.triggerCallback(r.settings.success,e)},error:function(e){r.dom.html(r.originalHTML),r.settings.error?r.triggerCallback(r.settings.error,e):r.reportError("Failed to save value: "+e.responseText||"Unspecified Error")}})},triggerCallback:function(e){if(!e)return;var t=Array.prototype.slice.call(arguments,1);return e.apply(this.dom[0],t)},triggerDelegateCall:function(t,n,r){if(!this.settings.delegate||!e.isFunction(this.settings.delegate[t]))return n;var i=this.settings.delegate[t](this.dom,this.settings,r);return undefined===i?n:i},reportError:function(e){this.triggerCallback(this.settings.error_sink,this.id(),e)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var e=this;return{didStartSaving:function(){e.didStartSaving()},didEndSaving:function(){e.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(e,t){this.didStartSaving.enabled=e,this.didEndSaving.enabled=t},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(e){if(!this[e].enabled)throw new Error("Cannot call "+e+" now. See documentation for details.")},didStartSaving:function(){this.assertCanCall("didStartSaving"),this.shouldDelayReinit=!0,this.enableOrDisableAnimationCallbacks(!1,!0),this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving"),this.shouldDelayReinit=!1,this.enableOrDisableAnimationCallbacks(!1,!1),this.reinit(),this.stopSavingAnimation()},startSavingAnimation:function(){var e=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){e.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(!0).css({backgroundColor:""})},missingCommaErrorPreventer:""})}(jQuery),define("jquery.editinplace",function(){}),function(e){var t={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:translate("type_search_term"),noResultsText:translate("no_results"),searchingText:translate("searching"),deleteText:"&times;",animateDropdown:!0,tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",prePopulate:null,processPrePopulate:!1,idPrefix:"token-input-",resultsFormatter:function(e){return"<li>"+e[this.propertyToSearch]+"</li>"},tokenFormatter:function(e){return"<li><p>"+e[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null},n={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"},r={BEFORE:0,AFTER:1,END:2},i={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188},s={init:function(n,r){var i=e.extend({},t,r||{});return this.each(function(){e(this).data("tokenInputObject",new e.TokenList(this,n,i))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(e){return this.data("tokenInputObject").add(e),this},remove:function(e){return this.data("tokenInputObject").remove(e),this},get:function(){return this.data("tokenInputObject").getTokens()}};e.fn.tokenInput=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):s.init.apply(this,arguments)},e.TokenList=function(t,s,o){function x(){if(o.tokenLimit!==null&&f>=o.tokenLimit){p.hide(),D();return}}function T(){if(h===(h=p.val()))return;var e=h.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");E.html(e),p.width(E.width()+30)}function N(e){return e>=48&&e<=90||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222}function C(t){var n=o.tokenFormatter(t);n=e(n).addClass(o.classes.token).insertBefore(b),e("<span>"+o.deleteText+"</span>").addClass(o.classes.tokenDelete).appendTo(n).click(function(){return M(e(this).parent()),d.change(),!1});var r={id:t.id};return r[o.propertyToSearch]=t[o.propertyToSearch],e.data(n.get(0),"tokeninput",t),a=a.slice(0,m).concat([r]).concat(a.slice(m)),m++,_(a,d),f+=1,o.tokenLimit!==null&&f>=o.tokenLimit&&(p.hide(),D()),n}function k(t){var n=o.onAdd;if(f>0&&o.preventDuplicates){var r=null;y.children().each(function(){var n=e(this),i=e.data(n.get(0),"tokeninput");if(i&&i.id===t.id)return r=n,!1});if(r){L(r),b.insertAfter(r),p.focus();return}}if(o.tokenLimit==null||f<o.tokenLimit)C(t),x();p.val(""),D(),e.isFunction(n)&&n.call(d,t)}function L(e){e.addClass(o.classes.selectedToken),v=e.get(0),p.val(""),D()}function A(e,t){e.removeClass(o.classes.selectedToken),v=null,t===r.BEFORE?(b.insertBefore(e),m--):t===r.AFTER?(b.insertAfter(e),m++):(b.appendTo(y),m=f),p.focus()}function O(t){var n=v;v&&A(e(v),r.END),n===t.get(0)?A(t,r.END):L(t)}function M(t){var n=e.data(t.get(0),"tokeninput"),r=o.onDelete,i=t.prevAll().length;i>m&&i--,t.remove(),v=null,p.focus(),a=a.slice(0,i).concat(a.slice(i+1)),i<m&&m--,_(a,d),f-=1,o.tokenLimit!==null&&p.show().val("").focus(),e.isFunction(r)&&r.call(d,n)}function _(t,n){var r=e.map(t,function(e){return e[o.tokenValue]});n.val(r.join(o.tokenDelimiter))}function D(){w.hide().empty(),g=null}function P(){w.css({position:"absolute",top:e(y).offset().top+e(y).outerHeight(),left:e(y).offset().left,zindex:999999}).show()}function H(){o.searchingText&&(w.html("<p>"+o.searchingText+"</p>"),P())}function B(){o.hintText&&(w.html("<p>"+o.hintText+"</p>"),P())}function j(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function F(e,t,n){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","g"),j(t,n))}function I(t,n){if(n&&n.length){w.empty();var r=e("<ul>").appendTo(w).mouseover(function(t){q(e(t.target).closest("li"))}).mousedown(function(t){return k(e(t.target).closest("li").data("tokeninput")),d.change(),!1}).hide();e.each(n,function(n,i){var s=o.resultsFormatter(i);s=F(s,i[o.propertyToSearch],t),s=e(s).appendTo(r),n%2?s.addClass(o.classes.dropdownItem):s.addClass(o.classes.dropdownItem2),n===0&&q(s),e.data(s.get(0),"tokeninput",i)}),P(),o.animateDropdown?r.slideDown("fast"):r.show()}else o.noResultsText&&(w.html("<p>"+o.noResultsText+"</p>"),P())}function q(t){t&&(g&&R(e(g)),t.addClass(o.classes.selectedDropdownItem),g=t.get(0))}function R(e){e.removeClass(o.classes.selectedDropdownItem),g=null}function U(){var t=p.val().toLowerCase();t&&t.length&&(v&&A(e(v),r.AFTER),t.length>=o.minChars?(H(),clearTimeout(c),c=setTimeout(function(){z(t)},o.searchDelay)):D())}function z(t){var n=t+W(),r=l.get(n);if(r)I(t,r);else if(o.url){var i=W(),s={};s.data={};if(i.indexOf("?")>-1){var u=i.split("?");s.url=u[0];var a=u[1].split("&");e.each(a,function(e,t){var n=t.split("=");s.data[n[0]]=n[1]})}else s.url=i;s.data[o.queryParam]=t,s.type=o.method,s.dataType=o.contentType,o.crossDomain&&(s.dataType="jsonp"),s.success=function(r){e.isFunction(o.onResult)&&(r=o.onResult.call(d,r)),l.add(n,o.jsonContainer?r[o.jsonContainer]:r),p.val().toLowerCase()===t&&I(t,o.jsonContainer?r[o.jsonContainer]:r)},e.ajax(s)}else if(o.local_data){var f=e.grep(o.local_data,function(e){return e[o.propertyToSearch].toLowerCase().indexOf(t.toLowerCase())>-1});e.isFunction(o.onResult)&&(f=o.onResult.call(d,f)),l.add(n,f),I(t,f)}}function W(){var e=o.url;return typeof o.url=="function"&&(e=o.url.call()),e}if(e.type(s)==="string"||e.type(s)==="function"){o.url=s;var u=W();o.crossDomain===undefined&&(u.indexOf("://")===-1?o.crossDomain=!1:o.crossDomain=location.href.split(/\/+/g)[1]!==u.split(/\/+/g)[1])}else typeof s=="object"&&(o.local_data=s);o.classes?o.classes=e.extend({},n,o.classes):o.theme?(o.classes={},e.each(n,function(e,t){o.classes[e]=t+"-"+o.theme})):o.classes=n;var a=[],f=0,l=new e.TokenList.Cache,c,h,p=e('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",o.idPrefix+t.id).focus(function(){(o.tokenLimit===null||o.tokenLimit!==f)&&B()}).blur(function(){D(),e(this).val("")}).bind("keyup keydown blur update",T).keydown(function(t){var n,s;switch(t.keyCode){case i.LEFT:case i.RIGHT:case i.UP:case i.DOWN:if(!!e(this).val()){var o=null;return t.keyCode===i.DOWN||t.keyCode===i.RIGHT?o=e(g).next():o=e(g).prev(),o.length&&q(o),!1}n=b.prev(),s=b.next(),n.length&&n.get(0)===v||s.length&&s.get(0)===v?t.keyCode===i.LEFT||t.keyCode===i.UP?A(e(v),r.BEFORE):A(e(v),r.AFTER):t.keyCode!==i.LEFT&&t.keyCode!==i.UP||!n.length?(t.keyCode===i.RIGHT||t.keyCode===i.DOWN)&&s.length&&L(e(s.get(0))):L(e(n.get(0)));break;case i.BACKSPACE:n=b.prev();if(!e(this).val().length)return v?(M(e(v)),d.change()):n.length&&L(e(n.get(0))),!1;e(this).val().length===1?D():setTimeout(function(){U()},5);break;case i.TAB:case i.ENTER:case i.NUMPAD_ENTER:case i.COMMA:if(g)return k(e(g).data("tokeninput")),d.change(),!1;break;case i.ESCAPE:return D(),!0;default:String.fromCharCode(t.which)&&setTimeout(function(){U()},5)}}),d=e(t).hide().val("").focus(function(){p.focus()}).blur(function(){p.blur()}),v=null,m=0,g=null,y=e("<ul />").addClass(o.classes.tokenList).click(function(t){var n=e(t.target).closest("li");n&&n.get(0)&&e.data(n.get(0),"tokeninput")?O(n):(v&&A(e(v),r.END),p.focus())}).mouseover(function(t){var n=e(t.target).closest("li");n&&v!==this&&n.addClass(o.classes.highlightedToken)}).mouseout(function(t){var n=e(t.target).closest("li");n&&v!==this&&n.removeClass(o.classes.highlightedToken)}).insertBefore(d),b=e("<li />").addClass(o.classes.inputToken).appendTo(y).append(p),w=e("<div>").addClass(o.classes.dropdown).appendTo("body").hide(),E=e("<tester/>").insertAfter(p).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:p.css("fontSize"),fontFamily:p.css("fontFamily"),fontWeight:p.css("fontWeight"),letterSpacing:p.css("letterSpacing"),whiteSpace:"nowrap"});d.val("");var S=o.prePopulate||d.data("pre");o.processPrePopulate&&e.isFunction(o.onResult)&&(S=o.onResult.call(d,S)),S&&S.length&&e.each(S,function(e,t){C(t),x()}),e.isFunction(o.onReady)&&o.onReady.call(),this.clear=function(){y.children("li").each(function(){e(this).children("input").length===0&&M(e(this))})},this.add=function(e){k(e)},this.remove=function(t){y.children("li").each(function(){if(e(this).children("input").length===0){var n=e(this).data("tokeninput"),r=!0;for(var i in t)if(t[i]!==n[i]){r=!1;break}r&&M(e(this))}})},this.getTokens=function(){return a}},e.TokenList.Cache=function(t){var n=e.extend({max_size:500},t),r={},i=0,s=function(){r={},i=0};this.add=function(e,t){i>n.max_size&&s(),r[e]||(i+=1),r[e]=t},this.get=function(e){return r[e]}}}(jQuery),define("jquery.tokeninput",function(){}),function(e,t){function o(t){e.extend(!0,n,t)}function u(n,r,i){function D(e){d?(z(),U(),et(),q(e)):P()}function P(){v=r.theme?"ui":"fc",n.addClass("fc"),r.isRTL&&n.addClass("fc-rtl"),r.theme&&n.addClass("ui-widget"),d=e("<div class='fc-content' style='position:relative'/>").prependTo(n),h=new a(o,r),p=h.render(),p&&n.prepend(p),I(r.defaultView),e(window).resize(X),F()||H()}function H(){setTimeout(function(){!b.start&&F()&&q()},0)}function B(){e(window).unbind("resize",X),h.destroy(),d.remove(),n.removeClass("fc fc-rtl ui-widget")}function j(){return l.offsetWidth!==0}function F(){return e("body")[0].offsetWidth!==0}function I(t){if(!b||t!=b.name){k++,nt();var n=b,r;n?((n.beforeHide||G)(),Q(d,d.height()),n.element.hide()):Q(d,1),d.css("overflow","hidden"),b=w[t],b?b.element.show():b=w[t]=new s[t](r=T=e("<div class='fc-view fc-view-"+t+"' style='position:absolute'/>").appendTo(d),o),n&&h.deactivateButton(n.name),h.activateButton(t),q(),d.css("overflow",""),n&&Q(d,1),r||(b.afterShow||G)(),k--}}function q(e){if(j()){k++,nt(),x===t&&z();var r=!1;!b.start||e||L<b.start||L>=b.end?(b.render(L,e||0),W(!0),r=!0):b.sizeDirty?(b.clearEvents(),W(),r=!0):b.eventsDirty&&(b.clearEvents(),r=!0),b.sizeDirty=!1,b.eventsDirty=!1,$(r),E=n.outerWidth(),h.updateTitle(b.title);var i=new Date;i>=b.start&&i<b.end?h.disableButton("today"):h.enableButton("today"),k--,b.trigger("viewDisplay",l)}}function R(){U(),j()&&(z(),W(),nt(),b.clearEvents(),b.renderEvents(A),b.sizeDirty=!1)}function U(){e.each(w,function(e,t){t.sizeDirty=!0})}function z(){r.contentHeight?x=r.contentHeight:r.height?x=r.height-(p?p.height():0)-V(d):x=Math.round(d.width()/Math.max(r.aspectRatio,.5))}function W(e){k++,b.setHeight(x,e),T&&(T.css("position","relative"),T=null),b.setWidth(d.width(),e),k--}function X(){if(!k)if(b.start){var e=++N;setTimeout(function(){e==N&&!k&&j()&&E!=(E=n.outerWidth())&&(k++,R(),b.trigger("windowResize",l),k--)},200)}else H()}function $(e){!r.lazyFetching||u(b.visStart,b.visEnd)?J():e&&Z()}function J(){f(b.visStart,b.visEnd)}function K(e){A=e,Z()}function Y(e){Z(e)}function Z(e){et(),j()&&(b.clearEvents(),b.renderEvents(A,e),b.eventsDirty=!1)}function et(){e.each(w,function(e,t){t.eventsDirty=!0})}function tt(e,n,r){b.select(e,n,r===t?!0:r)}function nt(){b&&b.unselect()}function rt(){q(-1)}function it(){q(1)}function st(){m(L,-1),q()}function ot(){m(L,1),q()}function ut(){L=new Date,q()}function at(e,t,n){e instanceof Date?L=S(e):C(L,e,t,n),q()}function ft(e,n,r){e!==t&&m(L,e),n!==t&&g(L,n),r!==t&&y(L,r),q()}function lt(){return S(L)}function ct(){return b}function ht(e,n){if(n===t)return r[e];if(e=="height"||e=="contentHeight"||e=="aspectRatio")r[e]=n,R()}function pt(e,t){if(r[e])return r[e].apply(t||l,Array.prototype.slice.call(arguments,2))}var o=this;o.options=r,o.render=D,o.destroy=B,o.refetchEvents=J,o.reportEvents=K,o.reportEventChange=Y,o.rerenderEvents=Z,o.changeView=I,o.select=tt,o.unselect=nt,o.prev=rt,o.next=it,o.prevYear=st,o.nextYear=ot,o.today=ut,o.gotoDate=at,o.incrementDate=ft,o.formatDate=function(e,t){return O(e,t,r)},o.formatDates=function(e,t,n){return M(e,t,n,r)},o.getDate=lt,o.getView=ct,o.option=ht,o.trigger=pt,c.call(o,r,i);var u=o.isFetchNeeded,f=o.fetchEvents,l=n[0],h,p,d,v,b,w={},E,x,T,N=0,k=0,L=new Date,A=[],_;C(L,r.year,r.month,r.date),r.droppable&&e(document).bind("dragstart",function(t,n){var i=t.target,s=e(i);if(!s.parents(".fc").length){var o=r.dropAccept;if(e.isFunction(o)?o.call(i,s):s.is(o))_=i,b.dragStart(_,t,n)}}).bind("dragstop",function(e,t){_&&(b.dragStop(_,e,t),_=null)})}function a(t,n){function u(){o=n.theme?"ui":"fc";var t=n.header;if(t)return i=e("<table class='fc-header' style='width:100%'/>").append(e("<tr/>").append(f("left")).append(f("center")).append(f("right"))),i}function a(){i.remove()}function f(r){var i=e("<td class='fc-header-"+r+"'/>"),u=n.header[r];return u&&e.each(u.split(" "),function(r){r>0&&i.append("<span class='fc-header-space'/>");var u;e.each(this.split(","),function(r,a){if(a=="title")i.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),u&&u.addClass(o+"-corner-right"),u=null;else{var f;t[a]?f=t[a]:s[a]&&(f=function(){h.removeClass(o+"-state-hover"),t.changeView(a)});if(f){var l=n.theme?tt(n.buttonIcons,a):null,c=tt(n.buttonText,a),h=e("<span class='fc-button fc-button-"+a+" "+o+"-state-default'>"+"<span class='fc-button-inner'>"+"<span class='fc-button-content'>"+(l?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+l+"'/>"+"</span>":c)+"</span>"+"<span class='fc-button-effect'><span></span></span>"+"</span>"+"</span>");h&&(h.click(function(){h.hasClass(o+"-state-disabled")||f()}).mousedown(function(){h.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-down")}).mouseup(function(){h.removeClass(o+"-state-down")}).hover(function(){h.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-hover")},function(){h.removeClass(o+"-state-hover").removeClass(o+"-state-down")}).appendTo(i),u||h.addClass(o+"-corner-left"),u=h)}}}),u&&u.addClass(o+"-corner-right")}),i}function l(e){i.find("h2").html(e)}function c(e){i.find("span.fc-button-"+e).addClass(o+"-state-active")}function h(e){i.find("span.fc-button-"+e).removeClass(o+"-state-active")}function p(e){i.find("span.fc-button-"+e).addClass(o+"-state-disabled")}function d(e){i.find("span.fc-button-"+e).removeClass(o+"-state-disabled")}var r=this;r.render=u,r.destroy=a,r.updateTitle=l,r.activateButton=c,r.deactivateButton=h,r.disableButton=p,r.enableButton=d;var i=e([]),o}function c(n,r){function w(e,t){return!p||e<p||t>d}function E(e,t){p=e,d=t,y=[];var n=++v,r=h.length;m=r;for(var i=0;i<r;i++)x(h[i],n)}function x(e,t){T(e,function(n){if(t==v){if(n){for(var r=0;r<n.length;r++)n[r].source=e,H(n[r]);y=y.concat(n)}m--,m||a(y)}})}function T(t,r){var s,o=i.sourceFetchers,u;for(s=0;s<o.length;s++){u=o[s](t,p,d,r);if(u===!0)return;if(typeof u=="object"){T(u,r);return}}var a=t.events;if(a)e.isFunction(a)?(D(),a(S(p),S(d),function(e){r(e),P()})):e.isArray(a)?r(a):r();else{var l=t.url;if(l){var c=t.success,h=t.error,v=t.complete,m=e.extend({},t.data||{}),g=ft(t.startParam,n.startParam),y=ft(t.endParam,n.endParam);g&&(m[g]=Math.round(+p/1e3)),y&&(m[y]=Math.round(+d/1e3)),D(),e.ajax(e.extend({},f,t,{data:m,success:function(t){t=t||[];var n=at(c,this,arguments);e.isArray(n)&&(t=n),r(t)},error:function(){at(h,this,arguments),r()},complete:function(){at(v,this,arguments),P()}}))}else r()}}function N(e){e=C(e),e&&(m++,x(e,v))}function C(t){e.isFunction(t)||e.isArray(t)?t={events:t}:typeof t=="string"&&(t={url:t});if(typeof t=="object")return B(t),h.push(t),t}function L(t){h=e.grep(h,function(e){return!j(e,t)}),y=e.grep(y,function(e){return!j(e.source,t)}),a(y)}function A(e){var t,n=y.length,r,i=u().defaultEventEnd,s=e.start-e._start,o=e.end?e.end-(e._end||i(e)):0;for(t=0;t<n;t++)r=y[t],r._id==e._id&&r!=e&&(r.start=new Date(+r.start+s),e.end?r.end?r.end=new Date(+r.end+o):r.end=new Date(+i(r)+o):r.end=null,r.title=e.title,r.url=e.url,r.allDay=e.allDay,r.className=e.className,r.editable=e.editable,r.color=e.color,r.backgroudColor=e.backgroudColor,r.borderColor=e.borderColor,r.textColor=e.textColor,H(r));H(e),a(y)}function O(e,t){H(e),e.source||(t&&(c.events.push(e),e.source=c),y.push(e)),a(y)}function M(t){if(!t){y=[];for(var n=0;n<h.length;n++)e.isArray(h[n].events)&&(h[n].events=[])}else{if(!e.isFunction(t)){var r=t+"";t=function(e){return e._id==r}}y=e.grep(y,t,!0);for(var n=0;n<h.length;n++)e.isArray(h[n].events)&&(h[n].events=e.grep(h[n].events,t,!0))}a(y)}function _(t){return e.isFunction(t)?e.grep(y,t):t?(t+="",e.grep(y,function(e){return e._id==t})):y}function D(){g++||o("loading",null,!0)}function P(){--g||o("loading",null,!1)}function H(e){var r=e.source||{},i=ft(r.ignoreTimezone,n.ignoreTimezone);e._id=e._id||(e.id===t?"_fc"+l++:e.id+""),e.date&&(e.start||(e.start=e.date),delete e.date),e._start=S(e.start=k(e.start,i)),e.end=k(e.end,i),e.end&&e.end<=e.start&&(e.end=null),e._end=e.end?S(e.end):null,e.allDay===t&&(e.allDay=ft(r.allDayDefault,n.allDayDefault)),e.className?typeof e.className=="string"&&(e.className=e.className.split(/\s+/)):e.className=[]}function B(e){e.className?typeof e.className=="string"&&(e.className=e.className.split(/\s+/)):e.className=[];var t=i.sourceNormalizers;for(var n=0;n<t.length;n++)t[n](e)}function j(e,t){return e&&t&&F(e)==F(t)}function F(e){return(typeof e=="object"?e.events||e.url:"")||e}var s=this;s.isFetchNeeded=w,s.fetchEvents=E,s.addEventSource=N,s.removeEventSource=L,s.updateEvent=A,s.renderEvent=O,s.removeEvents=M,s.clientEvents=_,s.normalizeEvent=H;var o=s.trigger,u=s.getView,a=s.reportEvents,c={events:[]},h=[c],p,d,v=0,m=0,g=0,y=[];for(var b=0;b<r.length;b++)C(r[b])}function m(e,t,n){return e.setFullYear(e.getFullYear()+t),n||E(e),e}function g(e,t,n){if(+e){var r=e.getMonth()+t,i=S(e);i.setDate(1),i.setMonth(r),e.setMonth(r),n||E(e);while(e.getMonth()!=i.getMonth())e.setDate(e.getDate()+(e<i?1:-1))}return e}function y(e,t,n){if(+e){var r=e.getDate()+t,i=S(e);i.setHours(9),i.setDate(r),e.setDate(r),n||E(e),b(e,i)}return e}function b(e,t){if(+e)while(e.getDate()!=t.getDate())e.setTime(+e+(e<t?1:-1)*d)}function w(e,t){return e.setMinutes(e.getMinutes()+t),e}function E(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function S(e,t){return t?E(new Date(+e)):new Date(+e)}function x(){var e=0,t;do t=new Date(1970,e++,1);while(t.getHours());return t}function T(e,t,n){t=t||1;while(!e.getDay()||n&&e.getDay()==1||!n&&e.getDay()==6)y(e,t);return e}function N(e,t){return Math.round((S(e,!0)-S(t,!0))/p)}function C(e,n,r,i){n!==t&&n!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(n)),r!==t&&r!=e.getMonth()&&(e.setDate(1),e.setMonth(r)),i!==t&&e.setDate(i)}function k(e,n){return typeof e=="object"?e:typeof e=="number"?new Date(e*1e3):typeof e=="string"?e.match(/^\d+(\.\d+)?$/)?new Date(parseFloat(e)*1e3):(n===t&&(n=!0),L(e,n)||(e?new Date(e):null)):null}function L(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(t||!n[13]){var i=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),i.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),i.setDate(n[5])),b(r,i),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(Number("0."+n[12])*1e3),b(r,i)}else{r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?Number("0."+n[12])*1e3:0);if(n[14]){var s=Number(n[16])*60+(n[18]?Number(n[18]):0);s*=n[15]=="-"?1:-1,r=new Date(+r+s*60*1e3)}}return r}function A(e){if(typeof e=="number")return e*60;if(typeof e=="object")return e.getHours()*60+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,t[3].toLowerCase().charAt(0)=="p"&&(n+=12)),n*60+(t[2]?parseInt(t[2],10):0)}}function O(e,t,n){return M(e,null,t,n)}function M(e,t,r,i){i=i||n;var s=e,o=t,u,a=r.length,f,l,c,h="";for(u=0;u<a;u++){f=r.charAt(u);if(f=="'"){for(l=u+1;l<a;l++)if(r.charAt(l)=="'"){s&&(l==u+1?h+="'":h+=r.substring(u+1,l),u=l);break}}else if(f=="("){for(l=u+1;l<a;l++)if(r.charAt(l)==")"){var p=O(s,r.substring(u+1,l),i);parseInt(p.replace(/\D/,""),10)&&(h+=p),u=l;break}}else if(f=="["){for(l=u+1;l<a;l++)if(r.charAt(l)=="]"){var d=r.substring(u+1,l),p=O(s,d,i);p!=O(o,d,i)&&(h+=p),u=l;break}}else if(f=="{")s=t,o=e;else if(f=="}")s=e,o=t;else{for(l=a;l>u;l--)if(c=_[r.substring(u,l)]){s&&(h+=c(s,i)),u=l-1;break}l==u&&s&&(h+=f)}}return h}function D(e){return e.end?P(e.end,e.allDay):y(S(e.start),1)}function P(e,t){return e=S(e),t||e.getHours()||e.getMinutes()?y(e,1):E(e)}function H(e,t){return(t.msLength-e.msLength)*100+(e.event.start-t.event.start)}function B(e,t){return e.end>t.start&&e.start<t.end}function j(e,t,n,r){var i=[],s,o=e.length,u,a,f,l,c,h,p;for(s=0;s<o;s++)u=e[s],a=u.start,f=t[s],f>n&&a<r&&(a<n?(l=S(n),h=!1):(l=a,h=!0),f>r?(c=S(r),p=!1):(c=f,p=!0),i.push({event:u,start:l,end:c,isStart:h,isEnd:p,msLength:c-l}));return i.sort(H)}function F(e){var t=[],n,r=e.length,i,s,o,u;for(n=0;n<r;n++){i=e[n],s=0;for(;;){o=!1;if(t[s])for(u=0;u<t[s].length;u++)if(B(t[s][u],i)){o=!0;break}if(!o)break;s++}t[s]?t[s].push(i):t[s]=[i]}return t}function I(n,r,i){n.unbind("mouseover").mouseover(function(n){var s=n.target,o,u,a;while(s!=this)o=s,s=s.parentNode;(u=o._fci)!==t&&(o._fci=t,a=r[u],i(a.event,a.element,a),e(n.target).trigger(n)),n.stopPropagation()})}function q(t,n,r){for(var i=0,s;i<t.length;i++)s=e(t[i]),s.width(Math.max(0,n-U(s,r)))}function R(t,n,r){for(var i=0,s;i<t.length;i++)s=e(t[i]),s.height(Math.max(0,n-V(s,r)))}function U(e,t){return z(e)+X(e)+(t?W(e):0)}function z(t){return(parseFloat(e.curCSS(t[0],"paddingLeft",!0))||0)+(parseFloat(e.curCSS(t[0],"paddingRight",!0))||0)}function W(t){return(parseFloat(e.curCSS(t[0],"marginLeft",!0))||0)+(parseFloat(e.curCSS(t[0],"marginRight",!0))||0)}function X(t){return(parseFloat(e.curCSS(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.curCSS(t[0],"borderRightWidth",!0))||0)}function V(e,t){return $(e)+K(e)+(t?J(e):0)}function $(t){return(parseFloat(e.curCSS(t[0],"paddingTop",!0))||0)+(parseFloat(e.curCSS(t[0],"paddingBottom",!0))||0)}function J(t){return(parseFloat(e.curCSS(t[0],"marginTop",!0))||0)+(parseFloat(e.curCSS(t[0],"marginBottom",!0))||0)}function K(t){return(parseFloat(e.curCSS(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.curCSS(t[0],"borderBottomWidth",!0))||0)}function Q(e,t){t=typeof t=="number"?t+"px":t,e.each(function(e,n){n.style.cssText+=";min-height:"+t+";_height:"+t})}function G(){}function Y(e,t){return e-t}function Z(e){return Math.max.apply(Math,e)}function et(e){return(e<10?"0":"")+e}function tt(e,n){if(e[n]!==t)return e[n];var r=n.split(/(?=[A-Z])/),i=r.length-1,s;for(;i>=0;i--){s=e[r[i].toLowerCase()];if(s!==t)return s}return e[""]}function nt(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function rt(e){return e.id+"/"+e.className+"/"+e.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,"")}function it(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function st(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function ot(e,t){e.each(function(e,n){n.className=n.className.replace(/^fc-\w*/,"fc-"+h[t.getDay()])})}function ut(e,t){var n=e.source||{},r=e.color,i=n.color,s=t("eventColor"),o=e.backgroundColor||r||n.backgroundColor||i||t("eventBackgroundColor")||s,u=e.borderColor||r||n.borderColor||i||t("eventBorderColor")||s,a=e.textColor||n.textColor||t("eventTextColor"),f=[];return o&&f.push("background-color:"+o),u&&f.push("border-color:"+u),a&&f.push("color:"+a),f.join(";")}function at(t,n,r){e.isFunction(t)&&(t=[t]);if(t){var i,s;for(i=0;i<t.length;i++)s=t[i].apply(n,r)||s;return s}}function ft(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==t)return arguments[e]}function lt(e,t){function o(e,t){t&&(g(e,t),e.setDate(1));var o=S(e,!0);o.setDate(1);var u=g(S(o),1),a=S(o),f=S(u),l=r("firstDay"),c=r("weekends")?0:1;c&&(T(a),T(f,-1,!0)),y(a,-((a.getDay()-Math.max(l,c)+7)%7)),y(f,(7-f.getDay()+Math.max(l,c))%7);var h=Math.round((f-a)/(p*7));r("weekMode")=="fixed"&&(y(f,(6-h)*7),h=6),n.title=s(o,r("titleFormat")),n.start=o,n.end=u,n.visStart=a,n.visEnd=f,i(6,h,c?5:7,!0)}var n=this;n.render=o,pt.call(n,e,t,"month");var r=n.opt,i=n.renderBasic,s=t.formatDate}function ct(e,t){function o(e,t){t&&y(e,t*7);var o=y(S(e),-((e.getDay()-r("firstDay")+7)%7)),u=y(S(o),7),a=S(o),f=S(u),l=r("weekends");l||(T(a),T(f,-1,!0)),n.title=s(a,y(S(f),-1),r("titleFormat")),n.start=o,n.end=u,n.visStart=a,n.visEnd=f,i(1,1,l?7:5,!1)}var n=this;n.render=o,pt.call(n,e,t,"basicWeek");var r=n.opt,i=n.renderBasic,s=t.formatDates}function ht(e,t){function o(e,t){t&&(y(e,t),r("weekends")||T(e,t<0?-1:1)),n.title=s(e,r("titleFormat")),n.start=n.visStart=S(e,!0),n.end=n.visEnd=y(S(n.start),1),i(1,1,1,!1)}var n=this;n.render=o,pt.call(n,e,t,"basicDay");var r=n.opt,i=n.renderBasic,s=t.formatDate}function pt(t,n,r){function I(e,t,n,r){k=t,L=n,R();var i=!d;i?U(e,r):u(),z(i)}function R(){_=s("isRTL"),_?(D=-1,P=L-1):(D=1,P=0),H=s("firstDay"),B=s("weekends")?0:1,j=s("theme")?"ui":"fc",F=s("columnFormat")}function U(n,r){var i,s=j+"-widget-header",o=j+"-widget-content",u,a,f;i="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>";for(u=0;u<L;u++)i+="<th class='fc- "+s+"'/>";i+="</tr></thead><tbody>";for(u=0;u<n;u++){i+="<tr class='fc-week"+u+"'>";for(a=0;a<L;a++)i+="<td class='fc- "+o+" fc-day"+(u*L+a)+"'>"+"<div>"+(r?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";i+="</tr>"}i+="</tbody></table>",f=e(i).appendTo(t),h=f.find("thead"),p=h.find("th"),d=f.find("tbody"),v=d.find("tr"),m=d.find("td"),g=m.filter(":first-child"),b=v.eq(0).find("div.fc-day-content div"),st(h.add(h.find("tr"))),st(v),v.eq(0).addClass("fc-first"),$(m),w=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function z(t){var n=t||k==1,r=i.start.getMonth(),s=E(new Date),o,u,a;n&&p.each(function(t,n){o=e(n),u=pt(t),o.html(c(u,F)),ot(o,u)}),m.each(function(t,i){o=e(i),u=pt(t),u.getMonth()==r?o.removeClass("fc-other-month"):o.addClass("fc-other-month"),+u==+s?o.addClass(j+"-state-highlight fc-today"):o.removeClass(j+"-state-highlight fc-today"),o.find("div.fc-day-number").text(u.getDate()),n&&ot(o,u)}),v.each(function(t,n){a=e(n),t<k?(a.show(),t==k-1?a.addClass("fc-last"):a.removeClass("fc-last")):a.hide()})}function W(t){T=t;var n=T-h.height(),r,i,o;s("weekMode")=="variable"?r=i=Math.floor(n/(k==1?2:6)):(r=Math.floor(n/k),i=n-r*(k-1)),g.each(function(t,n){t<k&&(o=e(n),Q(o.find("> div"),(t==k-1?i:r)-V(o)))})}function X(e){x=e,M.clear(),C=Math.floor(x/L),q(p.slice(0,-1),C)}function $(e){e.click(J).mousedown(l)}function J(e){if(!s("selectable")){var t=parseInt(this.className.match(/fc\-day(\d+)/)[1]),n=pt(t);o("dayClick",this,n,!0,e)}}function K(e,t,n){n&&A.build();var r=S(i.visStart),s=y(S(r),L);for(var o=0;o<k;o++){var u=new Date(Math.max(r,e)),a=new Date(Math.min(s,t));if(u<a){var f,l;_?(f=N(a,r)*D+P+1,l=N(u,r)*D+P+1):(f=N(u,r),l=N(a,r)),$(G(o,f,o,l-1))}y(r,7),y(s,7)}}function G(e,n,r,i){var s=A.rect(e,n,r,i,t);return a(s,t)}function Y(e,t){return S(e)}function Z(e,t,n){K(e,y(S(t),1),!0)}function et(){f()}function tt(e,t,n){var r=lt(e),i=m[r.row*L+r.col];o("dayClick",i,e,t,n)}function nt(e,t,n){O.start(function(e){f(),e&&G(e.row,e.col,e.row,e.col)},t)}function rt(e,t,n){var r=O.stop();f();if(r){var i=ct(r);o("drop",e,i,!0,t,n)}}function ut(e){return S(e.start)}function at(e){return M.left(e)}function ft(e){return M.right(e)}function lt(e){return{row:Math.floor(N(e,i.visStart)/7),col:vt(e.getDay())}}function ct(e){return ht(e.row,e.col)}function ht(e,t){return y(S(i.visStart),e*7+t*D+P)}function pt(e){return ht(Math.floor(e/L),e%L)}function vt(e){return(e-Math.max(H,B)+L)%L*D+P}function mt(e){return v.eq(e)}function gt(e){return{left:0,right:x}}var i=this;i.renderBasic=I,i.setHeight=W,i.setWidth=X,i.renderDayOverlay=K,i.defaultSelectionEnd=Y,i.renderSelection=Z,i.clearSelection=et,i.reportDayClick=tt,i.dragStart=nt,i.dragStop=rt,i.defaultEventEnd=ut,i.getHoverListener=function(){return O},i.colContentLeft=at,i.colContentRight=ft,i.dayOfWeekCol=vt,i.dateCell=lt,i.cellDate=ct,i.cellIsAllDay=function(){return!0},i.allDayRow=mt,i.allDayBounds=gt,i.getRowCnt=function(){return k},i.getColCnt=function(){return L},i.getColWidth=function(){return C},i.getDaySegmentContainer=function(){return w},wt.call(i,t,n,r),xt.call(i),St.call(i),dt.call(i);var s=i.opt,o=i.trigger,u=i.clearEvents,a=i.renderOverlay,f=i.clearOverlays,l=i.daySelectionMousedown,c=n.formatDate,h,p,d,v,m,g,b,w,x,T,C,k,L,A,O,M,_,D,P,H,B,j,F;it(t.addClass("fc-grid")),A=new Tt(function(t,n){var r,i,s;p.each(function(t,o){r=e(o),i=r.offset().left,t&&(s[1]=i),s=[i],n[t]=s}),s[1]=i+r.outerWidth(),v.each(function(n,o){n<k&&(r=e(o),i=r.offset().top,n&&(s[1]=i),s=[i],t[n]=s)}),s[1]=i+r.outerHeight()}),O=new Nt(A),M=new kt(function(e){return b.eq(e)})}function dt(){function E(e,t){o(e),b(T(e),t)}function x(){u(),h().empty()}function T(n){var r=m(),i=g(),s=S(t.visStart),o=y(S(s),i),u=e.map(n,D),a,f,l,c,h,p,d=[];for(a=0;a<r;a++){f=F(j(n,u,s,o));for(l=0;l<f.length;l++){c=f[l];for(h=0;h<c.length;h++)p=c[h],p.row=a,p.level=l,d.push(p)}y(s,7),y(o,7)}return d}function N(e,t,n){i(e)&&C(e,t),n.isEnd&&s(e)&&w(e,t,n),a(e,t)}function C(e,t){var i=p(),s;t.draggable({zIndex:9,delay:50,opacity:n("dragOpacity"),revertDuration:n("dragRevertDuration"),start:function(o,u){r("eventDragStart",t,e,o,u),l(e,t),i.start(function(r,i,o,u){t.draggable("option","revert",!r||!o&&!u),v(),r?(s=o*7+u*(n("isRTL")?-1:1),d(y(S(e.start),s),y(D(e),s))):s=0},o,"drag")},stop:function(n,o){i.stop(),v(),r("eventDragStop",t,e,n,o),s?c(this,e,s,0,e.allDay,n,o):(t.css("filter",""),f(e,t))}})}var t=this;t.renderEvents=E,t.compileDaySegs=T,t.clearEvents=x,t.bindDaySeg=N,Et.call(t);var n=t.opt,r=t.trigger,i=t.isEventDraggable,s=t.isEventResizable,o=t.reportEvents,u=t.reportEventClear,a=t.eventElementHandlers,f=t.showEvents,l=t.hideEvents,c=t.eventDrop,h=t.getDaySegmentContainer,p=t.getHoverListener,d=t.renderDayOverlay,v=t.clearOverlays,m=t.getRowCnt,g=t.getColCnt,b=t.renderDaySegs,w=t.resizableDayEvent}function vt(e,t){function o(e,t){t&&y(e,t*7);var o=y(S(e),-((e.getDay()-r("firstDay")+7)%7)),u=y(S(o),7),a=S(o),f=S(u),l=r("weekends");l||(T(a),T(f,-1,!0)),n.title=s(a,y(S(f),-1),r("titleFormat")),n.start=o,n.end=u,n.visStart=a,n.visEnd=f,i(l?7:5)}var n=this;n.render=o,gt.call(n,e,t,"agendaWeek");var r=n.opt,i=n.renderAgenda,s=t.formatDates}function mt(e,t){function o(e,t){t&&(y(e,t),r("weekends")||T(e,t<0?-1:1));var o=S(e,!0),u=y(S(o),1);n.title=s(e,r("titleFormat")),n.start=n.visStart=o,n.end=n.visEnd=u,i(1)}var n=this;n.render=o,gt.call(n,e,t,"agendaDay");var r=n.opt,i=n.renderAgenda,s=t.formatDate}function gt(n,r,i){function bt(e){et=e,Et(),m?a():Ct(),Lt()}function Et(){ft=o("theme")?"ui":"fc",ct=o("weekends")?0:1,lt=o("firstDay"),(ht=o("isRTL"))?(pt=-1,dt=et-1):(pt=1,dt=0),vt=A(o("minTime")),mt=A(o("maxTime")),gt=o("columnFormat")}function Ct(){var t=ft+"-widget-header",r=ft+"-widget-content",i,s,u,a,f,l=o("slotMinutes")%15==0;i="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+t+"'>&nbsp;</th>";for(s=0;s<et;s++)i+="<th class='fc- fc-col"+s+" "+t+"'/>";i+="<th class='fc-agenda-gutter "+t+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+t+"'>&nbsp;</th>";for(s=0;s<et;s++)i+="<td class='fc- fc-col"+s+" "+r+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";i+="<td class='fc-agenda-gutter "+r+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>",m=e(i).appendTo(n),g=m.find("thead"),b=g.find("th").slice(1,-1),T=m.find("tbody"),C=T.find("td").slice(0,-1),k=C.find("div.fc-day-content div"),L=C.eq(0),O=L.find("> div"),st(g.add(g.find("tr"))),st(T.add(T.find("tr"))),U=g.find("th:first"),z=m.find(".fc-agenda-gutter"),M=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),o("allDaySlot")?(_=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(M),i="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+t+" fc-agenda-axis'>"+o("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+t+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",D=e(i).appendTo(M),P=D.find("tr"),Pt(P.find("td")),U=U.add(D.find("th:first")),z=z.add(D.find("th.fc-agenda-gutter")),M.append("<div class='fc-agenda-divider "+t+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):_=e([]),H=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(M),B=e("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(H),j=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(B),i="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",u=x(),a=w(S(u),mt),w(u,vt),tt=0;for(s=0;u<a;s++)f=u.getMinutes(),i+="<tr class='fc-slot"+s+" "+(f?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+t+"'>"+(!l||!f?v(u,o("axisFormat")):"&nbsp;")+"</th>"+"<td class='"+r+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",w(u,o("slotMinutes")),tt++;i+="</tbody></table>",F=e(i).appendTo(B),I=F.find("div:first"),Ht(F.find("td")),U=U.add(F.find("th:first"))}function Lt(){var e,t,n,r,i=E(new Date);for(e=0;e<et;e++)r=Wt(e),t=b.eq(e),t.html(v(r,gt)),n=C.eq(e),+r==+i?n.addClass(ft+"-state-highlight fc-today"):n.removeClass(ft+"-state-highlight fc-today"),ot(t.add(n),r)}function At(e,n){e===t&&(e=$),$=e,at={};var r=T.position().top,i=H.position().top,s=Math.min(e-r,F.height()+i+1);O.height(s-V(L)),M.css("top",r),H.height(s-i-1),G=I.height()+1,n&&Mt()}function Ot(t){X=t,ut.clear(),J=0,q(U.width("").each(function(t,n){J=Math.max(J,e(n).outerWidth())}),J);var n=H[0].clientWidth;Q=H.width()-n,Q?(q(z,Q),z.show().prev().removeClass("fc-last")):z.hide().prev().addClass("fc-last"),K=Math.floor((n-J)/et),q(b.slice(0,-1),K)}function Mt(){function r(){H.scrollTop(n)}var e=x(),t=S(e);t.setHours(o("firstHour"));var n=$t(e,t)+1;r(),setTimeout(r,0)}function _t(){Z=H.scrollTop()}function Dt(){H.scrollTop(Z)}function Pt(e){e.click(Bt).mousedown(p)}function Ht(e){e.click(Bt).mousedown(tn)}function Bt(e){if(!o("selectable")){var t=Math.min(et-1,Math.floor((e.pageX-m.offset().left-J)/K)),n=Wt(t),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var i=parseInt(r[1])*o("slotMinutes"),s=Math.floor(i/60);n.setHours(s),n.setMinutes(i%60+vt),u("dayClick",C[t],n,!1,e)}else u("dayClick",C[t],n,!0,e)}}function jt(e,t,n){n&&nt.build();var r=S(s.visStart),i,o;ht?(i=N(t,r)*pt+dt+1,o=N(e,r)*pt+dt+1):(i=N(e,r),o=N(t,r)),i=Math.max(0,i),o=Math.min(et,o),i<o&&Pt(Ft(0,i,0,o-1))}function Ft(e,t,n,r){var i=nt.rect(e,t,n,r,M);return f(i,M)}function It(e,t){var n=S(s.visStart),r=y(S(n),1);for(var i=0;i<et;i++){var o=new Date(Math.max(n,e)),u=new Date(Math.min(r,t));if(o<u){var a=i*pt+dt,l=nt.rect(0,a,0,a,B),c=$t(n,o),h=$t(n,u);l.top=c,l.height=h-c,Ht(f(l,B))}y(n,1),y(r,1)}}function qt(e){return ut.left(e)}function Rt(e){return ut.right(e)}function Ut(e){return{row:Math.floor(N(e,s.visStart)/7),col:Vt(e.getDay())}}function zt(e){var t=Wt(e.col),n=e.row;return o("allDaySlot")&&n--,n>=0&&w(t,vt+n*o("slotMinutes")),t}function Wt(e){return y(S(s.visStart),e*pt+dt)}function Xt(e){return o("allDaySlot")&&!e.row}function Vt(e){return(e-Math.max(lt,ct)+et)%et*pt+dt}function $t(e,n){e=S(e,!0);if(n<w(S(e),vt))return 0;if(n>=w(S(e),mt))return F.height();var r=o("slotMinutes"),i=n.getHours()*60+n.getMinutes()-vt,s=Math.floor(i/r),u=at[s];return u===t&&(u=at[s]=F.find("tr:eq("+s+") td div")[0].offsetTop),Math.max(0,Math.round(u-1+G*(i%r/r)))}function Jt(){return{left:J,right:X-Q}}function Kt(e){return P}function Qt(e){var t=S(e.start);return e.allDay?t:w(t,o("defaultEventMinutes"))}function Gt(e,t){return t?S(e):w(S(e),o("slotMinutes"))}function Yt(e,t,n){n?o("allDaySlot")&&jt(e,y(S(t),1),!0):Zt(e,t)}function Zt(t,n){var r=o("selectHelper");nt.build();if(r){var i=N(t,s.visStart)*pt+dt;if(i>=0&&i<et){var u=nt.rect(0,i,0,i,B),a=$t(t,t),f=$t(t,n);if(f>a){u.top=a,u.height=f-a,u.left+=2,u.width-=5;if(e.isFunction(r)){var l=r(t,n);l&&(u.position="absolute",u.zIndex=8,W=e(l).css(u).appendTo(B))}else u.isStart=!0,u.isEnd=!0,W=e(d({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},u)),W.css("opacity",o("dragOpacity"));W&&(Ht(W),B.append(W),q(W,u.width,!0),R(W,u.height,!0))}}}else It(t,n)}function en(){l(),W&&(W.remove(),W=null)}function tn(t){if(t.which==1&&o("selectable")){h(t);var n;rt.start(function(e,t){en();if(e&&e.col==t.col&&!Xt(e)){var r=zt(t),i=zt(e);n=[r,w(S(r),o("slotMinutes")),i,w(S(i),o("slotMinutes"))].sort(Y),Zt(n[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){rt.stop(),n&&(+n[0]==+n[1]&&nn(n[0],!1,e),c(n[0],n[3],!1,e))})}}function nn(e,t,n){u("dayClick",C[Vt(e.getDay())],e,t,n)}function rn(e,t,n){rt.start(function(e){l();if(e)if(Xt(e))Ft(e.row,e.col,e.row,e.col);else{var t=zt(e),n=w(S(t),o("defaultEventMinutes"));It(t,n)}},t)}function sn(e,t,n){var r=rt.stop();l(),r&&u("drop",e,zt(r),Xt(r),t,n)}var s=this;s.renderAgenda=bt,s.setWidth=Ot,s.setHeight=At,s.beforeHide=_t,s.afterShow=Dt,s.defaultEventEnd=Qt,s.timePosition=$t,s.dayOfWeekCol=Vt,s.dateCell=Ut,s.cellDate=zt,s.cellIsAllDay=Xt,s.allDayRow=Kt,s.allDayBounds=Jt,s.getHoverListener=function(){return rt},s.colContentLeft=qt,s.colContentRight=Rt,s.getDaySegmentContainer=function(){return _},s.getSlotSegmentContainer=function(){return j},s.getMinMinute=function(){return vt},s.getMaxMinute=function(){return mt},s.getBodyContent=function(){return B},s.getRowCnt=function(){return 1},s.getColCnt=function(){return et},s.getColWidth=function(){return K},s.getSlotHeight=function(){return G},s.defaultSelectionEnd=Gt,s.renderDayOverlay=jt,s.renderSelection=Yt,s.clearSelection=en,s.reportDayClick=nn,s.dragStart=rn,s.dragStop=sn,wt.call(s,n,r,i),xt.call(s),St.call(s),yt.call(s);var o=s.opt,u=s.trigger,a=s.clearEvents,f=s.renderOverlay,l=s.clearOverlays,c=s.reportSelection,h=s.unselect,p=s.daySelectionMousedown,d=s.slotSegHtml,v=r.formatDate,m,g,b,T,C,k,L,O,M,_,D,P,H,B,j,F,I,U,z,W,X,$,J,K,Q,G,Z,et,tt,nt,rt,ut,at={},ft,lt,ct,ht,pt,dt,vt,mt,gt;it(n.addClass("fc-agenda")),nt=new Tt(function(t,n){function l(e){return Math.max(a,Math.min(f,e))}var r,i,s;b.each(function(t,o){r=e(o),i=r.offset().left,t&&(s[1]=i),s=[i],n[t]=s}),s[1]=i+r.outerWidth(),o("allDaySlot")&&(r=P,i=r.offset().top,t[0]=[i,i+r.outerHeight()]);var u=B.offset().top,a=H.offset().top,f=a+H.outerHeight();for(var c=0;c<tt;c++)t.push([l(u+G*c),l(u+G*(c+1))])}),rt=new Nt(nt),ut=new kt(function(e){return k.eq(e)})}function yt(){function $(e,t){a(e);var n,i=e.length,s=[],o=[];for(n=0;n<i;n++)e[n].allDay?s.push(e[n]):o.push(e[n]);r("allDaySlot")&&(T(K(s),t),c()),Y(Q(o),t)}function J(){f(),h().empty(),p().empty()}function K(t){var r=F(j(t,e.map(t,D),n.visStart,n.visEnd)),i,s=r.length,o,u,a,f=[];for(i=0;i<s;i++){o=r[i];for(u=0;u<o.length;u++)a=o[u],a.row=0,a.level=i,f.push(a)}return f}function Q(t){var r=C(),i=g(),s=m(),o=w(S(n.visStart),i),u=e.map(t,G),a,f,l,c,h,p,d=[];for(a=0;a<r;a++){f=F(j(t,u,o,w(S(o),s-i))),bt(f);for(l=0;l<f.length;l++){c=f[l];for(h=0;h<c.length;h++)p=c[h],p.col=a,p.level=l,d.push(p)}y(o,1,!0)}return d}function G(e){return e.end?S(e.end):w(S(e.start),r("defaultEventMinutes"))}function Y(n,s){var o,u=n.length,a,f,l,c,h,d,v,m,g,y,w,S,T="",N,k,L,A={},M={},_,D,P,H,B=p(),j,F,q,R=C();(j=r("isRTL"))?(F=-1,q=R-1):(F=1,q=0);for(o=0;o<u;o++)a=n[o],f=a.event,c=b(a.start,a.start),h=b(a.start,a.end),d=a.col,v=a.level,m=a.forward||0,g=E(d*F+q),y=x(d*F+q)-g,y=Math.min(y-6,y*.95),v?w=y/(v+m+1):m?w=(y/(m+1)-6)*2:w=y,S=g+y/(v+m+1)*v*F+(j?y-w:0),a.top=c,a.left=S,a.outerWidth=w,a.outerHeight=h-c,T+=Z(f,a);B[0].innerHTML=T,N=B.children();for(o=0;o<u;o++)a=n[o],f=a.event,k=e(N[o]),L=i("eventRender",f,f,k),L===!1?k.remove():(L&&L!==!0&&(k.remove(),k=e(L).css({position:"absolute",top:a.top,left:a.left}).appendTo(B)),a.element=k,f._id===s?tt(f,k,a):k[0]._fci=o,O(f,k));I(B,n,tt);for(o=0;o<u;o++){a=n[o];if(k=a.element)D=A[_=a.key=rt(k[0])],a.vsides=D===t?A[_]=V(k,!0):D,D=M[_],a.hsides=D===t?M[_]=U(k,!0):D,P=k.find("div.fc-event-content"),P.length&&(a.contentTop=P[0].offsetTop)}for(o=0;o<u;o++){a=n[o];if(k=a.element)k[0].style.width=Math.max(0,a.outerWidth-a.hsides)+"px",H=Math.max(0,a.outerHeight-a.vsides),k[0].style.height=H+"px",f=a.event,a.contentTop!==t&&H-a.contentTop<10&&(k.find("div.fc-event-time").text(W(f.start,r("timeFormat"))+" - "+f.title),k.find("div.fc-event-title").remove()),i("eventAfterRender",f,f,k)}}function Z(e,t){var n="<",i=e.url,u=ut(e,r),a=u?" style='"+u+"'":"",f=["fc-event","fc-event-skin","fc-event-vert"];return s(e)&&f.push("fc-event-draggable"),t.isStart&&f.push("fc-corner-top"),t.isEnd&&f.push("fc-corner-bottom"),f=f.concat(e.className),e.source&&(f=f.concat(e.source.className||[])),i?n+="a href='"+nt(e.url)+"'":n+="div",n+=" class='"+f.join(" ")+"'"+" style='position:absolute;z-index:8;top:"+t.top+"px;left:"+t.left+"px;"+u+"'"+">"+"<div class='fc-event-inner fc-event-skin'"+a+">"+"<div class='fc-event-head fc-event-skin'"+a+">"+"<div class='fc-event-time'>"+nt(X(e.start,e.end,r("timeFormat")))+"</div>"+"</div>"+"<div class='fc-event-content'>"+"<div class='fc-event-title'>"+nt(e.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>"+"</div>",t.isEnd&&o(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(i?"a":"div")+">",n}function et(e,t,n){s(e)&&it(e,t,n.isStart),n.isEnd&&o(e)&&N(e,t,n),l(e,t)}function tt(e,t,n){var r=t.find("div.fc-event-time");s(e)&&st(e,t,r),n.isEnd&&o(e)&&ot(e,t,r),l(e,t)}function it(e,t,n){function m(){u||(t.width(s).height("").draggable("option","grid",null),u=!0)}var s,o,u=!0,a,f=r("isRTL")?-1:1,l=d(),c=k(),h=L(),p=g();t.draggable({zIndex:9,opacity:r("dragOpacity","month"),revertDuration:r("dragRevertDuration"),start:function(p,d){i("eventDragStart",t,e,p,d),_(e,t),s=t.width(),l.start(function(i,s,l,p){q(),i?(o=!1,a=p*f,i.row?n?u&&(t.width(c-10),R(t,h*Math.round((e.end?(e.end-e.start)/v:r("defaultEventMinutes"))/r("slotMinutes"))),t.draggable("option","grid",[c,1]),u=!1):o=!0:(B(y(S(e.start),a),y(D(e),a)),m()),o=o||u&&!a):(m(),o=!0),t.draggable("option","revert",o)},p,"drag")},stop:function(n,s){l.stop(),q(),i("eventDragStop",t,e,n,s);if(o)m(),t.css("filter",""),M(e,t);else{var f=0;u||(f=Math.round((t.offset().top-A().offset().top)/h)*r("slotMinutes")+p-(e.start.getHours()*60+e.start.getMinutes())),P(this,e,a,f,u,n,s)}}})}function st(e,t,n){function m(t){var i=w(S(e.start),t),s;e.end&&(s=w(S(e.end),t)),n.text(X(i,s,r("timeFormat")))}function g(){o&&(n.css("display",""),t.draggable("option","grid",[p,v]),o=!1)}var s,o=!1,u,a,f,l=r("isRTL")?-1:1,c=d(),h=C(),p=k(),v=L();t.draggable({zIndex:9,scroll:!1,grid:[p,v],axis:h==1?"y":!1,opacity:r("dragOpacity"),revertDuration:r("dragRevertDuration"),start:function(h,p){i("eventDragStart",t,e,h,p),_(e,t),s=t.position(),a=f=0,c.start(function(i,s,a,f){t.draggable("option","revert",!i),q(),i&&(u=f*l,r("allDaySlot")&&!i.row?(o||(o=!0,n.hide(),t.draggable("option","grid",null)),B(y(S(e.start),u),y(D(e),u))):g())},h,"drag")},drag:function(e,t){a=Math.round((t.position.top-s.top)/v)*r("slotMinutes"),a!=f&&(o||m(a),f=a)},stop:function(n,r){var f=c.stop();q(),i("eventDragStop",t,e,n,r),f&&(u||a||o)?P(this,e,u,o?0:a,o,n,r):(g(),t.css("filter",""),t.css(s),m(0),M(e,t))}})}function ot(e,t,n){var s,o,a=L();t.resizable({handles:{s:"div.ui-resizable-s"},grid:a,start:function(n,r){s=o=0,_(e,t),t.css("z-index",9),i("eventResizeStart",this,e,n,r)},resize:function(i,f){s=Math.round((Math.max(a,t.height())-f.originalSize.height)/a),s!=o&&(n.text(X(e.start,!s&&!e.end?null:w(u(e),r("slotMinutes")*s),r("timeFormat"))),o=s)},stop:function(n,o){i("eventResizeStop",this,e,n,o),s?H(this,e,0,r("slotMinutes")*s,n,o):(t.css("z-index",8),M(e,t))}})}var n=this;n.renderEvents=$,n.compileDaySegs=K,n.clearEvents=J,n.slotSegHtml=Z,n.bindDaySeg=et,Et.call(n);var r=n.opt,i=n.trigger,s=n.isEventDraggable,o=n.isEventResizable,u=n.eventEnd,a=n.reportEvents,f=n.reportEventClear,l=n.eventElementHandlers,c=n.setHeight,h=n.getDaySegmentContainer,p=n.getSlotSegmentContainer,d=n.getHoverListener,m=n.getMaxMinute,g=n.getMinMinute,b=n.timePosition,E=n.colContentLeft,x=n.colContentRight,T=n.renderDaySegs,N=n.resizableDayEvent,C=n.getColCnt,k=n.getColWidth,L=n.getSlotHeight,A=n.getBodyContent,O=n.reportEventElement,M=n.showEvents,_=n.hideEvents,P=n.eventDrop,H=n.eventResize,B=n.renderDayOverlay,q=n.clearOverlays,z=n.calendar,W=z.formatDate,X=z.formatDates}function bt(e){var t,n,r,i,s,o;for(t=e.length-1;t>0;t--){i=e[t];for(n=0;n<i.length;n++){s=i[n];for(r=0;r<e[t-1].length;r++)o=e[t-1][r],B(s,o)&&(o.forward=Math.max(o.forward||0,(s.forward||0)+1))}}}function wt(e,n,r){function h(e,t){var n=c[e];return typeof n=="object"?tt(n,t||r):n}function p(e,t){return n.trigger.apply(n,[e,t||i].concat(Array.prototype.slice.call(arguments,2),[i]))}function d(e){return m(e)&&!h("disableDragging")}function v(e){return m(e)&&!h("disableResizing")}function m(e){return ft(e.editable,(e.source||{}).editable,h("editable"))}function g(e){a={};var t,n=e.length,r;for(t=0;t<n;t++)r=e[t],a[r._id]?a[r._id].push(r):a[r._id]=[r]}function b(e){return e.end?S(e.end):s(e)}function E(e,t){f.push(t),l[e._id]?l[e._id].push(t):l[e._id]=[t]}function x(){f=[],l={}}function T(e,t){t.click(function(n){if(!t.hasClass("ui-draggable-dragging")&&!t.hasClass("ui-resizable-resizing"))return p("eventClick",this,e,n)}).hover(function(t){p("eventMouseover",this,e,t)},function(t){p("eventMouseout",this,e,t)})}function N(e,t){k(e,t,"show")}function C(e,t){k(e,t,"hide")}function k(e,t,n){var r=l[e._id],i,s=r.length;for(i=0;i<s;i++)(!t||r[i][0]!=t[0])&&r[i][n]()}function L(e,t,n,r,i,s,o){var f=t.allDay,l=t._id;O(a[l],n,r,i),p("eventDrop",e,t,n,r,i,function(){O(a[l],-n,-r,f),u(l)},s,o),u(l)}function A(e,t,n,r,i,s){var o=t._id;M(a[o],n,r),p("eventResize",e,t,n,r,function(){M(a[o],-n,-r),u(o)},i,s),u(o)}function O(e,n,r,i){r=r||0;for(var s,u=e.length,a=0;a<u;a++)s=e[a],i!==t&&(s.allDay=i),w(y(s.start,n,!0),r),s.end&&(s.end=w(y(s.end,n,!0),r)),o(s,c)}function M(e,t,n){n=n||0;for(var r,i=e.length,s=0;s<i;s++)r=e[s],r.end=w(y(b(r),t,!0),n),o(r,c)}var i=this;i.element=e,i.calendar=n,i.name=r,i.opt=h,i.trigger=p,i.isEventDraggable=d,i.isEventResizable=v,i.reportEvents=g,i.eventEnd=b,i.reportEventElement=E,i.reportEventClear=x,i.eventElementHandlers=T,i.showEvents=N,i.hideEvents=C,i.eventDrop=L,i.eventResize=A;var s=i.defaultEventEnd,o=n.normalizeEvent,u=n.reportEventChange,a={},f=[],l={},c=n.options}function Et(){function O(e,t){var n=T(),r,i=h(),s=p(),o=0,u,a,f,l,c=e.length,d,v,m;n[0].innerHTML=_(e),D(e,n.children()),P(e),H(e,n,t),B(e),j(e),F(e),r=q();for(u=0;u<i;u++){a=0,f=[];for(l=0;l<s;l++)f[l]=0;while(o<c&&(d=e[o]).row==u){v=Z(f.slice(d.startCol,d.endCol)),d.top=v,v+=d.outerHeight;for(m=d.startCol;m<d.endCol;m++)f[m]=v;o++}r[u].height(Z(f))}z(e,R(r))}function M(t,n,r){var i=e("<div/>"),s,o=T(),u,a=t.length,f;i[0].innerHTML=_(t),s=i.children(),o.append(s),D(t,s),B(t),j(t),F(t),z(t,R(q())),s=[];for(u=0;u<a;u++)f=t[u].element,f&&(t[u].row===n&&f.css("top",r),s.push(f[0]));return e(s)}function _(e){var t=r("isRTL"),n,i=e.length,u,a,f,l,c=m(),h=c.left,p=c.right,d,v,y,E,S,x="";for(n=0;n<i;n++)u=e[n],a=u.event,l=["fc-event","fc-event-skin","fc-event-hori"],s(a)&&l.push("fc-event-draggable"),t?(u.isStart&&l.push("fc-corner-right"),u.isEnd&&l.push("fc-corner-left"),d=w(u.end.getDay()-1),v=w(u.start.getDay()),y=u.isEnd?g(d):h,E=u.isStart?b(v):p):(u.isStart&&l.push("fc-corner-left"),u.isEnd&&l.push("fc-corner-right"),d=w(u.start.getDay()),v=w(u.end.getDay()-1),y=u.isStart?g(d):h,E=u.isEnd?b(v):p),l=l.concat(a.className),a.source&&(l=l.concat(a.source.className||[])),f=a.url,S=ut(a,r),f?x+="<a href='"+nt(f)+"'":x+="<div",x+=" class='"+l.join(" ")+"'"+" style='position:absolute;z-index:8;left:"+y+"px;"+S+"'"+">"+"<div"+" class='fc-event-inner fc-event-skin'"+(S?" style='"+S+"'":"")+">",!a.allDay&&u.isStart&&(x+="<span class='fc-event-time'>"+nt(C(a.start,a.end,r("timeFormat")))+"</span>"),x+="<span class='fc-event-title'>"+nt(a.title)+"</span>"+"</div>",u.isEnd&&o(a)&&(x+="<div class='ui-resizable-handle ui-resizable-"+(t?"w":"e")+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"),x+="</"+(f?"a":"div")+">",u.left=y,u.outerWidth=E-y,u.startCol=d,u.endCol=v+1;return x}function D(t,n){var r,s=t.length,o,u,a,f;for(r=0;r<s;r++)o=t[r],u=o.event,a=e(n[r]),f=i("eventRender",u,u,a),f===!1?a.remove():(f&&f!==!0&&(f=e(f).css({position:"absolute",left:o.left}),a.replaceWith(f),a=f),o.element=a)}function P(e){var t,n=e.length,r,i;for(t=0;t<n;t++)r=e[t],i=r.element,i&&a(r.event,i)}function H(e,t,n){var r,i=e.length,s,o,u;for(r=0;r<i;r++)s=e[r],o=s.element,o&&(u=s.event,u._id===n?N(u,o,s):o[0]._fci=r);I(t,e,N)}function B(e){var n,r=e.length,i,s,o,u,a={};for(n=0;n<r;n++)i=e[n],s=i.element,s&&(o=i.key=rt(s[0]),u=a[o],u===t&&(u=a[o]=U(s,!0)),i.hsides=u)}function j(e){var t,n=e.length,r,i;for(t=0;t<n;t++)r=e[t],i=r.element,i&&(i[0].style.width=Math.max(0,r.outerWidth-r.hsides)+"px")}function F(e){var n,r=e.length,i,s,o,u,a={};for(n=0;n<r;n++)i=e[n],s=i.element,s&&(o=i.key,u=a[o],u===t&&(u=a[o]=J(s)),i.outerHeight=s[0].offsetHeight+u)}function q(){var e,t=h(),n=[];for(e=0;e<t;e++)n[e]=v(e).find("td:first div.fc-day-content > div");return n}function R(e){var t,n=e.length,r=[];for(t=0;t<n;t++)r[t]=e[t][0].offsetTop;return r}function z(e,t){var n,r=e.length,s,o,u;for(n=0;n<r;n++)s=e[n],o=s.element,o&&(o[0].style.top=t[s.row]+(s.top||0)+"px",u=s.event,i("eventAfterRender",u,u,o))}function W(t,s,o){var a=r("isRTL"),d=a?"w":"e",v=s.find("div.ui-resizable-"+d),m=!1;it(s),s.mousedown(function(e){e.preventDefault()}).click(function(e){m&&(e.preventDefault(),e.stopImmediatePropagation())}),v.mousedown(function(r){function P(n){i("eventResizeStop",this,t,n),e("body").css("cursor",""),v.stop(),L(),C&&c(this,t,C,0,n),setTimeout(function(){m=!1},0)}if(r.which!=1)return;m=!0;var v=n.getHoverListener(),g=h(),b=p(),w=a?-1:1,T=a?b-1:0,N=s.css("top"),C,O,_=e.extend({},t),D=E(t.start);A(),e("body").css("cursor",d+"-resize").one("mouseup",P),i("eventResizeStart",this,t,r),v.start(function(e,n){if(e){var r=Math.max(D.row,e.row),i=e.col;g==1&&(r=0),r==D.row&&(a?i=Math.min(D.col,i):i=Math.max(D.col,i)),C=r*7+i*w+T-(n.row*7+n.col*w+T);var s=y(u(t),C,!0);if(C){_.end=s;var c=O;O=M(x([_]),o.row,N),O.find("*").css("cursor",d+"-resize"),c&&c.remove(),l(t)}else O&&(f(t),O.remove(),O=null);L(),k(t.start,y(S(s),1))}},r)})}var n=this;n.renderDaySegs=O,n.resizableDayEvent=W;var r=n.opt,i=n.trigger,s=n.isEventDraggable,o=n.isEventResizable,u=n.eventEnd,a=n.reportEventElement,f=n.showEvents,l=n.hideEvents,c=n.eventResize,h=n.getRowCnt,p=n.getColCnt,d=n.getColWidth,v=n.allDayRow,m=n.allDayBounds,g=n.colContentLeft,b=n.colContentRight,w=n.dayOfWeekCol,E=n.dateCell,x=n.compileDaySegs,T=n.getDaySegmentContainer,N=n.bindDaySeg,C=n.calendar.formatDates,k=n.renderDayOverlay,L=n.clearOverlays,A=n.clearSelection}function St(){function a(e,t,n){f(),t||(t=i(e,n)),s(e,t,n),l(e,t,n)}function f(e){u&&(u=!1,o(),r("unselect",null,e))}function l(e,t,n,i){u=!0,r("select",null,e,t,n,i)}function c(r){var i=t.cellDate,u=t.cellIsAllDay,a=t.getHoverListener(),c=t.reportDayClick;if(r.which==1&&n("selectable")){f(r);var h=this,p;a.start(function(e,t){o(),e&&u(e)?(p=[i(t),i(e)].sort(Y),s(p[0],p[1],!0)):p=null},r),e(document).one("mouseup",function(e){a.stop(),p&&(+p[0]==+p[1]&&c(p[0],!0,e),l(p[0],p[1],!0,e))})}}var t=this;t.select=a,t.unselect=f,t.reportSelection=l,t.daySelectionMousedown=c;var n=t.opt,r=t.trigger,i=t.defaultSelectionEnd,s=t.renderSelection,o=t.clearSelection,u=!1;n("selectable")&&n("unselectAuto")&&e(document).mousedown(function(t){var r=n("unselectCancel");if(r&&e(t.target).parents(r).length)return;f(t)})}function xt(){function i(t,i){var s=r.shift();return s||(s=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),s[0].parentNode!=i[0]&&s.appendTo(i),n.push(s.css(t).show()),s}function s(){var e;while(e=n.shift())r.push(e.hide().unbind())}var t=this;t.renderOverlay=i,t.clearOverlays=s;var n=[],r=[]}function Tt(e){var t=this,n,r;t.build=function(){n=[],r=[],e(n,r)},t.cell=function(e,t){var i=n.length,s=r.length,o,u=-1,a=-1;for(o=0;o<i;o++)if(t>=n[o][0]&&t<n[o][1]){u=o;break}for(o=0;o<s;o++)if(e>=r[o][0]&&e<r[o][1]){a=o;break}return u>=0&&a>=0?{row:u,col:a}:null},t.rect=function(e,t,i,s,o){var u=o.offset();return{top:n[e][0]-u.top,left:r[t][0]-u.left,width:r[s][1]-r[t][0],height:n[i][1]-n[e][0]}}}function Nt(t){function u(e){Ct(e);var n=t.cell(e.pageX,e.pageY);if(!n!=!o||n&&(n.row!=o.row||n.col!=o.col))n?(s||(s=n),i(n,s,n.row-s.row,n.col-s.col)):i(n,s),o=n}var n=this,r,i,s,o;n.start=function(n,a,f){i=n,s=o=null,t.build(),u(a),r=f||"mousemove",e(document).bind(r,u)},n.stop=function(){return e(document).unbind(r,u),o}}function Ct(e){e.pageX===t&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function kt(e){function o(t){return r[t]=r[t]||e(t)}var n=this,r={},i={},s={};n.left=function(e){return i[e]=i[e]===t?o(e).position().left:i[e]},n.right=function(e){return s[e]=s[e]===t?n.left(e)+o(e).width():s[e]},n.clear=function(){r={},i={},s={}}}var n={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},r={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},i=e.fullCalendar={version:"1.5.3"},s=i.views={};e.fn.fullCalendar=function(i){if(typeof i=="string"){var s=Array.prototype.slice.call(arguments,1),o;return this.each(function(){var n=e.data(this,"fullCalendar");if(n&&e.isFunction(n[i])){var r=n[i].apply(n,s);o===t&&(o=r),i=="destroy"&&e.removeData(this,"fullCalendar")}}),o!==t?o:this}var a=i.eventSources||[];return delete i.eventSources,i.events&&(a.push(i.events),delete i.events),i=e.extend(!0,{},n,i.isRTL||i.isRTL===t&&n.isRTL?r:{},i),this.each(function(t,n){var r=e(n),s=new u(r,i,a);r.data("fullCalendar",s),s.render()}),this},i.sourceNormalizers=[],i.sourceFetchers=[];var f={dataType:"json",cache:!1},l=1;i.addDays=y,i.cloneDate=S,i.parseDate=k,i.parseISO8601=L,i.parseTime=A,i.formatDate=O,i.formatDates=M;var h=["sun","mon","tue","wed","thu","fri","sat"],p=864e5,d=36e5,v=6e4,_={s:function(e){return e.getSeconds()},ss:function(e){return et(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return et(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return et(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return et(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return et(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return et(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return O(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"}};i.applyAll=at,s.month=lt,s.basicWeek=ct,s.basicDay=ht,o({weekMode:"fixed"}),s.agendaWeek=vt,s.agendaDay=mt,o({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery),define("jquery.calendar",function(){}),function(e,t,n){function G(n,r,i){var o=t.createElement(n);return r&&(o.id=s+r),i&&(o.style.cssText=i),e(o)}function Y(e){var t=T.length,n=(U+e)%t;return n<0?t+n:n}function Z(e,t){return Math.round((/%/.test(e)?(t==="x"?tt():nt())/100:1)*parseInt(e,10))}function et(e){return B.photo||/\.(gif|png|jp(e|g|eg)|bmp|ico)((#|\?).*)?$/i.test(e)}function tt(){return n.innerWidth||N.width()}function nt(){return n.innerHeight||N.height()}function rt(){var t,n=e.data(R,i);n==null?(B=e.extend({},r),console&&console.log&&console.log("Error: cboxElement missing settings object")):B=e.extend({},n);for(t in B)e.isFunction(B[t])&&t.slice(0,2)!=="on"&&(B[t]=B[t].call(R));B.rel=B.rel||R.rel||"nofollow",B.href=B.href||e(R).attr("href"),B.title=B.title||R.title,typeof B.href=="string"&&(B.href=e.trim(B.href))}function it(t,n){e.event.trigger(t),n&&n.call(R)}function st(){var e,t=s+"Slideshow_",n="click."+s,r,i,o;B.slideshow&&T[1]?(r=function(){M.text(B.slideshowStop).unbind(n).bind(f,function(){if(B.loop||T[U+1])e=setTimeout(J.next,B.slideshowSpeed)}).bind(a,function(){clearTimeout(e)}).one(n+" "+l,i),g.removeClass(t+"off").addClass(t+"on"),e=setTimeout(J.next,B.slideshowSpeed)},i=function(){clearTimeout(e),M.text(B.slideshowStart).unbind([f,a,l,n].join(" ")).one(n,function(){J.next(),r()}),g.removeClass(t+"on").addClass(t+"off")},B.slideshowAuto?r():i()):g.removeClass(t+"off "+t+"on")}function ot(t){V||(R=t,rt(),T=e(R),U=0,B.rel!=="nofollow"&&(T=e("."+o).filter(function(){var t=e.data(this,i),n;return t&&(n=t.rel||this.rel),n===B.rel}),U=T.index(R),U===-1&&(T=T.add(R),U=T.length-1)),W||(W=X=!0,g.show(),B.returnFocus&&e(R).blur().one(c,function(){e(this).focus()}),m.css({opacity:+B.opacity,cursor:B.overlayClose?"pointer":"auto"}).show(),B.w=Z(B.initialWidth,"x"),B.h=Z(B.initialHeight,"y"),J.position(),d&&N.bind("resize."+v+" scroll."+v,function(){m.css({width:tt(),height:nt(),top:N.scrollTop(),left:N.scrollLeft()})}).trigger("resize."+v),it(u,B.onOpen),H.add(A).hide(),P.html(B.close).show()),J.load(!0))}function ut(){!g&&t.body&&(Q=!1,N=e(n),g=G(K).attr({id:i,"class":p?s+(d?"IE6":"IE"):""}).hide(),m=G(K,"Overlay",d?"position:absolute":"").hide(),L=G(K,"LoadingOverlay").add(G(K,"LoadingGraphic")),y=G(K,"Wrapper"),b=G(K,"Content").append(C=G(K,"LoadedContent","width:0; height:0; overflow:hidden"),A=G(K,"Title"),O=G(K,"Current"),_=G(K,"Next"),D=G(K,"Previous"),M=G(K,"Slideshow").bind(u,st),P=G(K,"Close")),y.append(G(K).append(G(K,"TopLeft"),w=G(K,"TopCenter"),G(K,"TopRight")),G(K,!1,"clear:left").append(E=G(K,"MiddleLeft"),b,S=G(K,"MiddleRight")),G(K,!1,"clear:left").append(G(K,"BottomLeft"),x=G(K,"BottomCenter"),G(K,"BottomRight"))).find("div div").css({"float":"left"}),k=G(K,!1,"position:absolute; width:9999px; visibility:hidden; display:none"),H=_.add(D).add(O).add(M),e(t.body).append(m,g.append(y,k)))}function at(){return g?(Q||(Q=!0,j=w.height()+x.height()+b.outerHeight(!0)-b.height(),F=E.width()+S.width()+b.outerWidth(!0)-b.width(),I=C.outerHeight(!0),q=C.outerWidth(!0),g.css({"padding-bottom":j,"padding-right":F}),_.click(function(){J.next()}),D.click(function(){J.prev()}),P.click(function(){J.close()}),m.click(function(){B.overlayClose&&J.close()}),e(t).bind("keydown."+s,function(e){var t=e.keyCode;W&&B.escKey&&t===27&&(e.preventDefault(),J.close()),W&&B.arrowKey&&T[1]&&(t===37?(e.preventDefault(),D.click()):t===39&&(e.preventDefault(),_.click()))}),e("."+o,t).live("click",function(e){e.which>1||e.shiftKey||e.altKey||e.metaKey||(e.preventDefault(),ot(this))})),!0):!1}var r={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",open:!1,returnFocus:!0,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:undefined},i="colorbox",s="cbox",o=s+"Element",u=s+"_open",a=s+"_load",f=s+"_complete",l=s+"_cleanup",c=s+"_closed",h=s+"_purge",p=!e.support.opacity&&!e.support.style,d=p&&!n.XMLHttpRequest,v=s+"_IE6",m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K="div",Q;if(e.colorbox)return;e(ut),J=e.fn[i]=e[i]=function(t,n){var s=this;t=t||{},ut();if(at()){if(!s[0]){if(s.selector)return s;s=e("<a/>"),t.open=!0}n&&(t.onComplete=n),s.each(function(){e.data(this,i,e.extend({},e.data(this,i)||r,t))}).addClass(o),(e.isFunction(t.open)&&t.open.call(s)||t.open)&&ot(s[0])}return s},J.position=function(e,t){function f(e){w[0].style.width=x[0].style.width=b[0].style.width=e.style.width,b[0].style.height=E[0].style.height=S[0].style.height=e.style.height}var n,r=0,i=0,o=g.offset(),u,a;N.unbind("resize."+s),g.css({top:-9e4,left:-9e4}),u=N.scrollTop(),a=N.scrollLeft(),B.fixed&&!d?(o.top-=u,o.left-=a,g.css({position:"fixed"})):(r=u,i=a,g.css({position:"absolute"})),B.right!==!1?i+=Math.max(tt()-B.w-q-F-Z(B.right,"x"),0):B.left!==!1?i+=Z(B.left,"x"):i+=Math.round(Math.max(tt()-B.w-q-F,0)/2),B.bottom!==!1?r+=Math.max(nt()-B.h-I-j-Z(B.bottom,"y"),0):B.top!==!1?r+=Z(B.top,"y"):r+=Math.round(Math.max(nt()-B.h-I-j,0)/2),g.css({top:o.top,left:o.left}),e=g.width()===B.w+q&&g.height()===B.h+I?0:e||0,y[0].style.width=y[0].style.height="9999px",n={width:B.w+q,height:B.h+I,top:r,left:i},e===0&&g.css(n),g.dequeue().animate(n,{duration:e,complete:function(){f(this),X=!1,y[0].style.width=B.w+q+F+"px",y[0].style.height=B.h+I+j+"px",B.reposition&&setTimeout(function(){N.bind("resize."+s,J.position)},1),t&&t()},step:function(){f(this)}})},J.resize=function(e){W&&(e=e||{},e.width&&(B.w=Z(e.width,"x")-q-F),e.innerWidth&&(B.w=Z(e.innerWidth,"x")),C.css({width:B.w}),e.height&&(B.h=Z(e.height,"y")-I-j),e.innerHeight&&(B.h=Z(e.innerHeight,"y")),!e.innerHeight&&!e.height&&(C.css({height:"auto"}),B.h=C.height()),C.css({height:B.h}),J.position(B.transition==="none"?0:B.speed))},J.prep=function(t){function o(){return B.w=B.w||C.width(),B.w=B.mw&&B.mw<B.w?B.mw:B.w,B.w}function u(){return B.h=B.h||C.height(),B.h=B.mh&&B.mh<B.h?B.mh:B.h,B.h}if(!W)return;var n,r=B.transition==="none"?0:B.speed;C.remove(),C=G(K,"LoadedContent").append(t),C.hide().appendTo(k.show()).css({width:o(),overflow:B.scrolling?"auto":"hidden"}).css({height:u()}).prependTo(b),k.hide(),e(z).css({"float":"none"}),d&&e("select").not(g.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(l,function(){this.style.visibility="inherit"}),n=function(){function y(){p&&g[0].style.removeAttribute("filter")}var t,n,o=T.length,u,a="frameBorder",l="allowTransparency",c,d,v,m;if(!W)return;c=function(){clearTimeout($),L.detach().hide(),it(f,B.onComplete)},p&&z&&C.fadeIn(100),A.html(B.title).add(C).show();if(o>1){typeof B.current=="string"&&O.html(B.current.replace("{current}",U+1).replace("{total}",o)).show(),_[B.loop||U<o-1?"show":"hide"]().html(B.next),D[B.loop||U?"show":"hide"]().html(B.previous),B.slideshow&&M.show();if(B.preloading){t=[Y(-1),Y(1)];while(n=T[t.pop()])m=e.data(n,i),m&&m.href?(d=m.href,e.isFunction(d)&&(d=d.call(n))):d=n.href,et(d)&&(v=new Image,v.src=d)}}else H.hide();B.iframe?(u=G("iframe")[0],a in u&&(u[a]=0),l in u&&(u[l]="true"),u.name=s+ +(new Date),B.fastIframe?c():e(u).one("load",c),u.src=B.href,B.scrolling||(u.scrolling="no"),e(u).addClass(s+"Iframe").appendTo(C).one(h,function(){u.src="//about:blank"})):c(),B.transition==="fade"?g.fadeTo(r,1,y):y()},B.transition==="fade"?g.fadeTo(r,0,function(){J.position(0,n)}):J.position(r,n)},J.load=function(t){var n,r,i=J.prep;X=!0,z=!1,R=T[U],t||rt(),it(h),it(a,B.onLoad),B.h=B.height?Z(B.height,"y")-I-j:B.innerHeight&&Z(B.innerHeight,"y"),B.w=B.width?Z(B.width,"x")-q-F:B.innerWidth&&Z(B.innerWidth,"x"),B.mw=B.w,B.mh=B.h,B.maxWidth&&(B.mw=Z(B.maxWidth,"x")-q-F,B.mw=B.w&&B.w<B.mw?B.w:B.mw),B.maxHeight&&(B.mh=Z(B.maxHeight,"y")-I-j,B.mh=B.h&&B.h<B.mh?B.h:B.mh),n=B.href,$=setTimeout(function(){L.show().appendTo(b)},100),B.inline?(G(K).hide().insertBefore(e(n)[0]).one(h,function(){e(this).replaceWith(C.children())}),i(e(n))):B.iframe?i(" "):B.html?i(B.html):et(n)?(e(z=new Image).addClass(s+"Photo").error(function(){B.title=!1,i(G(K,"Error").html(B.imgError))}).load(function(){var e;z.onload=null,B.scalePhotos&&(r=function(){z.height-=z.height*e,z.width-=z.width*e},B.mw&&z.width>B.mw&&(e=(z.width-B.mw)/z.width,r()),B.mh&&z.height>B.mh&&(e=(z.height-B.mh)/z.height,r())),B.h&&(z.style.marginTop=Math.max(B.h-z.height,0)/2+"px"),T[1]&&(B.loop||T[U+1])&&(z.style.cursor="pointer",z.onclick=function(){J.next()}),p&&(z.style.msInterpolationMode="bicubic"),setTimeout(function(){i(z)},1)}),setTimeout(function(){z.src=n},1)):n&&k.load(n,B.data,function(t,n,r){i(n==="error"?G(K,"Error").html(B.xhrError):e(this).contents())})},J.next=function(){!X&&T[1]&&(B.loop||T[U+1])&&(U=Y(1),J.load())},J.prev=function(){!X&&T[1]&&(B.loop||U)&&(U=Y(-1),J.load())},J.close=function(){W&&!V&&(V=!0,W=!1,it(l,B.onCleanup),N.unbind("."+s+" ."+v),m.fadeTo(200,0),g.stop().fadeTo(300,0,function(){g.add(m).css({opacity:1,cursor:"auto"}).hide(),it(h),C.remove(),setTimeout(function(){V=!1,it(c,B.onClosed)},1)}))},J.remove=function(){e([]).add(g).add(m).remove(),g=null,e("."+o).removeData(i).removeClass(o).die()},J.element=function(){return e(R)},J.settings=r}(jQuery,document,this),define("lightbox",function(){}),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",function(){}),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype={constructor:t,setState:function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},toggle:function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")}},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),define("bootstrap-button",function(){}),function(){function l(){this.returnValue=!1}function c(){this.cancelBubble=!0}var e=0,t=[],n={},r={},i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},s=/[<>&\"\']/g,o,u=window.setTimeout,a={},f;(function(e){var t=e.split(/,/),n,i,s;for(n=0;n<t.length;n+=2){s=t[n+1].split(/ /);for(i=0;i<s.length;i++)r[s[i]]=t[n]}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var h={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:r,ua:function(){var e=navigator,t=e.userAgent,n=e.vendor,r,i,s;return r=/WebKit/.test(t),s=r&&n.indexOf("Apple")!==-1,i=window.opera&&window.opera.buildNumber,{windows:navigator.platform.indexOf("Win")!==-1,android:/Android/.test(t),ie:!r&&!i&&/MSIE/gi.test(t)&&/Explorer/gi.test(e.appName),webkit:r,gecko:!r&&/Gecko/.test(t),safari:s,opera:!!i}}(),typeOf:function(e){return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(e){return h.each(arguments,function(t,n){n>0&&h.each(t,function(t,n){e[n]=t})}),e},cleanName:function(e){var t,n;n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,""),e},addRuntime:function(e,n){return n.name=e,t[e]=n,t.push(n),n},guid:function(){var t=(new Date).getTime().toString(32),n;for(n=0;n<5;n++)t+=Math.floor(Math.random()*65535).toString(32);return(h.guidPrefix||"p")+t+(e++).toString(32)},buildUrl:function(e,t){var n="";return h.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},each:function(e,t){var n,r,i;if(e){n=e.length;if(n===o){for(r in e)if(e.hasOwnProperty(r)&&t(e[r],r)===!1)return}else for(i=0;i<n;i++)if(t(e[i],i)===!1)return}},formatSize:function(e){return e===o||/\D/.test(e)?h.translate("N/A"):e>1073741824?Math.round(e/1073741824,1)+" GB":e>1048576?Math.round(e/1048576,1)+" MB":e>1024?Math.round(e/1024,1)+" KB":e+" b"},getPos:function(e,t){function a(e){var t,n,r=0,i=0;return e&&(n=e.getBoundingClientRect(),t=s.compatMode==="CSS1Compat"?s.documentElement:s.body,r=n.left+t.scrollLeft,i=n.top+t.scrollTop),{x:r,y:i}}var n=0,r=0,i,s=document,o,u;e=e,t=t||s.body;if(e&&e.getBoundingClientRect&&h.ua.ie&&(!s.documentMode||s.documentMode<8))return o=a(e),u=a(t),{x:o.x-u.x,y:o.y-u.y};i=e;while(i&&i!=t&&i.nodeType)n+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;i=e.parentNode;while(i&&i!=t&&i.nodeType)n-=i.scrollLeft||0,r-=i.scrollTop||0,i=i.parentNode;return{x:n,y:r}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSize:function(e){var t;return typeof e=="string"&&(e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],t=="g"&&(e*=1073741824),t=="m"&&(e*=1048576),t=="k"&&(e*=1024)),e},xmlEncode:function(e){return e?(""+e).replace(s,function(e){return i[e]?"&"+i[e]+";":e}):e},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},inArray:function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1},addI18n:function(e){return h.extend(n,e)},translate:function(e){return n[e]||e},isEmptyObj:function(e){if(e===o)return!0;for(var t in e)return!1;return!0},hasClass:function(e,t){var n;return e.className==""?!1:(n=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),n.test(e.className))},addClass:function(e,t){h.hasClass(e,t)||(e.className=e.className==""?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return t===" "&&n===" "?" ":""})},getStyle:function(e,t){if(e.currentStyle)return e.currentStyle[t];if(window.getComputedStyle)return window.getComputedStyle(e,null)[t]},addEvent:function(e,t,n){var r,i,s,u;u=arguments[3],t=t.toLowerCase(),f===o&&(f="Plupload_"+h.guid()),e.addEventListener?(r=n,e.addEventListener(t,r,!1)):e.attachEvent&&(r=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=l,e.stopPropagation=c,n(e)},e.attachEvent("on"+t,r)),e[f]===o&&(e[f]=h.guid()),a.hasOwnProperty(e[f])||(a[e[f]]={}),i=a[e[f]],i.hasOwnProperty(t)||(i[t]=[]),i[t].push({func:r,orig:n,key:u})},removeEvent:function(e,t){var n,r,i;typeof arguments[2]=="function"?r=arguments[2]:i=arguments[2],t=t.toLowerCase();if(!(e[f]&&a[e[f]]&&a[e[f]][t]))return;n=a[e[f]][t];for(var s=n.length-1;s>=0;s--)if(n[s].key===i||n[s].orig===r){e.removeEventListener?e.removeEventListener(t,n[s].func,!1):e.detachEvent&&e.detachEvent("on"+t,n[s].func),n[s].orig=null,n[s].func=null,n.splice(s,1);if(r!==o)break}n.length||delete a[e[f]][t];if(h.isEmptyObj(a[e[f]])){delete a[e[f]];try{delete e[f]}catch(u){e[f]=o}}},removeAllEvents:function(e){var t=arguments[1];if(e[f]===o||!e[f])return;h.each(a[e[f]],function(n,r){h.removeEvent(e,r,t)})}};h.Uploader=function(e){function f(){var e,t=0,n;if(this.state==h.STARTED){for(n=0;n<i.length;n++)!e&&i[n].status==h.QUEUED?(e=i[n],e.status=h.UPLOADING,this.trigger("BeforeUpload",e)&&this.trigger("UploadFile",e)):t++;t==i.length&&(this.stop(),this.trigger("UploadComplete",i))}}function l(){var e,t;r.reset();for(e=0;e<i.length;e++)t=i[e],t.size!==o?(r.size+=t.size,r.loaded+=t.loaded):r.size=o,t.status==h.DONE?r.uploaded++:t.status==h.FAILED?r.failed++:r.queued++;r.size===o?r.percent=i.length>0?Math.ceil(r.uploaded/i.length*100):0:(r.bytesPerSec=Math.ceil(r.loaded/((+(new Date)-s||1)/1e3)),r.percent=r.size>0?Math.ceil(r.loaded/r.size*100):0)}var n={},r,i=[],s,a=!1;r=new h.QueueProgress,e=h.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},e),h.extend(this,{state:h.STOPPED,runtime:"",features:{},files:i,settings:e,total:r,id:h.guid(),init:function(){function v(){var e=a[p++],t,r,i;if(e){t=e.getFeatures(),r=n.settings.required_features;if(r){r=r.split(",");for(i=0;i<r.length;i++)if(!t[r[i]]){v();return}}e.init(n,function(r){r&&r.success?(n.features=t,n.runtime=e.name,n.trigger("Init",{runtime:e.name}),n.trigger("PostInit"),n.refresh()):v()})}else n.trigger("Error",{code:h.INIT_ERROR,message:h.translate("Init error.")})}var n=this,r,a,c,p=0,d;typeof e.preinit=="function"?e.preinit(n):h.each(e.preinit,function(e,t){n.bind(t,e)}),e.page_url=e.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(e.url)||(e.url=e.page_url+e.url),e.chunk_size=h.parseSize(e.chunk_size),e.max_file_size=h.parseSize(e.max_file_size),n.bind("FilesAdded",function(t,r){var s,a,f=0,l,c=e.filters;c&&c.length&&(l=[],h.each(c,function(e){h.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?l.push("\\.*"):l.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),l=new RegExp(l.join("|")+"$","i"));for(s=0;s<r.length;s++){a=r[s],a.loaded=0,a.percent=0,a.status=h.QUEUED;if(l&&!l.test(a.name)){t.trigger("Error",{code:h.FILE_EXTENSION_ERROR,message:h.translate("File extension error."),file:a});continue}if(a.size!==o&&a.size>e.max_file_size){t.trigger("Error",{code:h.FILE_SIZE_ERROR,message:h.translate("File size error."),file:a});continue}i.push(a),f++}if(!f)return!1;u(function(){n.trigger("QueueChanged"),n.refresh()},1)}),e.unique_names&&n.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),r="tmp";n&&(r=n[1]),t.target_name=t.id+"."+r}),n.bind("UploadProgress",function(e,t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,l()}),n.bind("StateChanged",function(e){if(e.state==h.STARTED)s=+(new Date);else if(e.state==h.STOPPED)for(r=e.files.length-1;r>=0;r--)e.files[r].status==h.UPLOADING&&(e.files[r].status=h.QUEUED,l())}),n.bind("QueueChanged",l),n.bind("Error",function(e,t){t.file&&(t.file.status=h.FAILED,l(),e.state==h.STARTED&&u(function(){f.call(n)},1))}),n.bind("FileUploaded",function(e,t){t.status=h.DONE,t.loaded=t.size,e.trigger("UploadProgress",t),u(function(){f.call(n)},1)});if(e.runtimes){a=[],d=e.runtimes.split(/\s?,\s?/);for(r=0;r<d.length;r++)t[d[r]]&&a.push(t[d[r]])}else a=t;v(),typeof e.init=="function"?e.init(n):h.each(e.init,function(e,t){n.bind(t,e)})},refresh:function(){this.trigger("Refresh")},start:function(){i.length&&this.state!=h.STARTED&&(this.state=h.STARTED,this.trigger("StateChanged"),f.call(this))},stop:function(){this.state!=h.STOPPED&&(this.state=h.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(){a=arguments[0]!==o?arguments[0]:!0,this.trigger("DisableBrowse",a)},getFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e)return i[t]},removeFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){var n;return n=i.splice(e===o?0:e,t===o?i.length:t),this.trigger("FilesRemoved",n),this.trigger("QueueChanged"),n},trigger:function(e){var t=n[e.toLowerCase()],r,i;if(t){i=Array.prototype.slice.call(arguments),i[0]=this;for(r=0;r<t.length;r++)if(t[r].func.apply(t[r].scope,i)===!1)return!1}return!0},hasEventListener:function(e){return!!n[e.toLowerCase()]},bind:function(e,t,r){var i;e=e.toLowerCase(),i=n[e]||[],i.push({func:t,scope:r||this}),n[e]=i},unbind:function(e){e=e.toLowerCase();var t=n[e],r,i=arguments[1];if(t){if(i!==o){for(r=t.length-1;r>=0;r--)if(t[r].func===i){t.splice(r,1);break}}else t=[];t.length||delete n[e]}},unbindAll:function(){var e=this;h.each(n,function(t,n){e.unbind(n)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},h.File=function(e,t,n){var r=this;r.id=e,r.name=t,r.size=n,r.loaded=0,r.percent=0,r.status=0},h.Runtime=function(){this.getFeatures=function(){},this.init=function(e,t){}},h.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},h.runtimes={},window.plupload=h}(),define("plupload",function(){}),function(e,t,n,r){function u(e){var n=e.naturalWidth,r=e.naturalHeight;if(n*r>1048576){var i=t.createElement("canvas");i.width=i.height=1;var s=i.getContext("2d");return s.drawImage(e,-n+1,0),s.getImageData(0,0,1,1).data[3]===0}return!1}function a(e,n,r){var i=t.createElement("canvas");i.width=1,i.height=r;var s=i.getContext("2d");s.drawImage(e,0,0);var o=s.getImageData(0,0,1,r).data,u=0,a=r,f=r;while(f>u){var l=o[(f-1)*4+3];l===0?a=f:u=f,f=a+u>>1}var c=f/r;return c===0?1:c}function f(e,n,r){var i=e.naturalWidth,s=e.naturalHeight,o=r.width,f=r.height,l=n.getContext("2d");l.save();var c=u(e);c&&(i/=2,s/=2);var h=1024,p=t.createElement("canvas");p.width=p.height=h;var d=p.getContext("2d"),v=a(e,i,s),m=0;while(m<s){var g=m+h>s?s-m:h,y=0;while(y<i){var b=y+h>i?i-y:h;d.clearRect(0,0,h,h),d.drawImage(e,-y,-m);var w=y*o/i<<0,E=Math.ceil(b*o/i),S=m*f/s/v<<0,x=Math.ceil(g*f/s/v);l.drawImage(p,0,0,b,g,w,S,E,x),y+=h}m+=h}l.restore(),p=d=null}function l(t,n){var r;if(!("FileReader"in e))return n(t.getAsDataURL());r=new FileReader,r.readAsDataURL(t),r.onload=function(){n(r.result)}}function c(t,n){var r;if(!("FileReader"in e))return n(t.getAsBinary());r=new FileReader,r.readAsBinaryString(t),r.onload=function(){n(r.result)}}function h(e,n,r,i){var o,u,a,c,h=this;l(s[e.id],function(s){o=t.createElement("canvas"),o.style.display="none",t.body.appendChild(o),a=new Image,a.onerror=a.onabort=function(){i({success:!1})},a.onload=function(){var t,u,l,p,m;n.width||(n.width=a.width),n.height||(n.height=a.height),c=Math.min(n.width/a.width,n.height/a.height);if(c<1)t=Math.round(a.width*c),u=Math.round(a.height*c);else{if(!n.quality||r!=="image/jpeg"){i({success:!1});return}t=a.width,u=a.height}o.width=t,o.height=u,f(a,o,{width:t,height:u}),r==="image/jpeg"&&(p=new d(atob(s.substring(s.indexOf("base64,")+7))),p.headers&&p.headers.length&&(m=new v,m.init(p.get("exif")[0])&&(m.setExif("PixelXDimension",t),m.setExif("PixelYDimension",u),p.set("exif",m.getBinary()),h.hasEventListener("ExifData")&&h.trigger("ExifData",e,m.EXIF()),h.hasEventListener("GpsData")&&h.trigger("GpsData",e,m.GPS()))));if(n.quality&&r==="image/jpeg")try{s=o.toDataURL(r,n.quality/100)}catch(g){s=o.toDataURL(r)}else s=o.toDataURL(r);s=s.substring(s.indexOf("base64,")+7),s=atob(s),p&&p.headers&&p.headers.length&&(s=p.restore(s),p.purge()),o.parentNode.removeChild(o),i({success:!0,data:s})},a.src=s})}function p(){function n(n,r){var i=e?0:-8*(r-1),s=0,o;for(o=0;o<r;o++)s|=t.charCodeAt(n+o)<<Math.abs(i+o*8);return s}function i(e,n,r){var r=arguments.length===3?r:t.length-n-1;t=t.substr(0,n)+e+t.substr(r+n)}function s(t,n,r){var s="",o=e?0:-8*(r-1),u;for(u=0;u<r;u++)s+=String.fromCharCode(n>>Math.abs(o+u*8)&255);i(s,t,r)}var e=!1,t;return{II:function(t){if(t===r)return e;e=t},init:function(n){e=!1,t=n},SEGMENT:function(e,n,r){switch(arguments.length){case 1:return t.substr(e,t.length-e-1);case 2:return t.substr(e,n);case 3:i(r,e,n);break;default:return t}},BYTE:function(e){return n(e,1)},SHORT:function(e){return n(e,2)},LONG:function(e,t){if(t===r)return n(e,4);s(e,t,4)},SLONG:function(e){var t=n(e,4);return t>2147483647?t-4294967296:t},STRING:function(e,t){var r="";for(t+=e;e<t;e++)r+=String.fromCharCode(n(e,1));return r}}}function d(e){var t={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},n=[],i,s,o=r,u=0,a;i=new p,i.init(e);if(i.SHORT(0)!==65496)return;s=2,a=Math.min(1048576,e.length);while(s<=a){o=i.SHORT(s);if(o>=65488&&o<=65495){s+=2;continue}if(o===65498||o===65497)break;u=i.SHORT(s+2)+2,t[o]&&i.STRING(s+4,t[o].signature.length)===t[o].signature&&n.push({hex:o,app:t[o].app.toUpperCase(),name:t[o].name.toUpperCase(),start:s,length:u,segment:i.SEGMENT(s,u)}),s+=u}return i.init(null),{headers:n,restore:function(e){i.init(e);var t=new d(e);if(!t.headers)return!1;for(var r=t.headers.length;r>0;r--){var o=t.headers[r-1];i.SEGMENT(o.start,o.length,"")}t.purge(),s=i.SHORT(2)==65504?4+i.SHORT(4):2;for(var r=0,u=n.length;r<u;r++)i.SEGMENT(s,0,n[r].segment),s+=n[r].length;return i.SEGMENT()},get:function(e){var t=[];for(var r=0,i=n.length;r<i;r++)n[r].app===e.toUpperCase()&&t.push(n[r].segment);return t},set:function(e,t){var r=[];typeof t=="string"?r.push(t):r=t;for(var i=ii=0,s=n.length;i<s;i++){n[i].app===e.toUpperCase()&&(n[i].segment=r[ii],n[i].length=r[ii].length,ii++);if(ii>=r.length)break}},purge:function(){n=[],i.init(null)}}}function v(){function u(t,n){var i=e.SHORT(t),u,a,f,l,c,h,p,d,v=[],m={};for(u=0;u<i;u++){p=h=t+12*u+2,f=n[e.SHORT(p)];if(f===r)continue;l=e.SHORT(p+=2),c=e.LONG(p+=2),p+=4,v=[];switch(l){case 1:case 7:c>4&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.BYTE(p+a);break;case 2:c>4&&(p=e.LONG(p)+s.tiffHeader),m[f]=e.STRING(p,c-1);continue;case 3:c>2&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.SHORT(p+a*2);break;case 4:c>1&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.LONG(p+a*4);break;case 5:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.LONG(p+a*4)/e.LONG(p+a*4+4);break;case 9:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4);break;case 10:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4)/e.SLONG(p+a*4+4);break;default:continue}d=c==1?v[0]:v,o.hasOwnProperty(f)&&typeof d!="object"?m[f]=o[f][d]:m[f]=d}return m}function a(){var n=r,i=s.tiffHeader;return e.II(e.SHORT(i)==18761),e.SHORT(i+=2)!==42?!1:(s.IFD0=s.tiffHeader+e.LONG(i+=2),n=u(s.IFD0,t.tiff),s.exifIFD="ExifIFDPointer"in n?s.tiffHeader+n.ExifIFDPointer:r,s.gpsIFD="GPSInfoIFDPointer"in n?s.tiffHeader+n.GPSInfoIFDPointer:r,!0)}function f(n,r,o){var u,a,f,l=0;if(typeof r=="string"){var c=t[n.toLowerCase()];for(hex in c)if(c[hex]===r){r=hex;break}}u=s[n.toLowerCase()+"IFD"],a=e.SHORT(u);for(i=0;i<a;i++){f=u+12*i+2;if(e.SHORT(f)==r){l=f+8;break}}return l?(e.LONG(l,o),!0):!1}var e,t,s={},o;return e=new p,t={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},o={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return s={tiffHeader:10},t===r||!t.length?!1:(e.init(t),e.SHORT(0)===65505&&e.STRING(4,5).toUpperCase()==="EXIF\0"?a():!1)},EXIF:function(){var e;e=u(s.exifIFD,t.exif);if(e.ExifVersion&&n.typeOf(e.ExifVersion)==="array"){for(var r=0,i="";r<e.ExifVersion.length;r++)i+=String.fromCharCode(e.ExifVersion[r]);e.ExifVersion=i}return e},GPS:function(){var e;return e=u(s.gpsIFD,t.gps),e.GPSVersionID&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){return e!=="PixelXDimension"&&e!=="PixelYDimension"?!1:f("exif",e,t)},getBinary:function(){return e.SEGMENT()}}}var s={},o;n.runtimes.Html5=n.addRuntime("html5",{getFeatures:function(){var r,i,s,u,a,f;return i=s=a=f=!1,e.XMLHttpRequest&&(r=new XMLHttpRequest,s=!!r.upload,i=!!r.sendAsBinary||!!r.upload),i&&(u=!!(r.sendAsBinary||e.Uint8Array&&e.ArrayBuffer),a=!(!File||!File.prototype.getAsDataURL&&!e.FileReader||!u),f=!!File&&!!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),o=n.ua.safari&&n.ua.windows,{html5:i,dragdrop:function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),jpgresize:a,pngresize:a,multipart:a||!!e.FileReader||!!e.FormData,canSendBinary:u,cantSendBlobInFormData:!!(n.ua.gecko&&e.FormData&&e.FileReader&&!FileReader.prototype.readAsArrayBuffer)||n.ua.android,progress:s,chunks:f,multi_selection:!n.ua.safari||!n.ua.windows,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,i){function f(e){var t,i,o=[],u,a={};for(i=0;i<e.length;i++){t=e[i];if(a[t.name]&&n.ua.safari&&n.ua.windows)continue;a[t.name]=!0,u=n.guid(),s[u]=t,o.push(new n.File(u,t.fileName||t.name,t.fileSize||t.size))}o.length&&r.trigger("FilesAdded",o)}var u,a;u=this.getFeatures();if(!u.html5){i({success:!1});return}r.bind("Init",function(e){var i,s,o=[],u,a,l=e.settings.filters,c,h,p=t.body,d;i=t.createElement("div"),i.id=e.id+"_html5_container",n.extend(i.style,{position:"absolute",background:r.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:r.settings.shim_bgcolor?"":0}),i.className="plupload html5",r.settings.container&&(p=t.getElementById(r.settings.container),n.getStyle(p,"position")==="static"&&(p.style.position="relative")),p.appendChild(i);e:for(u=0;u<l.length;u++){c=l[u].extensions.split(/,/);for(a=0;a<c.length;a++){if(c[a]==="*"){o=[];break e}h=n.mimeTypes[c[a]],h&&n.inArray(h,o)===-1&&o.push(h)}}i.innerHTML='<input id="'+r.id+'_html5" '+' style="font-size:999px"'+' type="file" accept="'+o.join(",")+'" '+(r.settings.multi_selection&&r.features.multi_selection?'multiple="multiple"':"")+" />",i.scrollTop=100,d=t.getElementById(r.id+"_html5"),e.features.triggerDialog?n.extend(d.style,{position:"absolute",width:"100%",height:"100%"}):n.extend(d.style,{cssFloat:"right",styleFloat:"right"}),d.onchange=function y(){f(this.files);if(!n.ua.ie)this.value="";else{var e=this.cloneNode(!0);this.parentNode.replaceChild(e,this),e.onchange=y,e=null}},s=t.getElementById(e.settings.browse_button);if(s){var v=e.settings.browse_button_hover,m=e.settings.browse_button_active,g=e.features.triggerDialog?s:i;v&&(n.addEvent(g,"mouseover",function(){n.addClass(s,v)},e.id),n.addEvent(g,"mouseout",function(){n.removeClass(s,v)},e.id)),m&&(n.addEvent(g,"mousedown",function(){n.addClass(s,m)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(s,m)},e.id)),e.features.triggerDialog&&n.addEvent(s,"click",function(n){var r=t.getElementById(e.id+"_html5");r&&!r.disabled&&r.click(),n.preventDefault()},e.id)}}),r.bind("PostInit",function(){var e=t.getElementById(r.settings.drop_element);if(e){if(o){n.addEvent(e,"dragenter",function(i){var s,o,u;s=t.getElementById(r.id+"_drop"),s||(s=t.createElement("input"),s.setAttribute("type","file"),s.setAttribute("id",r.id+"_drop"),s.setAttribute("multiple","multiple"),n.addEvent(s,"change",function(){f(this.files),n.removeEvent(s,"change",r.id),s.parentNode.removeChild(s)},r.id),n.addEvent(s,"dragover",function(e){e.stopPropagation()},r.id),e.appendChild(s)),o=n.getPos(e,t.getElementById(r.settings.container)),u=n.getSize(e),n.getStyle(e,"position")==="static"&&n.extend(e.style,{position:"relative"}),n.extend(s.style,{position:"absolute",display:"block",top:0,left:0,width:u.w+"px",height:u.h+"px",opacity:0})},r.id);return}n.addEvent(e,"dragover",function(e){e.preventDefault()},r.id),n.addEvent(e,"drop",function(e){var t=e.dataTransfer;t&&t.files&&f(t.files),e.preventDefault()},r.id)}}),r.bind("Refresh",function(e){var i,s,o,u,a;i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(e.settings.container)),o=n.getSize(i),u=t.getElementById(r.id+"_html5_container"),n.extend(u.style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}),r.features.triggerDialog&&(n.getStyle(i,"position")==="static"&&n.extend(i.style,{position:"relative"}),a=parseInt(n.getStyle(i,"zIndex"),10),isNaN(a)&&(a=0),n.extend(i.style,{zIndex:a}),n.extend(u.style,{zIndex:a-1})))}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById(e.id+"_html5");r&&(r.disabled=n)}),r.bind("CancelUpload",function(){a&&a.abort&&a.abort()}),r.bind("UploadFile",function(t,r){function l(e,t,n){var r;if(!File.prototype.slice)return(r=File.prototype.webkitSlice||File.prototype.mozSlice)?r.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(i){return e.slice(t,n-t)}}function p(s){function c(){function w(e){if(a.sendAsBinary)a.sendAsBinary(e);else if(t.features.canSendBinary){var n=new Uint8Array(e.length);for(var r=0;r<e.length;r++)n[r]=e.charCodeAt(r)&255;a.send(n.buffer)}}function E(i){var s=0,l="----pluploadboundary"+n.guid(),p,E="--",S="\r\n",x="";a=new XMLHttpRequest;if(a.upload){var T=0;a.upload.onprogress=function(e){T=e.loaded,f+T-s<r.size&&(r.loaded=Math.min(r.size,f+e.loaded-s),t.trigger("UploadProgress",r))}}a.onloadend=function(){a.readyState==4&&a.status==200&&t.state!==n.STOPPED&&(r.loaded=r.size,t.trigger("UploadProgress",t))},a.onreadystatechange=function(){var e,s;if(a.readyState==4&&t.state!==n.STOPPED){try{e=a.status}catch(u){e=0}if(e>=400)t.trigger("Error",{code:n.HTTP_ERROR,message:n.translate("HTTP Error."),file:r,status:e});else{if(d){s={chunk:o,chunks:d,response:a.responseText,status:e},t.trigger("ChunkUploaded",r,s),f+=g;if(s.cancelled){r.status=n.FAILED;return}r.loaded=Math.min(r.size,(o+1)*m)}else r.loaded=r.size;t.trigger("UploadProgress",r),i=h=p=x=null,!d||++o>=d?(r.status=n.DONE,t.trigger("FileUploaded",r,{response:a.responseText,status:e})):c()}}};if(t.settings.multipart&&u.multipart){v.name=r.target_name||r.name,a.open("post",b,!0),n.each(t.settings.headers,function(e,t){a.setRequestHeader(t,e)});if(typeof i!="string"&&!!e.FormData){p=new FormData,n.each(n.extend(v,t.settings.multipart_params),function(e,t){p.append(t,e)}),p.append(t.settings.file_data_name,i),a.send(p);return}if(typeof i=="string"){a.setRequestHeader("Content-Type","multipart/form-data; boundary="+l),n.each(n.extend(v,t.settings.multipart_params),function(e,t){x+=E+l+S+'Content-Disposition: form-data; name="'+t+'"'+S+S,x+=unescape(encodeURIComponent(e))+S}),y=n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",x+=E+l+S+'Content-Disposition: form-data; name="'+t.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(r.name))+'"'+S+"Content-Type: "+y+S+S+i+S+E+l+E+S,s=x.length-i.length,i=x,w(i);return}}b=n.buildUrl(t.settings.url,n.extend(v,t.settings.multipart_params)),a.open("post",b,!0),a.setRequestHeader("Content-Type","application/octet-stream"),n.each(t.settings.headers,function(e,t){a.setRequestHeader(t,e)}),typeof i=="string"?w(i):a.send(i)}var h,p,d,v,m,g,y,b=t.settings.url;if(r.status==n.DONE||r.status==n.FAILED||t.state==n.STOPPED)return;v={name:r.target_name||r.name},i.chunk_size&&r.size>i.chunk_size&&(u.chunks||typeof s=="string")?(m=i.chunk_size,d=Math.ceil(r.size/m),g=Math.min(m,r.size-o*m),typeof s=="string"?h=s.substring(o*m,o*m+g):h=l(s,o*m,o*m+g),v.chunk=o,v.chunks=d):(g=r.size,h=s),t.settings.multipart&&u.multipart&&typeof h!="string"&&e.FileReader&&u.cantSendBlobInFormData&&u.chunks&&t.settings.chunk_size?function(){var e=new FileReader;e.onload=function(){E(e.result),e=null},e.readAsBinaryString(h)}():E(h)}var o=0,f=0;c()}var i=t.settings,o,f;o=s[r.id],u.jpgresize&&t.settings.resize&&/\.(png|jpg|jpeg)$/i.test(r.name)?h.call(t,r,t.settings.resize,/\.png$/i.test(r.name)?"image/png":"image/jpeg",function(e){e.success?(r.size=e.data.length,p(e.data)):u.chunks?p(o):c(o,p)}):!u.chunks&&u.jpgresize?c(o,p):p(o)}),r.bind("Destroy",function(e){var r,i,s=t.body,o={inputContainer:e.id+"_html5_container",inputFile:e.id+"_html5",browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(r in o)i=t.getElementById(o[r]),i&&n.removeAllEvents(i,e.id);n.removeAllEvents(t.body,e.id),e.settings.container&&(s=t.getElementById(e.settings.container)),s.removeChild(t.getElementById(o.inputContainer))}),i({success:!0})}})}(window,document,plupload),define("plupload.html5",function(){}),function(e,t,n,r){function i(e){return t.getElementById(e)}n.runtimes.Html4=n.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,s){r.bind("Init",function(s){function w(){var e,u,a,f;c=n.guid(),h.push(c),e=t.createElement("form"),e.setAttribute("id","form_"+c),e.setAttribute("method","post"),e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.setAttribute("target",s.id+"_iframe"),e.style.position="absolute",u=t.createElement("input"),u.setAttribute("id","input_"+c),u.setAttribute("type","file"),u.setAttribute("accept",d),u.setAttribute("size",1),f=i(s.settings.browse_button),s.features.triggerDialog&&f&&n.addEvent(i(s.settings.browse_button),"click",function(e){u.disabled||u.click(),e.preventDefault()},s.id),n.extend(u.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"}),n.extend(e.style,{overflow:"hidden"}),a=s.settings.shim_bgcolor,a&&(e.style.background=a),p&&n.extend(u.style,{filter:"alpha(opacity=0)"}),n.addEvent(u,"change",function(t){var o=t.target,a,l=[],h;o.value&&(i("form_"+c).style.top="-1048575px",a=o.value.replace(/\\/g,"/"),a=a.substring(a.length,a.lastIndexOf("/")+1),l.push(new n.File(c,a)),s.features.triggerDialog?n.removeEvent(f,"click",s.id):n.removeAllEvents(e,s.id),n.removeEvent(u,"change",s.id),w(),l.length&&r.trigger("FilesAdded",l))},s.id),e.appendChild(u),o.appendChild(e),s.refresh()}function E(){var r=t.createElement("div");r.innerHTML='<iframe id="'+s.id+'_iframe" name="'+s.id+'_iframe" src="'+a+':&quot;&quot;" style="display:none"></iframe>',u=r.firstChild,o.appendChild(u),n.addEvent(u,"load",function(t){var r=t.target,i,o;if(!f)return;try{i=r.contentWindow.document||r.contentDocument||e.frames[r.id].document}catch(u){s.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),file:f});return}o=i.documentElement.innerText||i.documentElement.textContent,o&&(f.status=n.DONE,f.loaded=1025,f.percent=100,s.trigger("UploadProgress",f),s.trigger("FileUploaded",f,{response:o}))},s.id)}var o=t.body,u,a="javascript",f,l,c,h=[],p=/MSIE/.test(navigator.userAgent),d=[],v=s.settings.filters,m,g,y,b;e:for(m=0;m<v.length;m++){g=v[m].extensions.split(/,/);for(b=0;b<g.length;b++){if(g[b]==="*"){d=[];break e}y=n.mimeTypes[g[b]],y&&n.inArray(y,d)===-1&&d.push(y)}}d=d.join(","),s.settings.container&&(o=i(s.settings.container),n.getStyle(o,"position")==="static"&&(o.style.position="relative")),s.bind("UploadFile",function(e,r){var s,o;if(r.status==n.DONE||r.status==n.FAILED||e.state==n.STOPPED)return;s=i("form_"+r.id),o=i("input_"+r.id),o.setAttribute("name",e.settings.file_data_name),s.setAttribute("action",e.settings.url),n.each(n.extend({name:r.target_name||r.name},e.settings.multipart_params),function(e,r){var i=t.createElement("input");n.extend(i,{type:"hidden",name:r,value:e}),s.insertBefore(i,s.firstChild)}),f=r,i("form_"+c).style.top="-1048575px",s.submit()}),s.bind("FileUploaded",function(e){e.refresh()}),s.bind("StateChanged",function(t){t.state==n.STARTED?E():t.state==n.STOPPED&&e.setTimeout(function(){n.removeEvent(u,"load",t.id),u.parentNode&&u.parentNode.removeChild(u)},0),n.each(t.files,function(e,t){if(e.status===n.DONE||e.status===n.FAILED){var r=i("form_"+e.id);r&&r.parentNode.removeChild(r)}})}),s.bind("Refresh",function(e){var r,s,o,u,a,f,l,h,p;r=i(e.settings.browse_button),r&&(a=n.getPos(r,i(e.settings.container)),f=n.getSize(r),l=i("form_"+c),h=i("input_"+c),n.extend(l.style,{top:a.y+"px",left:a.x+"px",width:f.w+"px",height:f.h+"px"}),e.features.triggerDialog&&(n.getStyle(r,"position")==="static"&&n.extend(r.style,{position:"relative"}),p=parseInt(r.style.zIndex,10),isNaN(p)&&(p=0),n.extend(r.style,{zIndex:p}),n.extend(l.style,{zIndex:p-1})),o=e.settings.browse_button_hover,u=e.settings.browse_button_active,s=e.features.triggerDialog?r:l,o&&(n.addEvent(s,"mouseover",function(){n.addClass(r,o)},e.id),n.addEvent(s,"mouseout",function(){n.removeClass(r,o)},e.id)),u&&(n.addEvent(s,"mousedown",function(){n.addClass(r,u)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(r,u)},e.id)))}),r.bind("FilesRemoved",function(e,t){var n,r;for(n=0;n<t.length;n++)r=i("form_"+t[n].id),r&&r.parentNode.removeChild(r)}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById("input_"+c);r&&(r.disabled=n)}),r.bind("Destroy",function(e){var r,s,o,u={inputContainer:"form_"+c,inputFile:"input_"+c,browseButton:e.settings.browse_button};for(r in u)s=i(u[r]),s&&n.removeAllEvents(s,e.id);n.removeAllEvents(t.body,e.id),n.each(h,function(e,t){o=i("form_"+e),o&&o.parentNode.removeChild(o)})}),w()}),s({success:!0})}})}(window,document,plupload),define("plupload.html4",function(){}),function(e,t,n,r){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}var i={},s={};n.flash={trigger:function(e,t,n){setTimeout(function(){var r=i[e],s,o;r&&r.trigger("Flash:"+t,n)},0)}},n.runtimes.Flash=n.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(e,r){function c(){return t.getElementById(e.id+"_flash")}function h(){if(f++>5e3){r({success:!1});return}s[e.id]===!1&&setTimeout(h,1)}var u,a,f=0,l=t.body;if(o()<10){r({success:!1});return}s[e.id]=!1,i[e.id]=e,u=t.getElementById(e.settings.browse_button),a=t.createElement("div"),a.id=e.id+"_flash_container",n.extend(a.style,{position:"absolute",top:"0px",background:e.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),a.className="plupload flash",e.settings.container&&(l=t.getElementById(e.settings.container),n.getStyle(l,"position")==="static"&&(l.style.position="relative")),l.appendChild(a),function(){var r,i;r='<object id="'+e.id+'_flash" type="application/x-shockwave-flash" data="'+e.settings.flash_swf_url+'" ',n.ua.ie&&(r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+e.settings.flash_swf_url+'" />'+'<param name="flashvars" value="id='+escape(e.id)+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>",n.ua.ie?(i=t.createElement("div"),a.appendChild(i),i.outerHTML=r,i=null):a.innerHTML=r}(),h(),u=a=null,e.bind("Destroy",function(e){var r;n.removeAllEvents(t.body,e.id),delete s[e.id],delete i[e.id],r=t.getElementById(e.id+"_flash_container"),r&&r.parentNode.removeChild(r)}),e.bind("Flash:Init",function(){var i={},o;try{c().setFileFilters(e.settings.filters,e.settings.multi_selection)}catch(u){r({success:!1});return}if(s[e.id])return;s[e.id]=!0,e.bind("UploadFile",function(t,r){var s=t.settings,o=e.settings.resize||{};c().uploadFile(i[r.id],s.url,{name:r.target_name||r.name,mime:n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:s.chunk_size,width:o.width,height:o.height,quality:o.quality,multipart:s.multipart,multipart_params:s.multipart_params||{},file_data_name:s.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:s.headers,urlstream_upload:s.urlstream_upload})}),e.bind("CancelUpload",function(){c().cancelUpload()}),e.bind("Flash:UploadProcess",function(e,t){var r=e.getFile(i[t.id]);r!=null&&r!=undefined&&r.status!=n.FAILED&&(r.size=t.size,t.loaded<t.size&&(r.loaded=t.loaded,e.trigger("UploadProgress",r)))}),e.bind("Flash:UploadChunkComplete",function(e,t){var r,s=e.getFile(i[t.id]);r={chunk:t.chunk,chunks:t.chunks,response:t.text},e.trigger("ChunkUploaded",s,r),s.status!==n.FAILED&&e.state!==n.STOPPED&&c().uploadNextChunk(),t.chunk==t.chunks-1&&(s.status=n.DONE,e.trigger("FileUploaded",s,{response:t.text}),s.loaded==s.size&&e.trigger("UploadProgress",s))}),e.bind("Flash:SelectFiles",function(t,r){var s,o,u=[],a;for(o=0;o<r.length;o++)s=r[o],a=n.guid(),i[a]=s.id,i[s.id]=a,u.push(new n.File(a,s.name,s.size));u.length&&e.trigger("FilesAdded",u)}),e.bind("Flash:SecurityError",function(t,r){e.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:GenericError",function(t,r){e.trigger("Error",{code:n.GENERIC_ERROR,message:n.translate("Generic error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:IOError",function(t,r){e.trigger("Error",{code:n.IO_ERROR,message:n.translate("IO error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:ImageError",function(t,r){e.trigger("Error",{code:parseInt(r.code,10),message:n.translate("Image error."),file:e.getFile(i[r.id])})}),e.bind("Flash:StageEvent:rollOver",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.addClass(i,s)}),e.bind("Flash:StageEvent:rollOut",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.removeClass(i,s)}),e.bind("Flash:StageEvent:mouseDown",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&(n.addClass(i,s),n.addEvent(t.body,"mouseup",function(){n.removeClass(i,s)},r.id))}),e.bind("Flash:StageEvent:mouseUp",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&n.removeClass(i,s)}),e.bind("Flash:ExifData",function(t,n){e.trigger("ExifData",e.getFile(i[n.id]),n.data)}),e.bind("Flash:GpsData",function(t,n){e.trigger("GpsData",e.getFile(i[n.id]),n.data)}),e.bind("QueueChanged",function(t){e.refresh()}),e.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)c().removeFile(i[t[n].id])}),e.bind("StateChanged",function(t){e.refresh()}),e.bind("Refresh",function(r){var i,s,o;c().setFileFilters(e.settings.filters,e.settings.multi_selection),i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(r.settings.container)),o=n.getSize(i),n.extend(t.getElementById(r.id+"_flash_container").style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}))}),e.bind("DisableBrowse",function(e,t){c().disableBrowse(t)}),r({success:!0})})}})}(window,document,plupload),define("plupload.flash",function(){}),function(e){e.fn.ezMark=function(t){t=t||{};var n={checkboxCls:t.checkboxCls||"ez-checkbox",radioCls:t.radioCls||"ez-radio",checkedCls:t.checkedCls||"ez-checked",selectedCls:t.selectedCls||"ez-selected",hideCls:"ez-hide"};return this.each(function(){var t=e(this),r=t.attr("type")=="checkbox"?'<div class="'+n.checkboxCls+'">':'<div class="'+n.radioCls+'">';t.attr("type")=="checkbox"?(t.addClass(n.hideCls).wrap(r).change(function(){e(this).is(":checked")?e(this).parent().addClass(n.checkedCls):e(this).parent().removeClass(n.checkedCls)}),t.is(":checked")&&t.parent().addClass(n.checkedCls)):t.attr("type")=="radio"&&(t.addClass(n.hideCls).wrap(r).change(function(){e('input[name="'+e(this).attr("name")+'"]').each(function(){e(this).is(":checked")?e(this).parent().addClass(n.selectedCls):e(this).parent().removeClass(n.selectedCls)})}),t.is(":checked")&&t.parent().addClass(n.selectedCls)),e(this).is(":disabled")&&e(this).parent().addClass("disabled"),e(this).hasClass("locked")&&e(this).parent().addClass("locked")})}}(jQuery),define("ezmark",function(){}),function(){if(jQuery&&jQuery.jstree)return;var e=!1,t=!1,n=!1;(function(r){r.vakata={},r.vakata.css={get_css:function(e,t,n){e=e.toLowerCase();var r=n.cssRules||n.rules,i=0;do{if(r.length&&i>r.length+5)return!1;if(r[i].selectorText&&r[i].selectorText.toLowerCase()==e)return t===!0?(n.removeRule&&n.removeRule(i),n.deleteRule&&n.deleteRule(i),!0):r[i]}while(r[++i]);return!1},add_css:function(e,t){return r.jstree.css.get_css(e,!1,t)?!1:(t.insertRule?t.insertRule(e+" { }",0):t.addRule(e,null,0),r.vakata.css.get_css(e))},remove_css:function(e,t){return r.vakata.css.get_css(e,!0,t)},add_sheet:function(e){var t=!1,n=!0;if(e.str)return e.title&&(t=r("style[id='"+e.title+"-stylesheet']")[0]),t?n=!1:(t=document.createElement("style"),t.setAttribute("type","text/css"),e.title&&t.setAttribute("id",e.title+"-stylesheet")),t.styleSheet?n?(document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet.cssText=e.str):t.styleSheet.cssText=t.styleSheet.cssText+" "+e.str:(t.appendChild(document.createTextNode(e.str)),document.getElementsByTagName("head")[0].appendChild(t)),t.sheet||t.styleSheet;if(e.url)return""}};var i=[],s=-1,o={},u={};r.fn.jstree=function(e){var t=typeof e=="string",n=Array.prototype.slice.call(arguments,1),s=this;if(t){if(e.substring(0,1)=="_")return s;this.each(function(){var t=i[r.data(this,"jstree_instance_id")],o=t&&r.isFunction(t[e])?t[e].apply(t,n):t;if(typeof o!="undefined"&&(e.indexOf("is_")===0||o!==!0&&o!==!1))return s=o,!1})}else this.each(function(){var t=r.data(this,"jstree_instance_id"),s=[],u=e?r.extend({},!0,e):{},a=r(this),f=!1,l=[];s=s.concat(n),a.data("jstree")&&s.push(a.data("jstree")),u=s.length?r.extend.apply(null,[!0,u].concat(s)):u,typeof t!="undefined"&&i[t]&&i[t].destroy(),t=parseInt(i.push({}),10)-1,r.data(this,"jstree_instance_id",t),u.plugins=r.isArray(u.plugins)?u.plugins:r.jstree.defaults.plugins.slice(),u.plugins.unshift("core"),u.plugins=u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),f=r.extend(!0,{},r.jstree.defaults,u),f.plugins=u.plugins,r.each(o,function(e,t){r.inArray(e,f.plugins)===-1?(f[e]=null,delete f[e]):l.push(e)}),f.plugins=l,i[t]=new r.jstree._instance(t,r(this).addClass("jstree jstree-"+t),f),r.each(i[t]._get_settings().plugins,function(e,n){i[t].data[n]={}}),r.each(i[t]._get_settings().plugins,function(e,n){o[n]&&o[n].__init.apply(i[t])}),setTimeout(function(){i[t]&&i[t].init()},0)});return s},r.jstree={defaults:{plugins:[]},_focused:function(){return i[s]||null},_reference:function(e){if(i[e])return i[e];var t=r(e);return!t.length&&typeof e=="string"&&(t=r("#"+e)),t.length?i[t.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(e,t,n){this.data={core:{}},this.get_settings=function(){return r.extend(!0,{},n)},this._get_settings=function(){return n},this.get_index=function(){return e},this.get_container=function(){return t},this.get_container_ul=function(){return t.children("ul:eq(0)")},this._set_settings=function(e){n=r.extend(!0,{},n,e)}},_fn:{},plugin:function(e,t){t=r.extend({},{__init:r.noop,__destroy:r.noop,_fn:{},defaults:!1},t),o[e]=t,r.jstree.defaults[e]=t.defaults,r.each(t._fn,function(t,n){n.plugin=e,n.old=r.jstree._fn[t],r.jstree._fn[t]=function(){var e,i=n,s=Array.prototype.slice.call(arguments),o=new r.Event("before.jstree"),u=!1;if(this.data.core.locked===!0&&t!=="unlock"&&t!=="is_locked")return;do{if(i&&i.plugin&&r.inArray(i.plugin,this._get_settings().plugins)!==-1)break;i=i.old}while(i);if(!i)return;if(t.indexOf("_")===0)e=i.apply(this,s);else{e=this.get_container().triggerHandler(o,{func:t,inst:this,args:s,plugin:i.plugin});if(e===!1)return;typeof e!="undefined"&&(s=e),e=i.apply(r.extend({},this,{__callback:function(e){this.get_container().triggerHandler(t+".jstree",{inst:this,args:s,rslt:e,rlbk:u})},__rollback:function(){return u=this.get_rollback(),u},__call_old:function(e){return i.old.apply(this,e?Array.prototype.slice.call(arguments,1):s)}}),s)}return e},r.jstree._fn[t].old=n.old,r.jstree._fn[t].plugin=e})},rollback:function(e){e&&(r.isArray(e)||(e=[e]),r.each(e,function(e,t){i[t.i].set_rollback(t.h,t.d)}))}},r.jstree._fn=r.jstree._instance.prototype={},r(function(){var i=navigator.userAgent.toLowerCase(),s=(i.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],o=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(i)&&parseInt(s,10)==6){e=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(u){}o+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(i)&&parseInt(s,10)==7&&(t=!0,o+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(i)&&/mozilla/.test(i)&&parseFloat(s,10)<1.9&&(n=!0,o+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),r.vakata.css.add_sheet({str:o,title:"jstree"})}),r.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",r.proxy(function(e){var t=r(e.target);this.toggle_node(t)},this)).bind("mousedown.jstree",r.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(e){var t;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(n){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li").each(function(){var e=r(this);e.data("jstree")&&r.each(e.data("jstree"),function(t,n){i.data[t]&&r.isFunction(i["_"+t+"_notify"])&&i["_"+t+"_notify"].call(i,e,n)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li.jstree-open:not(:has(ul))").each(function(){i.load_node(this,r.noop,r.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var e,t=this.get_index(),n=this._get_settings(),u=this;r.each(n.plugins,function(e,t){try{o[t].__destroy.apply(u)}catch(n){}}),this.__callback();if(this.is_focused())for(e in i)if(i.hasOwnProperty(e)&&e!=t){i[e].set_focus();break}t===s&&(s=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),r(document).unbind(".jstree-"+t).undelegate(".jstree-"+t),i[t]=null,delete i[t]},_core_notify:function(e,t){t.opened&&this.open_node(e,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var e=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&e.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(e.data.core.to_open)},save_loaded:function(){},reload_nodes:function(e){var t=this,n=!0,i=[],s=[];e||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=r.map(r.makeArray(this.data.core.to_open),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=r.map(r.makeArray(this.data.core.to_load),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&(r.each(this.data.core.to_load,function(e,t){if(t=="#")return!0;r(t).length?i.push(t):s.push(t)}),i.length&&(this.data.core.to_load=s,r.each(i,function(e,r){t._is_loaded(r)||(t.load_node(r,function(){t.reload_nodes(!0)},function(){t.reload_nodes(!0)}),n=!1)}))),this.data.core.to_open.length&&r.each(this.data.core.to_open,function(e,n){t.open_node(n,!1,!0)}),n&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){t.__callback({},t)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var e=this;this.data.core.to_open.length&&r.each(this.data.core.to_open,function(t,n){e.open_node(n,!1,!0)}),this.__callback({})},refresh:function(e){var t=this;this.save_opened(),e||(e=-1),e=this._get_node(e),e||(e=-1),e!==-1?e.children("UL").remove():this.get_container_ul().empty(),this.load_node(e,function(){t.__callback({obj:e}),t.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused())return;var e=r.jstree._focused();e&&e.unset_focus(),this.get_container().addClass("jstree-focused"),s=this.get_index(),this.__callback()},is_focused:function(){return s==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),s=-1),this.__callback()},_get_node:function(e){var t=r(e,this.get_container());return t.is(".jstree")||e==-1?-1:(t=t.closest("li",this.get_container()),t.length?t:!1)},_get_next:function(e,t){return e=this._get_node(e),e===-1?this.get_container().find("> ul > li:first-child"):e.length?t?e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):!1:e.hasClass("jstree-open")?e.find("li:eq(0)"):e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):e.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(e,t){e=this._get_node(e);if(e===-1)return this.get_container().find("> ul > li:last-child");if(!e.length)return!1;if(t)return e.prevAll("li").length>0?e.prevAll("li:eq(0)"):!1;if(e.prev("li").length){e=e.prev("li").eq(0);while(e.hasClass("jstree-open"))e=e.children("ul:eq(0)").children("li:last");return e}var n=e.parentsUntil(".jstree","li:eq(0)");return n.length?n:!1},_get_parent:function(e){e=this._get_node(e);if(e==-1||!e.length)return!1;var t=e.parentsUntil(".jstree","li:eq(0)");return t.length?t:-1},_get_children:function(e){return e=this._get_node(e),e===-1?this.get_container().children("ul:eq(0)").children("li"):e.length?e.children("ul:eq(0)").children("li"):!1},get_path:function(e,t){var n=[],r=this;return e=this._get_node(e),e===-1||!e||!e.length?!1:(e.parentsUntil(".jstree","li").each(function(){n.push(t?this.id:r.get_text(this))}),n.reverse(),n.push(t?e.attr("id"):this.get_text(e)),n)},_get_string:function(e){return this._get_settings().core.strings[e]||e},is_open:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-open")},is_closed:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-closed")},is_leaf:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-leaf")},correct_state:function(e){e=this._get_node(e);if(!e||e===-1)return!1;e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},open_node:function(t,n,r){t=this._get_node(t);if(!t.length)return!1;if(!t.hasClass("jstree-closed"))return n&&n.call(),!1;var i=r||e?0:this._get_settings().core.animation,s=this;this._is_loaded(t)?(this._get_settings().core.open_parents&&t.parentsUntil(".jstree",".jstree-closed").each(function(){s.open_node(this,!1,!0)}),i&&t.children("ul").css("display","none"),t.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),i?t.children("ul").stop(!0,!0).slideDown(i,function(){this.style.display="",s.after_open(t)}):s.after_open(t),this.__callback({obj:t}),n&&n.call()):(t.children("a").addClass("jstree-loading"),this.load_node(t,function(){s.open_node(t,n,r)},n))},after_open:function(e){this.__callback({obj:e})},close_node:function(t,n){t=this._get_node(t);var r=n||e?0:this._get_settings().core.animation,i=this;if(!t.length||!t.hasClass("jstree-open"))return!1;r&&t.children("ul").attr("style","display:block !important"),t.removeClass("jstree-open").addClass("jstree-closed"),r?t.children("ul").stop(!0,!0).slideUp(r,function(){this.style.display="",i.after_close(t)}):i.after_close(t),this.__callback({obj:t})},after_close:function(e){this.__callback({obj:e})},toggle_node:function(e){e=this._get_node(e);if(e.hasClass("jstree-closed"))return this.open_node(e);if(e.hasClass("jstree-open"))return this.close_node(e)},open_all:function(e,t,n){e=e?this._get_node(e):-1;if(!e||e===-1)e=this.get_container_ul();n?e=e.find("li.jstree-closed"):(n=e,e.is(".jstree-closed")?e=e.find("li.jstree-closed").andSelf():e=e.find("li.jstree-closed"));var r=this;e.each(function(){var e=this;r._is_loaded(this)?r.open_node(this,!1,!t):r.open_node(this,function(){r.open_all(e,t,n)},!t)}),n.find("li.jstree-closed").length===0&&this.__callback({obj:n})},close_all:function(e,t){var n=this;e=e?this._get_node(e):this.get_container();if(!e||e===-1)e=this.get_container_ul();e.find("li.jstree-open").andSelf().each(function(){n.close_node(this,!t)}),this.__callback({obj:e})},clean_node:function(e){e=e&&e!=-1?r(e):this.get_container_ul(),e=e.is("li")?e.find("li").andSelf():e.find("li"),e.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),e.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(e,t){this.get_container().empty().append(e),this.data=t,this.__callback()},load_node:function(e,t,n){this.__callback({obj:e})},_is_loaded:function(e){return!0},create_node:function(e,t,n,i,s){e=this._get_node(e),t=typeof t=="undefined"?"last":t;var o=r("<li />"),u=this._get_settings().core,a;if(e!==-1&&!e.length)return!1;if(!s&&!this._is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,n,i,!0)}),!1;this.__rollback(),typeof n=="string"&&(n={data:n}),n||(n={}),n.attr&&o.attr(n.attr),n.metadata&&o.data(n.metadata),n.state&&o.addClass("jstree-"+n.state),n.data||(n.data=this._get_string("new_node")),r.isArray(n.data)||(a=n.data,n.data=[],n.data.push(a)),r.each(n.data,function(e,t){a=r("<a />"),r.isFunction(t)&&(t=t.call(this,n)),typeof t=="string"?a.attr("href","#")[u.html_titles?"html":"text"](t):(t.attr||(t.attr={}),t.attr.href||(t.attr.href="#"),a.attr(t.attr)[u.html_titles?"html":"text"](t.title),t.language&&a.addClass(t.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!t.icon&&n.icon&&(t.icon=n.icon),t.icon&&(t.icon.indexOf("/")===-1?a.children("ins").addClass(t.icon):a.children("ins").css("background","url('"+t.icon+"') center center no-repeat")),o.append(a)}),o.prepend("<ins class='jstree-icon'>&#160;</ins>"),e===-1&&(e=this.get_container(),t==="before"&&(t="first"),t==="after"&&(t="last"));switch(t){case"before":e.before(o),a=this._get_parent(e);break;case"after":e.after(o),a=this._get_parent(e);break;case"inside":case"first":e.children("ul").length||e.append("<ul />"),e.children("ul").prepend(o),a=e;break;case"last":e.children("ul").length||e.append("<ul />"),e.children("ul").append(o),a=e;break;default:e.children("ul").length||e.append("<ul />"),t||(t=0),a=e.children("ul").children("li").eq(t),a.length?a.before(o):e.children("ul").append(o),a=e}if(a===-1||a.get(0)===this.get_container().get(0))a=-1;return this.clean_node(a),this.__callback({obj:o,parent:a}),i&&i.call(this,o),o},get_text:function(e){e=this._get_node(e);if(!e.length)return!1;var t=this._get_settings().core.html_titles;return e=e.children("a:eq(0)"),t?(e=e.clone(),e.children("INS").remove(),e.html()):(e=e.contents().filter(function(){return this.nodeType==3})[0],e.nodeValue)},set_text:function(e,t){e=this._get_node(e);if(!e.length)return!1;e=e.children("a:eq(0)");if(this._get_settings().core.html_titles){var n=e.children("INS").clone();return e.html(t).prepend(n),this.__callback({obj:e,name:t}),!0}return e=e.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:e,name:t}),e.nodeValue=t},rename_node:function(e,t){e=this._get_node(e),this.__rollback(),e&&e.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:e,name:t})},delete_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.__rollback();var t=this._get_parent(e),n=r([]),i=this;return e.each(function(){n=n.add(i._get_prev(this))}),e=e.detach(),t!==-1&&t.find("> ul > li").length===0&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(t),this.__callback({obj:e,prev:n,parent:t}),e},prepare_move:function(e,t,n,i,s){var o={};o.ot=r.jstree._reference(e)||this,o.o=o.ot._get_node(e),o.r=t===-1?-1:this._get_node(t),o.p=typeof n=="undefined"||n===!1?"last":n;if(!s&&u.o&&u.o[0]===o.o[0]&&u.r[0]===o.r[0]&&u.p===o.p){this.__callback(u),i&&i.call(this,u);return}o.ot=r.jstree._reference(o.o)||this,o.rt=r.jstree._reference(o.r)||this;if(o.r===-1||!o.r){o.cr=-1;switch(o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}}else{if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(e,t,n,i,!0)});switch(o.p){case"before":o.cp=o.r.index(),o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1,o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0,o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length,o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}o.np=o.cr==-1?o.rt.get_container():o.cr,o.op=o.ot._get_parent(o.o),o.cop=o.o.index(),o.op===-1&&(o.op=o.ot?o.ot.get_container():this.get_container()),!/^(before|after)$/.test(o.p)&&o.op&&o.np&&o.op[0]===o.np[0]&&o.o.index()<o.cp&&o.cp++,o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")"),u=o,this.__callback(u),i&&i.call(this,u)},check_move:function(){var e=u,t=!0,n=e.r===-1?this.get_container():e.r;return!e||!e.o||e.or[0]===e.o[0]?!1:e.op&&e.np&&e.op[0]===e.np[0]&&e.cp-1===e.o.index()?!1:(e.o.each(function(){if(n.parentsUntil(".jstree","li").andSelf().index(this)!==-1)return t=!1,!1}),t)},move_node:function(e,t,n,i,s,o){if(!s)return this.prepare_move(e,t,n,function(e){this.move_node(e,!1,!1,i,!0,o)});i&&(u.cy=!0);if(!o&&!this.check_move())return!1;this.__rollback();var a=!1;i?(a=e.o.clone(!0),a.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):a=e.o,e.or.length?e.or.before(a):(e.np.children("ul").length||r("<ul />").appendTo(e.np),e.np.children("ul:eq(0)").append(a));try{e.ot.clean_node(e.op),e.rt.clean_node(e.np),e.op.find("> ul > li").length||e.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(f){}return i&&(u.cy=!0,u.oc=a),this.__callback(u),u},_get_move:function(){return u}}})})(jQuery),function(e){var t,n,r;e(function(){/msie/.test(navigator.userAgent.toLowerCase())?(n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),r=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),t=n.width()-r.width(),n.add(r).remove()):(n=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),t=100-n.width(),n.parent().remove())}),e.jstree.plugin("ui",{__init:function(){this.data.ui.selected=e(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",e.proxy(function(t){t.preventDefault(),t.currentTarget.blur(),e(t.currentTarget).hasClass("jstree-loading")||this.select_node(t.currentTarget,!0,t)},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.hover_node(t.target)},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.dehover_node(t.target)},this)).bind("reopen.jstree",e.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",e.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",e.proxy(function(){this.reselect()},this)).bind("close_node.jstree",e.proxy(function(t,n){var r=this._get_settings().ui,i=this._get_node(n.rslt.obj),s=i&&i.length?i.children("ul").find("a.jstree-clicked"):e(),o=this;if(r.selected_parent_close===!1||!s.length)return;s.each(function(){o.deselect_node(this),r.selected_parent_close==="select_parent"&&o.select_node(i)})},this)).bind("delete_node.jstree",e.proxy(function(e,t){var n=this._get_settings().ui.select_prev_on_delete,r=this._get_node(t.rslt.obj),i=r&&r.length?r.find("a.jstree-clicked"):[],s=this;i.each(function(){s.deselect_node(this)}),n&&i.length&&t.rslt.prev.each(function(){if(this.parentNode)return s.select_node(this),!1})},this)).bind("move_node.jstree",e.proxy(function(e,t){t.rslt.cy&&t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,n){if(typeof t=="undefined"||t===null)return n?this.data.ui.selected:this.data.ui.last_selected;var r=e(t,this.get_container());return r.is(".jstree")||t==-1?-1:(r=r.closest("li",this.get_container()),r.length?r:!1)},_ui_notify:function(e,t){t.selected&&this.select_node(e,!1)},save_selected:function(){var e=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&e.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),e.each(n,function(e,n){n&&n!=="#"&&t.select_node(n)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(e){return this.save_selected(),this.__call_old()},hover_node:function(e){e=this._get_node(e);if(!e.length)return!1;e.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=e.children("a").addClass("jstree-hovered").parent(),this._fix_scroll(e),this.__callback({obj:e})},dehover_node:function(){var e=this.data.ui.hovered,t;if(!e||!e.length)return!1;t=e.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===t[0]&&(this.data.ui.hovered=null),this.__callback({obj:e})},select_node:function(e,t,n){e=this._get_node(e);if(e==-1||!e||!e.length)return!1;var r=this._get_settings().ui,i=r.select_multiple_modifier=="on"||r.select_multiple_modifier!==!1&&n&&n[r.select_multiple_modifier+"Key"],s=r.select_range_modifier!==!1&&n&&n[r.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==e[0]&&this.data.ui.last_selected.parent()[0]===e.parent()[0],o=this.is_selected(e),u=!0,a=this;if(t){if(r.disable_selecting_children&&i&&(e.parentsUntil(".jstree","li").children("a.jstree-clicked").length||e.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;u=!1;switch(!0){case s:this.data.ui.last_selected.addClass("jstree-last-selected"),e=e[e.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf(),r.select_limit==-1||e.length<r.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==a.data.ui.last_selected[0]&&a.deselect_node(this)}),o=!1,u=!0):u=!1;break;case o&&!i:this.deselect_all(),o=!1,u=!0;break;case!o&&!i:if(r.select_limit==-1||r.select_limit>0)this.deselect_all(),u=!0;break;case o&&i:this.deselect_node(e);break;case!o&&i:if(r.select_limit==-1||this.data.ui.selected.length+1<=r.select_limit)u=!0}}u&&!o&&(s||(this.data.ui.last_selected=e),e.children("a").addClass("jstree-clicked"),r.selected_parent_open&&e.parents(".jstree-closed").each(function(){a.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(e),this._fix_scroll(e.eq(0)),this.__callback({obj:e,e:n}))},_fix_scroll:function(e){var n=this.get_container()[0],r;if(n.scrollHeight>n.offsetHeight){e=this._get_node(e);if(!e||e===-1||!e.length||!e.is(":visible"))return;r=e.offset().top-this.get_container().offset().top,r<0&&(n.scrollTop=n.scrollTop+r-1),r+this.data.core.li_height+(n.scrollWidth>n.offsetWidth?t:0)>n.offsetHeight&&(n.scrollTop=n.scrollTop+(r-n.offsetHeight+this.data.core.li_height+1+(n.scrollWidth>n.offsetWidth?t:0)))}},deselect_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)&&(e.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(e),this.data.ui.last_selected.get(0)===e.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:e}))},toggle_select:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)?this.deselect_node(e):this.select_node(e)},is_selected:function(e){return this.data.ui.selected.index(this._get_node(e))>=0},get_selected:function(t){return t?e(t).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){var n=t?e(t).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();n.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=e([]),this.data.ui.last_selected=!1,this.__callback({obj:n})}}}),e.jstree.defaults.plugins.push("ui")}(jQuery),function(e){e.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",e.proxy(function(e,t){if(this._get_settings().crrm.move.open_onmove){var n=this;t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){n.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(e){return!0}}},_fn:{_show_input:function(t,n){t=this._get_node(t);var r=this._get_settings().core.rtl,i=this._get_settings().crrm.input_width_limit,s=t.children("ins").width(),o=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,u=this.get_text(t),a=e("<div />",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),f=t.css("position","relative").append(e("<input />",{value:u,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:r?"auto":s+o+4+"px",right:r?s+o+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:e.proxy(function(){var e=t.children(".jstree-rename-input"),r=e.val();r===""&&(r=u),a.remove(),e.remove(),this.set_text(t,u),this.rename_node(t,r),n.call(this,t,r,u),t.css("position","")},this),keyup:function(e){var t=e.keyCode||e.which;if(t==27){this.value=u,this.blur();return}if(t==13){this.blur();return}f.width(Math.min(a.text("pW"+this.value).width(),i))},keypress:function(e){var t=e.keyCode||e.which;if(t==13)return!1}})).children(".jstree-rename-input");this.set_text(t,""),a.css({fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""}),f.width(Math.min(a.text("pW"+f[0].value).width(),i))[0].select()},rename:function(e){e=this._get_node(e),this.__rollback();var t=this.__callback;this._show_input(e,function(e,n,r){t.call(this,{obj:e,new_name:n,old_name:r})})},create:function(t,n,r,i,s){var o,u=this;return t=this._get_node(t),t||(t=-1),this.__rollback(),o=this.create_node(t,n,r,function(t){var n=this._get_parent(t),r=e(t).index();i&&i.call(this,t),n.length&&n.hasClass("jstree-closed")&&this.open_node(n,!1,!0),s?u.__callback({obj:t,name:this.get_text(t),parent:n,position:r}):this._show_input(t,function(e,t,i){u.__callback({obj:e,name:t,parent:n,position:r})})}),o},remove:function(e){e=this._get_node(e,!0);var t=this._get_parent(e),n=this._get_prev(e);this.__rollback(),e=this.delete_node(e),e!==!1&&this.__callback({obj:e,prev:n,parent:t})},check_move:function(){if(!this.__call_old())return!1;var e=this._get_settings().crrm.move;return e.check_move.call(this,this._get_move())?!0:!1},move_node:function(e,t,n,r,i,s){var o=this._get_settings().crrm.move;if(!i)return typeof n=="undefined"&&(n=o.default_position),n==="inside"&&!o.default_position.match(/^(before|after)$/)&&(n=o.default_position),this.__call_old(!0,e,t,n,r,!1,s);if(o.always_copy===!0||o.always_copy==="multitree"&&e.rt.get_index()!==e.ot.get_index())r=!0;this.__call_old(!0,e,t,n,r,!0,s)},cut:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=e,this.__callback({obj:e})},copy:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=e,this.__callback({obj:e})},paste:function(e){e=this._get_node(e);if(!e||!e.length)return!1;var t=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,e),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,e,!1,!0),this.__callback({obj:e,nodes:t})}}})}(jQuery),function(e){var t=[];e.jstree._themes=!1,e.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",e.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots,this.data.themes.icons=e.icons,this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",e.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(n,r){if(!n)return!1;r||(r=e.jstree._themes+n+"/style.css"),e.inArray(r,t)==-1&&(e.vakata.css.add_sheet({url:r}),t.push(r)),this.data.themes.theme!=n&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=n),this.get_container().addClass("jstree-"+n),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),e(function(){e.jstree._themes===!1&&e("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return e.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),e.jstree._themes===!1&&(e.jstree._themes="themes/")}),e.jstree.defaults.plugins.push("themes")}(jQuery),function(e){function n(t,n){var r=e.jstree._focused(),i;if(r&&r.data&&r.data.hotkeys&&r.data.hotkeys.enabled){i=r._get_settings().hotkeys[t];if(i)return i.call(r,n)}}var t=[];e.jstree.plugin("hotkeys",{__init:function(){if(typeof e.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";e.each(this._get_settings().hotkeys,function(r,i){i!==!1&&e.inArray(r,t)==-1&&(e(document).bind("keydown",r,function(e){return n(r,e)}),t.push(r))}),this.get_container().bind("lock.jstree",e.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",e.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"ctrl+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"shift+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},down:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"ctrl+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"shift+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},left:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"ctrl+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"shift+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},right:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"ctrl+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"shift+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},"shift+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(e){e.jstree.plugin("json_data",{__init:function(){var e=this._get_settings().json_data;e.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,t){t.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(e,t,n){var r=this;this.load_node_json(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().json_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!n.progressive_render&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},refresh:function(t){t=this._get_node(t);var n=this._get_settings().json_data;return t&&t!==-1&&n.progressive_unload&&(e.isFunction(n.data)||!!n.ajax)&&t.removeData("jstree_children"),this.__call_old()},load_node_json:function(t,n,r){var i=this.get_settings().json_data,s,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1&&(i.progressive_render||i.progressive_unload)&&!t.is(".jstree-open, .jstree-leaf")&&t.children("ul").children("li").length===0&&t.data("jstree_children")){s=this._parse_json(t.data("jstree_children"),t),s&&(t.append(s),i.progressive_unload||t.removeData("jstree_children")),this.clean_node(t),n&&n.call(this);return}if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(e){e=this._parse_json(e,t),e?(t===-1||!t?this.get_container().children("ul").empty().append(e.children()):(t.append(e).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):(t===-1||!t?i.correct_state&&this.get_container().children("ul").empty():(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&this.correct_state(t)),r&&r.call(this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):if(!t||t==-1)s=this._parse_json(i.data,t),s?(this.get_container().children("ul").empty().append(s.children()),this.clean_node()):i.correct_state&&this.get_container().children("ul").empty();n&&n.call(this);break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:o=function(e,n,s){var o=this.get_settings().json_data.ajax.error;o&&o.call(this,e,n,s),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,s,u){var a=this.get_settings().json_data.ajax.success;a&&(r=a.call(this,r,s,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")===""||!e.isArray(r)&&!e.isPlainObject(r))return o.call(this,u,s,"");r=this._parse_json(r,t),r?(t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.append(r).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t===-1||!t?i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this)))},i.ajax.context=this,i.ajax.error=o,i.ajax.success=u,i.ajax.dataType||(i.ajax.dataType="json"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},_parse_json:function(t,n,r){var i=!1,s=this._get_settings(),o=s.json_data,u=s.core.html_titles,a,f,l,c,h;if(!t)return i;o.progressive_unload&&n&&n!==-1&&n.data("jstree_children",i);if(e.isArray(t)){i=e();if(!t.length)return!1;for(f=0,l=t.length;f<l;f++)a=this._parse_json(t[f],n,!0),a.length&&(i=i.add(a))}else{typeof t=="string"&&(t={data:t});if(!t.data&&t.data!=="")return i;i=e("<li />"),t.attr&&i.attr(t.attr),t.metadata&&i.data(t.metadata),t.state&&i.addClass("jstree-"+t.state),e.isArray(t.data)||(a=t.data,t.data=[],t.data.push(a)),e.each(t.data,function(n,r){a=e("<a />"),e.isFunction(r)&&(r=r.call(this,t)),typeof r=="string"?a.attr("href","#")[u?"html":"text"](r):(r.attr||(r.attr={}),r.attr.href||(r.attr.href="#"),a.attr(r.attr)[u?"html":"text"](r.title),r.language&&a.addClass(r.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!r.icon&&t.icon&&(r.icon=t.icon),r.icon&&(r.icon.indexOf("/")===-1?a.children("ins").addClass(r.icon):a.children("ins").css("background","url('"+r.icon+"') center center no-repeat")),i.append(a)}),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),t.children&&(o.progressive_render&&t.state!=="open"?i.addClass("jstree-closed").data("jstree_children",t.children):(o.progressive_unload&&i.data("jstree_children",t.children),e.isArray(t.children)&&t.children.length&&(a=this._parse_json(t.children,n,!0),a.length&&(h=e("<ul />"),h.append(a),i.append(h)))))}return r||(c=e("<ul />"),c.append(i),i=c),i},get_json:function(t,n,r,i){var s=[],o=this._get_settings(),u=this,a,f,l,c,h,p;t=this._get_node(t);if(!t||t===-1)t=this.get_container().find("> ul > li");return n=e.isArray(n)?n:["id","class"],!i&&this.data.types&&n.push(o.types.type_attr),r=e.isArray(r)?r:[],t.each(function(){l=e(this),a={data:[]},n.length&&(a.attr={}),e.each(n,function(e,t){f=l.attr(t),f&&f.length&&f.replace(/jstree[^ ]*/ig,"").length&&(a.attr[t]=(" "+f).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))}),l.hasClass("jstree-open")&&(a.state="open"),l.hasClass("jstree-closed")&&(a.state="closed"),l.data()&&(a.metadata=l.data()),c=l.children("a"),c.each(function(){h=e(this),r.length||e.inArray("languages",o.plugins)!==-1||h.children("ins").get(0).style.backgroundImage.length||h.children("ins").get(0).className&&h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(p=!1,e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return p=t,!1}),f={attr:{},title:u.get_text(h,p)},e.each(r,function(e,t){f.attr[t]=(" "+(h.attr(t)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return f.language=t,!0}),h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(f.icon=h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),h.children("ins").get(0).style.backgroundImage.length&&(f.icon=h.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):f=u.get_text(h),c.length>1?a.data.push(f):a.data=f}),l=l.find("> ul > li"),l.length&&(a.children=u.get_json(l,n,r,!0)),s.push(a)}),s}}})}(jQuery),function(e){e.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var n=this._get_settings().languages,r=!1,i=".jstree-"+this.get_index()+" a";if(!e.isArray(n)||n.length===0)return!1;if(e.inArray(t,n)==-1){if(!n[t])return!1;t=n[t]}return t==this.data.languages.current_language?!0:(r=e.vakata.css.get_css(i+"."+this.data.languages.current_language,!1,this.data.languages.language_css),r!==!1&&(r.style.display="none"),r=e.vakata.css.get_css(i+"."+t,!1,this.data.languages.language_css),r!==!1&&(r.style.display=""),this.data.languages.current_language=t,this.__callback(t),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(t,n){var r=this._get_settings().languages,i=this._get_settings().core.strings;return e.isArray(r)&&r.length&&(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language),i[n]&&i[n][t]?i[n][t]:i[t]?i[t]:t},get_text:function(t,n){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var r=this._get_settings().languages,i=this._get_settings().core.html_titles;return e.isArray(r)&&r.length?(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language,t=t.children("a."+n)):t=t.children("a:eq(0)"),i?(t=t.clone(),t.children("INS").remove(),t.html()):(t=t.contents().filter(function(){return this.nodeType==3})[0],t.nodeValue)},set_text:function(t,n,r){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var i=this._get_settings().languages,s=this._get_settings().core.html_titles,o;return e.isArray(i)&&i.length?(r=r&&e.inArray(r,i)!=-1?r:this.data.languages.current_language,t=t.children("a."+r)):t=t.children("a:eq(0)"),s?(o=t.children("INS").clone(),t.html(n).prepend(o),this.__callback({obj:t,name:n,lang:r}),!0):(t=t.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:t,name:n,lang:r}),t.nodeValue=n)},_load_css:function(){var t=this._get_settings().languages,n="/* languages css */",r=".jstree-"+this.get_index()+" a",i;if(e.isArray(t)&&t.length){this.data.languages.current_language=t[0];for(i=0;i<t.length;i++)n+=r+"."+t[i]+" {",t[i]!=this.data.languages.current_language&&(n+=" display:none; "),n+=" } ";this.data.languages.language_css=e.vakata.css.add_sheet({str:n,title:"jstree-languages"})}},create_node:function(t,n,r,i){var s=this.__call_old(!0,t,n,r,function(t){var n=this._get_settings().languages,r=t.children("a"),s;if(e.isArray(n)&&n.length){for(s=0;s<n.length;s++)r.is("."+n[s])||t.append(r.eq(0).clone().removeClass(n.join(" ")).addClass(n[s]));r.not("."+n.join(", .")).remove()}i&&i.call(this,t)});return s}}})}(jQuery),function(e){e.jstree.plugin("cookies",{__init:function(){if(typeof e.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var t=this._get_settings().cookies,n;!t.save_loaded||(n=e.cookie(t.save_loaded),n&&n.length&&(this.data.core.to_load=n.split(","))),!t.save_opened||(n=e.cookie(t.save_opened),n&&n.length&&(this.data.core.to_open=n.split(","))),!t.save_selected||(n=e.cookie(t.save_selected),n&&n.length&&this.data.ui&&(this.data.ui.to_select=n.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",e.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",e.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(this.data.core.refreshing)return;var n=this._get_settings().cookies;if(!t){n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options)),n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options));return}switch(t){case"open_node":case"close_node":!n.save_opened||(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),!n.save_loaded||(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options));break;case"select_node":case"deselect_node":!!n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options))}}}})}(jQuery),function(e){e.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",e.proxy(function(e,t){var n=this._get_node(t.rslt.obj);n=n===-1?this.get_container().children("ul"):n.children("ul"),this.sort(n)},this)).bind("rename_node.jstree create_node.jstree create.jstree",e.proxy(function(e,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",e.proxy(function(e,t){var n=t.rslt.np==-1?this.get_container():t.rslt.np;this.sort(n.children("ul"))},this))},defaults:function(e,t){return this.get_text(e).toLowerCase()>this.get_text(t).toLowerCase()?1:-1},_fn:{sort:function(t){var n=this._get_settings().sort,r=this;t.append(e.makeArray(t.children("li")).sort(e.proxy(n,r))),t.find("> li > ul").each(function(){r.sort(e(this))}),this.clean_node(t)}}})}(jQuery),function(e){var t=!1,n=!1,r=!1,i=!1,s=!1,o=!1,u=!1,a=!1,f=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(t,n,r){e.vakata.dnd.is_drag&&e.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(i){}return e.vakata.dnd.init_x=t.pageX,e.vakata.dnd.init_y=t.pageY,e.vakata.dnd.user_data=n,e.vakata.dnd.is_down=!0,e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(r),e(document).bind("mousemove",e.vakata.dnd.drag),e(document).bind("mouseup",e.vakata.dnd.drag_stop),!1},drag:function(t){if(!e.vakata.dnd.is_down)return;if(!e.vakata.dnd.is_drag){if(!(Math.abs(t.pageX-e.vakata.dnd.init_x)>5||Math.abs(t.pageY-e.vakata.dnd.init_y)>5))return;e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:t,data:e.vakata.dnd.user_data})}if(t.type==="mousemove"){var n=e(document),r=n.scrollTop(),i=n.scrollLeft();t.pageY-r<20?(o&&u==="down"&&(clearInterval(o),o=!1),o||(u="up",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150))):o&&u==="up"&&(clearInterval(o),o=!1),e(window).height()-(t.pageY-r)<20?(o&&u==="up"&&(clearInterval(o),o=!1),o||(u="down",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150))):o&&u==="down"&&(clearInterval(o),o=!1),t.pageX-i<20?(s&&a==="right"&&(clearInterval(s),s=!1),s||(a="left",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150))):s&&a==="left"&&(clearInterval(s),s=!1),e(window).width()-(t.pageX-i)<20?(s&&a==="left"&&(clearInterval(s),s=!1),s||(a="right",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150))):s&&a==="right"&&(clearInterval(s),s=!1)}e.vakata.dnd.helper.css({left:t.pageX+e.vakata.dnd.helper_left+"px",top:t.pageY+e.vakata.dnd.helper_top+"px"}),e(document).triggerHandler("drag.vakata",{event:t,data:e.vakata.dnd.user_data})},drag_stop:function(t){s&&clearInterval(s),o&&clearInterval(o),e(document).unbind("mousemove",e.vakata.dnd.drag),e(document).unbind("mouseup",e.vakata.dnd.drag_stop),e(document).triggerHandler("drag_stop.vakata",{event:t,data:e.vakata.dnd.user_data}),e.vakata.dnd.helper.remove(),e.vakata.dnd.init_x=0,e.vakata.dnd.init_y=0,e.vakata.dnd.user_data={},e.vakata.dnd.is_down=!1,e.vakata.dnd.is_drag=!1}},e(function(){var t="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";e.vakata.css.add_sheet({str:t,title:"vakata"})}),e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){this.data.themes&&(r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));if(n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var s=e.jstree._reference(n.target),o;s.data.dnd.foreign?(o=s._get_settings().dnd.drag_check.call(this,{o:t,r:s.get_container(),is_root:!0}),(o===!0||o.inside===!0||o.before===!0||o.after===!0)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(s.prepare_move(t,s.get_container(),"last"),s.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}}},this)).bind("mouseup.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var r=e.jstree._reference(n.currentTarget),i;r.data.dnd.foreign?(i=r._get_settings().dnd.drag_check.call(this,{o:t,r:r.get_container(),is_root:!0}),(i===!0||i.inside===!0||i.before===!0||i.after===!0)&&r._get_settings().dnd.drag_finish.call(this,{o:t,r:r.get_container(),is_root:!0})):r.move_node(t,r.get_container(),"last",n[r._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(t){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var n=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},n),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop+=e.vakata.dnd.scroll_spd},n),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&r&&i&&(r.hide(),i.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(e){if(e.which===1)return this.start_drag(e.currentTarget,e),!1},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&((!n||!n.length||n.children("a")[0]!==t.currentTarget)&&this.dnd_enter(t.currentTarget),typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=e(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;r&&r.hide(),i&&i.hide(),this.data.dnd.mto=setTimeout(function(e){return function(){e.dnd_leave(t)}}(this),0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this)),e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,r&&r.css({top:"-2000px"}),i&&i.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(t,n){if(n.data.jstree){var r=e(n.event.target);r.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(r)}},this));var s=this._get_settings().dnd;s.drag_target&&e(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(n){t=n.target,e.vakata.dnd.drag_start(n,{jstree:!0,obj:n.target},"<ins class='jstree-icon'></ins>"+e(n.target).text()),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var s=this.get_container();this.data.dnd.cof=s.offset(),this.data.dnd.cw=parseInt(s.width(),10),this.data.dnd.ch=parseInt(s.height(),10),this.data.dnd.foreign=!0,n.preventDefault()},this)),s.drop_target&&e(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(n.target),e:n})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),e.proxy(function(t){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(n.target),e:n})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(e){return!0},drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(e){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(!n||!n.length)return;this.data.dnd.off=n.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+n.width());if(this.data.dnd.foreign){var e=this._get_settings().dnd.drag_check.call(this,{o:t,r:n});return this.data.dnd.after=e.after,this.data.dnd.before=e.before,this.data.dnd.inside=e.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(t,n,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(t,n,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(n)?(this.prepare_move(t,n,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared)return;var t=["before","inside","after"],n=!1,s=this._get_settings().core.rtl,o;this.data.dnd.w<this.data.core.li_height/3?t=["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?t=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:t=["after","inside","before"],e.each(t,e.proxy(function(t,r){if(this.data.dnd[r])return e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),n=r,!1},this)),n===!1&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),o=s?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(n){case"before":r.css({left:o+"px",top:this.data.dnd.off.top-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":r.css({left:o+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":r.css({left:o+(s?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),i&&i.hide();break;default:r.hide(),i&&i.hide()}return f=n,n},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(n,e.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:n,p:f}):(this.dnd_prepare(),this.move_node(t,n,f,e[this._get_settings().dnd.copy_modifier+"Key"])),t=!1,n=!1,r.hide(),i&&i.hide()},dnd_enter:function(t){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var r=this._get_settings().dnd;this.data.dnd.prepared=!1,n=this._get_node(t),r.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),r.check_timeout)):this.dnd_prepare(),r.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),n&&n.length&&n.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),r.open_timeout))):n&&n.length&&n.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(t){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),r.hide(),i&&i.hide(),n&&n[0]===t.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(n,s){t=this._get_node(n),this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var o=t.length>1?this._get_string("multiple_selection"):this.get_text(t),u=this.get_container();this._get_settings().core.html_titles||(o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")),e.vakata.dnd.drag_start(s,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+o),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=u.offset(),this.data.dnd.cw=parseInt(u.width(),10),this.data.dnd.ch=parseInt(u.height(),10),this.data.dnd.active=!0}}}),e(function(){var t="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";e.vakata.css.add_sheet({str:t,title:"jstree"}),r=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){return r.hide(),i.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1}).appendTo("body"),i=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(n&&n.length)return n.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1}).bind("mouseleave",function(t){var s=e(t.relatedTarget);if(s.is(".jstree")||s.closest(".jstree").length===0)if(n&&n.length)return n.children("a").trigger(t),r.hide(),i.hide(),t.preventDefault(),t.stopImmediatePropagation(),!1}).appendTo("body"),e(document).bind("drag_start.vakata",function(e,t){t.data.jstree&&(r.show(),i&&i.show())}),e(document).bind("drag_stop.vakata",function(e,t){t.data.jstree&&(r.hide(),i&&i.hide())})})}(jQuery),function(e){e.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=e.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",e.proxy(function(e,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",e.proxy(function(e){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",e.proxy(function(e){e.preventDefault(),this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target);if(!this.data.ui||!this.data.checkbox.noui)return e.stopImmediatePropagation(),!1;this.save_selected(),this.data.cookies&&this.save_cookie("select_node")},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(e){return["check_"+(e[0].id||Math.ceil(Math.random()*1e4)),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(e,t){t.checked&&this.check_node(e,!1)},_prepare_checkboxes:function(t){t=!t||t==-1?this.get_container().find("> ul > li"):this._get_node(t);if(t===!1)return;var n,r=this,i,s=this._get_settings().checkbox.two_state,o=this._get_settings().checkbox.real_checkboxes,u=this._get_settings().checkbox.real_checkboxes_names;t.each(function(){i=e(this),n=i.is("li")&&(i.hasClass("jstree-checked")||o&&i.children(":checked").length)?"jstree-checked":"jstree-unchecked",i.find("li").andSelf().each(function(){var t=e(this),i;t.children("a"+(r.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(s?"jstree-unchecked":n),o&&(t.children(":checkbox").length?t.children(":checkbox").addClass("jstree-real-checkbox"):(i=u.call(r,t),t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+i[0]+"' name='"+i[0]+"' value='"+i[1]+"' />"))),s?(t.hasClass("jstree-checked")||t.children(":checked").length)&&t.addClass("jstree-checked").children(":checkbox").prop("checked",!0):(n==="jstree-checked"||t.hasClass("jstree-checked")||t.children(":checked").length)&&t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})}),s||t.find(".jstree-checked").parent().parent().each(function(){r._repair_state(this)})},change_state:function(t,n){t=this._get_node(t);var r=!1,i=this._get_settings().checkbox.real_checkboxes;if(!t||t===-1)return!1;n=n===!1||n===!0?n:t.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state)n?(t.removeClass("jstree-checked").addClass("jstree-unchecked"),i&&t.children(":checkbox").prop("checked",!1)):(t.removeClass("jstree-unchecked").addClass("jstree-checked"),i&&t.children(":checkbox").prop("checked",!0));else{if(n){r=t.find("li").andSelf();if(!r.filter(".jstree-checked, .jstree-undetermined").length)return!1;r.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&r.children(":checkbox").prop("checked",!1)}else{r=t.find("li").andSelf();if(!r.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;r.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&r.children(":checkbox").prop("checked",!0),this.data.ui&&(this.data.ui.last_selected=t),this.data.checkbox.last_selected=t}t.parentsUntil(".jstree","li").each(function(){var t=e(this);if(n){if(t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&t.children(":checkbox").prop("checked",!1)}else{if(t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&t.children(":checkbox").prop("checked",!0)}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(t),!0},check_node:function(e){if(this.change_state(e,!1)){e=this._get_node(e);if(this._get_settings().checkbox.checked_parent_open){var t=this;e.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:e})}},uncheck_node:function(e){this.change_state(e,!0)&&this.__callback({obj:this._get_node(e)})},check_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!0)}),this.__callback()},is_checked:function(e){return e=this._get_node(e),e.length?e.is(".jstree-checked"):!1},get_checked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-checked"):e.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-unchecked"):e.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(e){e=this._get_node(e);if(!e.length)return;if(this._get_settings().checkbox.two_state){e.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);return}var t=this._get_settings().checkbox.real_checkboxes,n=e.find("> ul > .jstree-checked").length,r=e.find("> ul > .jstree-undetermined").length,i=e.find("> ul > li").length;i===0?e.hasClass("jstree-undetermined")&&this.change_state(e,!1):n===0&&r===0?this.change_state(e,!0):n===i?this.change_state(e,!1):(e.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),t&&e.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1))},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),e.each(n,function(e,n){t.check_node(n)}),this.__callback()}else this.__call_old()},save_loaded:function(){var e=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&e.data.core.to_load.push("#"+this.id)})}}}),e(function(){var t=".jstree .jstree-real-checkbox { display:none; } ";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.vakata.xslt=function(t,n,r){var i="",s,o,u,a;return document.recalc?(s=document.createElement("xml"),o=document.createElement("xml"),s.innerHTML=t,o.innerHTML=n,e("body").append(s).append(o),setTimeout(function(t,n,r){return function(){r.call(null,t.transformNode(n.XMLDocument)),setTimeout(function(t,n){return function(){e(t).remove(),e(n).remove()}}(t,n),200)}}(s,o,r),100),!0):(typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor=="undefined"&&(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml")),typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor!="undefined"?(u=new XSLTProcessor,a=e.isFunction(u.transformDocument)?typeof window.XMLSerializer!="undefined":!0,a?(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml"),e.isFunction(u.transformDocument)?(i=document.implementation.createDocument("","",null),u.transformDocument(t,n,i,null),r.call(null,(new XMLSerializer).serializeToString(i)),!0):(u.importStylesheet(n),i=u.transformToFragment(t,document),r.call(null,e("<div />").append(i).html()),!0)):!1):!1)};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},n=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_xml(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().xml_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_xml:function(t,n,r){var i=this.get_settings().xml_data,s=function(){},o=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(r){this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):(!t||t==-1)&&this.parse_xml(i.data,e.proxy(function(r){r?(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10&&(r=e(r),this.get_container().children("ul").empty().append(r.children()),i.clean_node&&this.clean_node(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:s=function(e,n,s){var o=this.get_settings().xml_data.ajax.error;o&&o.call(this,e,n,s),t!==-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},o=function(r,o,u){r=u.responseText;var a=this.get_settings().xml_data.ajax.success;a&&(r=a.call(this,r,o,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return s.call(this,u,o,"");this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},i.ajax.context=this,i.ajax.error=s,i.ajax.success=o,i.ajax.dataType||(i.ajax.dataType="xml"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},parse_xml:function(n,r){var i=this._get_settings().xml_data;e.vakata.xslt(n,t[i.xsl],r)},get_xml:function(t,r,i,s,o){var u="",a=this._get_settings(),f=this,l,c,h,p,d;t||(t="flat"),o||(o=0),r=this._get_node(r);if(!r||r===-1)r=this.get_container().find("> ul > li");return i=e.isArray(i)?i:["id","class"],!o&&this.data.types&&e.inArray(a.types.type_attr,i)===-1&&i.push(a.types.type_attr),s=e.isArray(s)?s:[],o||(a.xml_data.get_include_preamble&&(u+='<?xml version="1.0" encoding="UTF-8"?>'),u+="<root>"),r.each(function(){u+="<item",h=e(this),e.each(i,function(e,t){var r=h.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+(r||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),h.hasClass("jstree-open")&&(u+=' state="open"'),h.hasClass("jstree-closed")&&(u+=' state="closed"'),t==="flat"&&(u+=' parent_id="'+n(o)+'"'),u+=">",u+="<content>",p=h.children("a"),p.each(function(){l=e(this),d=!1,u+="<name",e.inArray("languages",a.plugins)!==-1&&e.each(a.languages,function(e,t){if(l.hasClass(t))return u+=' lang="'+n(t)+'"',d=t,!1}),s.length&&e.each(s,function(e,t){var r=l.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+r||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(u+=' icon="'+n(l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'),l.children("ins").get(0).style.backgroundImage.length&&(u+=' icon="'+n(l.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'),u+=">",u+="<![CDATA["+f.get_text(l,d)+"]]>",u+="</name>"}),u+="</content>",c=h[0].id||!0,h=h.find("> ul > li"),h.length?c=f.get_xml(t,h,i,s,c):c="",t=="nest"&&(u+=c),u+="</item>",t=="flat"&&(u+=c)}),o||(u+="</root>"),u}}})}(jQuery),function(e){e.expr[":"].jstree_contains=function(e,t,n){return(e.textContent||e.innerText||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.expr[":"].jstree_title_contains=function(e,t,n){return(e.getAttribute("title")||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=e(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(t,n){e(this).children("ul").find("li").hide().removeClass("jstree-last"),n.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){e(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){e(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(t,n){if(e.trim(t)===""){this.clear_search();return}var r=this.get_settings().search,i=this,s=function(){},o=function(){};this.data.search.str=t;if(!n&&r.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=!0,s=function(){},o=function(e,t,n){var r=this.get_settings().search.ajax.success;r&&(e=r.call(this,e,t,n)||e),this.data.search.to_open=e,this._search_open()},r.ajax.context=this,r.ajax.error=s,r.ajax.success=o,e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),r.ajax.data||(r.ajax.data={search_string:t});if(!r.ajax.dataType||/^json/.exec(r.ajax.dataType))r.ajax.dataType="json";e.ajax(r.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+r.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){i.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:t})},clear_search:function(t){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=e()},_search_open:function(t){var n=this,r=!0,i=[],s=[];this.data.search.to_open.length&&(e.each(this.data.search.to_open,function(t,n){if(n=="#")return!0;e(n).length&&e(n).is(".jstree-closed")?i.push(n):s.push(n)}),i.length&&(this.data.search.to_open=s,e.each(i,function(e,t){n.open_node(t,function(){n._search_open(!0)})}),r=!1)),r&&this.search(this.data.search.str,!0)}}})}(jQuery),function(e){e.vakata.context={hide_on_mouseleave:!1,cnt:e("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(t,n,r,i,s,o,u){e.vakata.context.rtl=!!u;var a=e.vakata.context.parse(t),f,l;if(!a)return;e.vakata.context.vis=!0,e.vakata.context.tgt=n,e.vakata.context.par=o||n||null,e.vakata.context.data=s||null,e.vakata.context.cnt.html(a).css({visibility:"hidden",display:"block",left:0,top:0}),e.vakata.context.hide_on_mouseleave&&e.vakata.context.cnt.one("mouseleave",function(t){e.vakata.context.hide()}),f=e.vakata.context.cnt.height(),l=e.vakata.context.cnt.width(),r+l>e(document).width()&&(r=e(document).width()-(l+5),e.vakata.context.cnt.find("li > ul").addClass("right")),i+f>e(document).height()&&(i-=f+n[0].offsetHeight,e.vakata.context.cnt.find("li > ul").addClass("bottom")),e.vakata.context.cnt.css({left:r,top:i}).find("li:has(ul)").bind("mouseenter",function(t){var n=e(document).width(),r=e(document).height(),i=e(this).children("ul").show();n!==e(document).width()&&i.toggleClass("right"),r!==e(document).height()&&i.toggleClass("bottom")}).bind("mouseleave",function(t){e(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),e(document).triggerHandler("context_show.vakata")},hide:function(){e.vakata.context.vis=!1,e.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),e(document).triggerHandler("context_hide.vakata")},parse:function(t,n){if(!t)return!1;var r="",i=!1,s=!0;return n||(e.vakata.context.func={}),r+="<ul>",e.each(t,function(t,n){if(!n)return!0;e.vakata.context.func[t]=n.action,!s&&n.separator_before&&(r+="<li class='vakata-separator vakata-separator-before'></li>"),s=!1,r+="<li class='"+(n._class||"")+(n._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",n.icon&&n.icon.indexOf("/")===-1&&(r+=" class='"+n.icon+"' "),n.icon&&n.icon.indexOf("/")!==-1&&(r+=" style='background:url("+n.icon+") center center no-repeat;' "),r+=">&#160;</ins><a href='#' rel='"+t+"'>",n.submenu&&(r+="<span style='float:"+(e.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),r+=n.label+"</a>",n.submenu&&(i=e.vakata.context.parse(n.submenu,!0),i&&(r+=i)),r+="</li>",n.separator_after&&(r+="<li class='vakata-separator vakata-separator-after'></li>",s=!0)}),r=r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),r+="</ul>",e(document).triggerHandler("context_parse.vakata"),r.length>10?r:!1},exec:function(t){return e.isFunction(e.vakata.context.func[t])?(e.vakata.context.func[t].call(e.vakata.context.data,e.vakata.context.par),!0):!1}},e(function(){var t="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";e.vakata.css.add_sheet({str:t,title:"vakata"}),e.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(t){!e(this).parent().hasClass("jstree-contextmenu-disabled")&&e.vakata.context.exec(e(this).attr("rel"))?e.vakata.context.hide():e(this).blur()}).delegate("a","mouseover",function(){e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),e(document).bind("mousedown",function(t){e.vakata.context.vis&&!e.contains(e.vakata.context.cnt[0],t.target)&&e.vakata.context.hide()}),typeof e.hotkeys!="undefined"&&e(document).bind("keydown","up",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","down",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","right",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){e.vakata.context.hide(),t.preventDefault()}).bind("keydown","space",function(t){e.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),t.preventDefault()})}),e.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY)},this)).delegate("a","click.jstree",e.proxy(function(t){this.data.contextmenu&&e.vakata.context.hide()},this)).bind("destroy.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)),e(document).bind("context_hide.vakata",e.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(e){this.is_selected(e)?this.remove():this.remove(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(t,n,r){t=this._get_node(t);var i=this.get_settings().contextmenu,s=t.children("a:visible:eq(0)"),o=!1,u=!1;i.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0));if(i.show_at_node||typeof n=="undefined"||typeof r=="undefined")o=s.offset(),n=o.left,r=o.top+this.data.core.li_height;u=t.data("jstree")&&t.data("jstree").contextmenu?t.data("jstree").contextmenu:i.items,e.isFunction(u)&&(u=u.call(this,t)),this.data.contextmenu=!0,e.vakata.context.show(u,s,n,r,this,t,this._get_settings().core.rtl),this.data.themes&&e.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(t){t.jstree.plugin("types",{__init:function(){var n=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",t.proxy(function(){var e=n.types,r=n.type_attr,i="",o=this;t.each(e,function(e,n){t.each(n,function(e,t){/^(max_depth|max_children|icon|valid_children)$/.test(e)||o.data.types.attach_to.push(e)});if(!n.icon)return!0;if(n.icon.image||n.icon.position)e=="default"?i+=".jstree-"+o.get_index()+" a > .jstree-icon { ":i+=".jstree-"+o.get_index()+" li["+r+'="'+e+'"] > a > .jstree-icon { ',n.icon.image&&(i+=" background-image:url("+n.icon.image+"); "),n.icon.position?i+=" background-position:"+n.icon.position+"; ":i+=" background-position:0 0; ",i+="} "}),i!==""&&t.vakata.css.add_sheet({str:i,title:"jstree-types"})},this)).bind("before.jstree",t.proxy(function(e,n){var r,i,s=this._get_settings().types.use_data?this._get_node(n.args[0]):!1,o=s&&s!==-1&&s.length?s.data("jstree"):!1;if(o&&o.types&&o.types[n.func]===!1)return e.stopImmediatePropagation(),!1;if(t.inArray(n.func,this.data.types.attach_to)!==-1){if(!n.args[0]||!n.args[0].tagName&&!n.args[0].jquery)return;r=this._get_settings().types.types,i=this._get_type(n.args[0]);if((r[i]&&typeof r[i][n.func]!="undefined"||r["default"]&&typeof r["default"][n.func]!="undefined")&&this._check(n.func,n.args[0])===!1)return e.stopImmediatePropagation(),!1}},this)),e&&this.get_container().bind("load_node.jstree set_type.jstree",t.proxy(function(e,n){var r=n&&n.rslt&&n.rslt.obj&&n.rslt.obj!==-1?this._get_node(n.rslt.obj).parent():this.get_container_ul(),i=!1,s=this._get_settings().types;t.each(s.types,function(e,t){t.icon&&(t.icon.image||t.icon.position)&&(i=e==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+e+"'] > a > .jstree-icon"),t.icon.image&&i.css("backgroundImage","url("+t.icon.image+")"),i.css("backgroundPosition",t.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(e,t){t.type&&this._get_settings().types.use_data&&this.set_type(t.type,e)},_get_type:function(e){return e=this._get_node(e),!e||!e.length?!1:e.attr(this._get_settings().types.type_attr)||"default"},set_type:function(e,t){t=this._get_node(t);var n=!t.length||!e?!1:t.attr(this._get_settings().types.type_attr,e);return n&&this.__callback({obj:t,type:e}),n},_check:function(e,n,r){n=this._get_node(n);var i=!1,s=this._get_type(n),o=0,u=this,a=this._get_settings().types,f=!1;if(n===-1){if(!a[e])return;i=a[e]}else{if(s===!1)return;f=a.use_data?n.data("jstree"):!1,f&&f.types&&typeof f.types[e]!="undefined"?i=f.types[e]:!a.types[s]||typeof a.types[s][e]=="undefined"?!!a.types["default"]&&typeof a.types["default"][e]!="undefined"&&(i=a.types["default"][e]):i=a.types[s][e]}return t.isFunction(i)&&(i=i.call(this,n)),e==="max_depth"&&n!==-1&&r!==!1&&a.max_depth!==-2&&i!==0&&n.children("a:eq(0)").parentsUntil(".jstree","li").each(function(t){if(a.max_depth!==-1&&a.max_depth-(t+1)<=0)return i=0,!1;o=t===0?i:u._check(e,this,!1);if(o!==-1&&o-(t+1)<=0)return i=0,!1;o>=0&&(o-(t+1)<i||i<0)&&(i=o-(t+1)),a.max_depth>=0&&(a.max_depth-(t+1)<i||i<0)&&(i=a.max_depth-(t+1))}),i},check_move:function(){if(!this.__call_old())return!1;var e=this._get_move(),n=e.rt._get_settings().types,r=e.rt._check("max_children",e.cr),i=e.rt._check("max_depth",e.cr),s=e.rt._check("valid_children",e.cr),o=0,u=1,a;if(s==="none")return!1;if(t.isArray(s)&&e.ot&&e.ot._get_type){e.o.each(function(){if(t.inArray(e.ot._get_type(this),s)===-1)return u=!1,!1});if(u===!1)return!1}if(n.max_children!==-2&&r!==-1){o=e.cr===-1?this.get_container().find("> ul > li").not(e.o).length:e.cr.find("> ul > li").not(e.o).length;if(o+e.o.length>r)return!1}if(n.max_depth!==-2&&i!==-1){u=0;if(i===0)return!1;if(typeof e.o.d=="undefined"){a=e.o;while(a.length>0)a=a.find("> ul > li"),u++;e.o.d=u}if(i-e.o.d<0)return!1}return!0},create_node:function(e,n,r,i,s,o){if(!o&&(s||this._is_loaded(e))){var u=typeof n=="string"&&n.match(/^before|after$/i)&&e!==-1?this._get_parent(e):this._get_node(e),a=this._get_settings().types,f=this._check("max_children",u),l=this._check("max_depth",u),c=this._check("valid_children",u),h;typeof r=="string"&&(r={data:r}),r||(r={});if(c==="none")return!1;if(t.isArray(c))if(!r.attr||!r.attr[a.type_attr])r.attr||(r.attr={}),r.attr[a.type_attr]=c[0];else if(t.inArray(r.attr[a.type_attr],c)===-1)return!1;if(a.max_children!==-2&&f!==-1){h=u===-1?this.get_container().find("> ul > li").length:u.find("> ul > li").length;if(h+1>f)return!1}if(a.max_depth!==-2&&l!==-1&&l-1<0)return!1}return this.__call_old(!0,e,n,r,i,s,o)}}})}(jQuery),function(e){e.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_html(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){return t=this._get_node(t),t==-1||!t||!this._get_settings().html_data.ajax&&!e.isFunction(this._get_settings().html_data.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_html:function(t,n,r){var i,s=this.get_settings().html_data,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case e.isFunction(s.data):s.data.call(this,t,e.proxy(function(r){r&&r!==""&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")!==""?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!s.data&&!s.ajax:if(!t||t==-1)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!t||t===-1):if(!t||t==-1)i=e(s.data),i.is("ul")||(i=e("<ul />").append(i)),this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&t&&t!==-1:t=this._get_node(t),o=function(e,n,i){var o=this.get_settings().html_data.ajax.error;o&&o.call(this,e,n,i),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&s.correct_state&&this.correct_state(t)):n==="success"&&s.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,i,u){var a=this.get_settings().html_data.ajax.success;a&&(r=a.call(this,r,i,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return o.call(this,u,i,"");r?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},s.ajax.context=this,s.ajax.error=o,s.ajax.success=u,s.ajax.dataType||(s.ajax.dataType="html"),e.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,t)),e.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,t)),e.ajax(s.ajax)}}}}),e.jstree.defaults.plugins.push("html_data")}(jQuery),function(e){e.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(n){e(n.currentTarget).hasClass("jstree-loading")||e(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){e(this).removeClass(t.item_h)}).bind("init.jstree",e.proxy(function(e,t){t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(t.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",e.proxy(function(e){this._themeroller()},this)).bind("close_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("delete_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.parent)},this)).bind("correct_state.jstree",e.proxy(function(e,n){n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened+" "+t.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_open+" "+t.item_clsd).addClass(t.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)},this)).bind("dehover_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").removeClass(t.item_h)},this)).bind("hover_node.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_h).not(n.rslt.obj).removeClass(t.item_h),n.rslt.obj.children("a").addClass(t.item_h)},this)).bind("move_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.o),this._themeroller(t.rslt.op)},this))},__destroy:function(){var t=this._get_settings().themeroller,n=["ui-icon"];e.each(t,function(e,t){t=t.split(" "),t.length&&(n=n.concat(t))}),this.get_container().removeClass("ui-widget-content").find("."+n.join(", .")).removeClass(n.join(" "))},_fn:{_themeroller:function(e){var t=this._get_settings().themeroller;e=!e||e==-1?this.get_container_ul():this._get_node(e).parent(),e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_open).addClass(t.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_clsd).addClass(t.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed+" ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_clsd+" "+t.item_open).addClass(t.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),e(function(){var t=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",e.proxy(function(t,n){var r=[],i=!0,s,o;n.func=="move_node"&&n.args[4]===!0&&n.args[0].o&&n.args[0].o.length&&(n.args[0].o.children("a").each(function(){r.push(e(this).text().replace(/^\s+/g,""))}),i=this._check_unique(r,n.args[0].np.find("> ul > li").not(n.args[0].o),"move_node"));if(n.func=="create_node")if(n.args[4]||this._is_loaded(n.args[0])){s=this._get_node(n.args[0]);if(n.args[1]&&(n.args[1]==="before"||n.args[1]==="after")){s=this._get_parent(n.args[0]);if(!s||s===-1)s=this.get_container()}typeof n.args[2]=="string"?r.push(n.args[2]):!n.args[2]||!n.args[2].data?r.push(this._get_string("new_node")):r.push(n.args[2].data),i=this._check_unique(r,s.find("> ul > li"),"create_node")}if(n.func=="rename_node"){r.push(n.args[1]),o=this._get_node(n.args[0]),s=this._get_parent(o);if(!s||s===-1)s=this.get_container();i=this._check_unique(r,s.find("> ul > li").not(o),"rename_node")}if(!i)return t.stopPropagation(),!1},this))},defaults:{error_callback:e.noop},_fn:{_check_unique:function(t,n,r){var i=[];return n.children("a").each(function(){i.push(e(this).text().replace(/^\s+/g,""))}),!i.length||!t.length?!0:(i=i.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),i.length+t.length!=i.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,t,n,r),!1):!0)},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=[];return t.o&&t.o.length?(t.o.children("a").each(function(){n.push(e(this).text().replace(/^\s+/g,""))}),this._check_unique(n,t.np.find("> ul > li").not(t.o),"check_move")):!0}}})}(jQuery),function(r){r.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",r.proxy(function(e,t){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",r.proxy(function(e,t){this._prepare_wholerow_span(t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",r.proxy(function(e,t){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(e,t){return function(){e._prepare_wholerow_ul(t)}}(this,t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",r.proxy(function(e,t){t.rslt.obj.each(function(){var e=t.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((r(this).offset().top-t.inst.get_container().offset().top+t.inst.get_container()[0].scrollTop)/t.inst.data.core.li_height,10)+")");e.children("a").attr("class",t.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var n=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((t.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");n.children("a").attr("class",t.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var t=r(e.currentTarget);if(e.target.tagName==="A"||e.target.tagName==="INS"&&t.closest("li").is(".jstree-open, .jstree-closed"))return;t.closest("li").children("a:visible:eq(0)").click(),e.stopImmediatePropagation()}).delegate("li","mouseover.jstree",r.proxy(function(e){return e.stopImmediatePropagation(),r(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(e.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",r.proxy(function(e){if(r(e.currentTarget).children("a").hasClass("jstree-hovered").length)return;this.dehover_node(e.currentTarget)},this)),(t||e)&&r.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(e){e=!e||e==-1?this.get_container().find("> ul > li"):this._get_node(e);if(e===!1)return;e.each(function(){r(this).find("li").andSelf().each(function(){var e=r(this);if(e.children(".jstree-wholerow-span").length)return!0;e.prepend("<span class='jstree-wholerow-span' style='width:"+e.parentsUntil(".jstree","li").length*18+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var e=this.get_container().children("ul").eq(0),n=e.html();e.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==n&&(this.data.wholerow.last_html=n,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top",(e.height()+(t?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),r(function(){var i=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";n&&(i+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(t||e)i+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";r.vakata.css.add_sheet({str:i,title:"jstree"})})}(jQuery),function(e){var t=["getChildren","getChildrenCount","getAttr","getName","getProps"],n=function(t,n){var r=!0;return t=t||{},n=[].concat(n),e.each(n,function(n,i){if(!e.isFunction(t[i]))return r=!1,!1}),r};e.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(r,i){var s=r==-1?this._get_settings().model.object:r.data("jstree_model");if(!n(s,t))return i.call(null,!1);this._get_settings().model.async?s.getChildren(e.proxy(function(e){this.model_done(e,i)},this)):this.model_done(s.getChildren(),i)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(t,n){var r=[],i=this._get_settings(),s=this;e.isArray(t)||(t=[t]),e.each(t,function(t,n){var o=n.getProps()||{};o.attr=n.getAttr()||{},n.getChildrenCount()&&(o.state="closed"),o.data=n.getName(),e.isArray(o.data)||(o.data=[o.data]),s.data.types&&e.isFunction(n.getType)&&(o.attr[i.types.type_attr]=n.getType()),o.attr.id&&i.model.id_prefix&&(o.attr.id=i.model.id_prefix+o.attr.id),o.metadata||(o.metadata={}),o.metadata.jstree_model=n,r.push(o)}),n.call(null,r)}}})}(jQuery)}(),define("jstree",function(){}),require(["jquery.form","jquery.jcrop","jquery.textarea.counter","jquery.timepicker","jquery.textarea.autosize","jquery.editinplace","jquery.tokeninput","jquery.calendar","lightbox","backbone","bootstrap-button","plupload","plupload.html5","plupload.html4","plupload.flash","ezmark","jstree"],function(){}),define("bundles/libs2",function(){});